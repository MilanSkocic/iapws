.\" Man page generated from reStructuredText.
.
.
.nr rst2man-indent-level 0
.
.de1 rstReportMargin
\\$1 \\n[an-margin]
level \\n[rst2man-indent-level]
level margin: \\n[rst2man-indent\\n[rst2man-indent-level]]
-
\\n[rst2man-indent0]
\\n[rst2man-indent1]
\\n[rst2man-indent2]
..
.de1 INDENT
.\" .rstReportMargin pre:
. RS \\$1
. nr rst2man-indent\\n[rst2man-indent-level] \\n[an-margin]
. nr rst2man-indent-level +1
.\" .rstReportMargin post:
..
.de UNINDENT
. RE
.\" indent \\n[an-margin]
.\" old: \\n[rst2man-indent\\n[rst2man-indent-level]]
.nr rst2man-indent-level -1
.\" new: \\n[rst2man-indent\\n[rst2man-indent-level]]
.in \\n[rst2man-indent\\n[rst2man-indent-level]]u
..
.TH "IAPWS" "3" "Dec 26, 2025" "" "iapws"
.SH NAME
iapws \- Light and heavy water properties
[image: Alternative text]
[image]
.sp
Light and heavy water properties according to IAPWS.
.sp
Critical values are available as constants [\fI\%1\fP]:
.INDENT 0.0
.IP \(bu 2
.INDENT 2.0
.TP
.B water:
.INDENT 7.0
.IP \(bu 2
\fITc_H2O\fP
.IP \(bu 2
\fIrhoc_H2O\fP
.IP \(bu 2
\fIpc_H2O\fP
.UNINDENT
.UNINDENT
.IP \(bu 2
.INDENT 2.0
.TP
.B In heavywater
.INDENT 7.0
.IP \(bu 2
\fITc_D2O\fP
.IP \(bu 2
\fIrhoc_D2O\fP
.IP \(bu 2
\fIpc_D2O\fP
.UNINDENT
.UNINDENT
.UNINDENT
.sp
The Henry constant \fIkh\fP and
the liquid\-vapor distribution constant \fIkd\fP
can be computed for the following gases as defined in [\fI\%2\fP] :
.INDENT 0.0
.IP \(bu 2
in water: He, Ne, Ar, Kr, Xe, H2, N2, O2, CO, CO2, H2S, CH4, C2H6, SF6
.IP \(bu 2
in heavywater: He, Ne, Ar, Kr, Xe, D2, CH4
.UNINDENT
.sp
The available gases can be retrieved with
.INDENT 0.0
.IP \(bu 2
\fIgases\fP which returns the available gases as a list.
.IP \(bu 2
\fIgases2\fP which return the available gases as a string.
.IP \(bu 2
\fIngases\fP which returns the number of available gases.
.UNINDENT
.INDENT 0.0
.INDENT 2.5
[image]
k_H in H_2O.UNINDENT
.UNINDENT
.INDENT 0.0
.INDENT 2.5
[image]
k_H in D_2O.UNINDENT
.UNINDENT
.INDENT 0.0
.INDENT 2.5
[image]
k_D in H_2O.UNINDENT
.UNINDENT
.INDENT 0.0
.INDENT 2.5
[image]
k_D in D_2O.UNINDENT
.UNINDENT
.sp
Five regions which cover the following range of validity [\fI\%3\fP]:
.INDENT 0.0
.IP \(bu 2
273.15K < T < 1073.15K and p < 100MPa
.IP \(bu 2
1073.15K < T < 2273.15K and  p < 50MPa
.UNINDENT
.INDENT 0.0
.INDENT 2.5
[image]
Water regions defined in R7\-97.UNINDENT
.UNINDENT
.sp
The saturation\-pressure \fIpsat\fP and the
saturation\-temperature \fITsat\fP computes the
saturation line as shown in the plot below.
.INDENT 0.0
.INDENT 2.5
[image]
Saturation line..UNINDENT
.UNINDENT
.SH GETTING STARTED
.SS Introduction
.sp
\fIipaws\fP is a Fortran library providing the formulas for computing
light and heavy water properties. The formulas are taken from
\X'tty: link http://iapws.org'\fI\%http://iapws.org\fP\X'tty: link'\&. C API allows usage from C, or can be used as a basis
for other wrappers. Python wrapper allows easy usage from Python.
.sp
It covers:
.INDENT 0.0
.IP \(bu 2
R2\-83
\-  Tc in H2O and D2O
\-  pc in H2O and D2O
\-  rhoc in H2O and D2O
.IP \(bu 2
G7\-04
.INDENT 2.0
.IP \(bu 2
kH
.IP \(bu 2
kD
.UNINDENT
.IP \(bu 2
R7\-97
.INDENT 2.0
.IP \(bu 2
Region 1
.IP \(bu 2
Region 2
.IP \(bu 2
Region 3
.IP \(bu 2
Region 4
.IP \(bu 2
Region 5
.UNINDENT
.IP \(bu 2
R11\-24:
.INDENT 2.0
.IP \(bu 2
Kw
.UNINDENT
.UNINDENT
.sp
To use \fIiapws\fP within your
\X'tty: link https://github.com/fortran-lang/fpm'\fI\%fpm\fP\X'tty: link' project, add the following
to your \fIfpm.toml\fP file:
.INDENT 0.0
.INDENT 3.5
.sp
.EX
[dependencies]
iapws = { git=\(dqhttps://github.com/MilanSkocic/iapws.git\(dq }
.EE
.UNINDENT
.UNINDENT
.SS Dependencies
.INDENT 0.0
.INDENT 3.5
.sp
.EX
gcc>=10.0
gfortran>=10.0
fpm>=0.8
stdlib>=0.5
.EE
.UNINDENT
.UNINDENT
.SS Installation
.sp
A Makefile is provided, which uses
\X'tty: link https://fpm.fortran-lang.org'\fI\%fpm\fP\X'tty: link', for building the library.
.INDENT 0.0
.IP \(bu 2
On windows, \X'tty: link https://www.msys2.org'\fI\%msys2\fP\X'tty: link' needs to be installed.
Add the msys2 binary (usually C:\emsys64\eusr\ebin) to the path in
order to be able to use make.
.IP \(bu 2
On Darwin, the \X'tty: link https://formulae.brew.sh/formula/gcc'\fI\%gcc\fP\X'tty: link'
toolchain needs to be installed.
.UNINDENT
.sp
Build: the configuration file will set all the environment variables
necessary for the compilation
.INDENT 0.0
.INDENT 3.5
.sp
.EX
chmod +x configure.sh
\&./configure.sh
make
make test
make install
make uninstall
.EE
.UNINDENT
.UNINDENT
.SS License
.sp
MIT
.SH EXAMPLES
.SS Fortran
.INDENT 0.0
.INDENT 3.5
.sp
.EX
program example_in_f
    use stdlib_kinds, only: dp, int32
    use iapws
    implicit none
    integer(int32) :: i, ngas
    real(dp) :: T(1), kh_res(1), kd_res(1), wp_res(1), p(1)
    real(dp) :: Ts(7), ps(7)
    real(dp) :: x(3), y(3)
    integer(int32) :: r(3)
    character(len=1) :: s(3)
    character(len=2) :: gas = \(dqO2\(dq
    integer(int32) :: heavywater = 0
    type(gas_type), pointer :: gases_list(:)
    character(len=:), pointer :: gases_str
    
    print *, \(aq########################## IAPWS VERSION ##########################\(aq
    print *, \(dqversion \(dq, get_version()  

    print *, \(aq########################## IAPWS R2\-83 ##########################\(aq
    print \(dq(a, f10.3, a)\(dq, \(dqTc in h2o=\(dq, Tc_H2O, \(dq k\(dq
    print \(dq(a, f10.3, a)\(dq, \(dqpc in h2o=\(dq, pc_H2O, \(dq mpa\(dq
    print \(dq(a, f10.3, a)\(dq, \(dqrhoc in h2o=\(dq, rhoc_H2O, \(dq kg/m3\(dq
    
    print \(dq(a, f10.3, a)\(dq, \(dqTc in D2O=\(dq, Tc_D2O, \(dq k\(dq
    print \(dq(a, f10.3, a)\(dq, \(dqpc in D2O=\(dq, pc_D2O, \(dq mpa\(dq
    print \(dq(a, f10.3, a)\(dq, \(dqrhoc in D2O=\(dq, rhoc_D2O, \(dq kg/m3\(dq
    print *, \(aq\(aq

    print *, \(aq########################## IAPWS G7\-04 ##########################\(aq
    ! Compute kh and kd in H2O
    T(1) = 25.0_dp + 273.15_dp
    call kh(T, gas, heavywater, kh_res)
    print \(dq(A10, 1X, A10, 1X, A2, F10.1, A, 4X, A3, SP, F10.4)\(dq, \(dqGas=\(dq, gas, \(dqT=\(dq, T, \(dqK\(dq, \(dqkh=\(dq, kh_res
    
    call kd(T, gas, heavywater, kd_res)
    print \(dq(A10, 1X, A10, 1X, A2, F10.1, A, 4X, A3, SP, F15.4)\(dq, \(dqGas=\(dq, gas, \(dqT=\(dq, T, \(dqK\(dq, \(dqkh=\(dq, kd_res

    ! Get and print available gases
    heavywater = 0
    ngas = ngases(heavywater)
    gases_list => null()
    gases_list => gases(heavywater)
    gases_str => gases2(heavywater)
    print *, \(dqGases in H2O: \(dq, ngas
    print *, gases_str
    do i=1, ngas
        print *, gases_list(i)%gas
    enddo
    
    heavywater = 1
    ngas = ngases(heavywater)
    gases_list => null()
    gases_list => gases(heavywater)
    gases_str => gases2(heavywater)
    print *, \(dqGases in D2O: \(dq, ngas
    print *, gases_str
    do i=1, ngas
        print *, gases_list(i)%gas
    enddo

    print *, \(aq########################## IAPWS R7\-97 ##########################\(aq
    ! Compute ps from Ts.
    Ts(:) = [\-1.0_dp, 25.0_dp, 100.0_dp, 200.0_dp, 300.0_dp, 360.0_dp, 374.0_dp]
    Ts(:) = Ts(:) + 273.15_dp
    call psat(Ts, ps)

    do i=1, size(Ts)
        print \(dq(SP, F23.3, A3, 4X, F23.3, A3)\(dq, Ts(i), \(dqK\(dq, ps(i), \(dqMPa\(dq
    end do 

    ! Compute Ts from ps
    call Tsat(ps, Ts)
    do i=1, size(Ts)
        print \(dq(SP, F23.3, A3, 4X, F23.3, A3)\(dq, Ts(i), \(dqK\(dq, ps(i), \(dqMPa\(dq
    end do 

    ! Compute water properties at 280°C/8 Mpa
    p(1) = 8.0_dp
    T(1) = 273.15_dp + 280.0_dp
    call wp(p, T, \(dqv\(dq, wp_res)
    print \(dq(A5, F23.16, X, A)\(dq, \(dqv(8MPa,280°C)=\(dq, wp_res(1)*1000.0_dp, \(dqL/kg\(dq

    ! Compute region and phase
    x = [8.0_dp, 4.0_dp, 6.0_dp ] 
    y = [553.15_dp, 1200.0_dp, 2000.0_dp]
    call wr(x, y, r)
    call wph(x, y, s)
    print *, r
    print *, s

end program

.EE
.UNINDENT
.UNINDENT
.SS C
.INDENT 0.0
.INDENT 3.5
.sp
.EX
#include <string.h>
#include <stdio.h>
#include \(dqiapws.h\(dq

int main(void){

    double T = 25.0 + 273.15; /* in C*/
    double p; /* p in Mpa */
    char *gas = \(dqO2\(dq;
    double kh, kd, wp_res;
    char **gases_list;
    char *gases_str;
    int ngas;
    int i;
    int heavywater = 0;
    double x[3]= {8.0, 4.0, 6.0 };
    double y[3] = {553.15, 1200.0, 2000.0};
    int r[3];
    char s[3];
    
    printf(\(dq%s\en\(dq, \(dq########################## IAPWS VERSION ##########################\(dq);
    printf(\(dqversion %s\en\(dq, iapws_get_version());
    
    printf(\(dq%s\en\(dq, \(dq########################## IAPWS R2\-83 ##########################\(dq);
    printf(\(dq%s %10.3f %s\en\(dq, \(dqTc in H2O\(dq, iapws_r283_Tc_H2O, \(dqK\(dq);
    printf(\(dq%s %10.3f %s\en\(dq, \(dqpc in H2O\(dq, iapws_r283_pc_H2O, \(dqMPa\(dq);
    printf(\(dq%s %10.3f %s\en\(dq, \(dqrhoc in H2O\(dq, iapws_r283_rhoc_H2O, \(dqkg/m3\(dq);
    
    printf(\(dq%s %10.3f %s\en\(dq, \(dqTc in D2O\(dq, iapws_r283_Tc_D2O, \(dqK\(dq);
    printf(\(dq%s %10.3f %s\en\(dq, \(dqpc in D2O\(dq, iapws_r283_pc_D2O, \(dqMPa\(dq);
    printf(\(dq%s %10.3f %s\en\(dq, \(dqrhoc in D2O\(dq, iapws_r283_rhoc_D2O, \(dqkg/m3\(dq);
    
    printf(\(dq\en\(dq);


    printf(\(dq%s\en\(dq, \(dq########################## IAPWS G7\-04 ##########################\(dq);
    /* Compute kh and kd in H2O*/
    iapws_g704_kh(&T, gas, heavywater, &kh, strlen(gas), 1);
    printf(\(dqGas=%s\etT=%fK\etkh=%+10.4f\en\(dq, gas, T, kh);
    
    iapws_g704_kd(&T, gas, heavywater, &kd, strlen(gas), 1);
    printf(\(dqGas=%s\etT=%fK\etkd=%+15.4f\en\(dq, gas, T, kd);

    /* Get and print the available gases */
    ngas = iapws_g704_ngases(heavywater);
    gases_list = iapws_g704_gases(heavywater);
    gases_str = iapws_g704_gases2(heavywater);
    printf(\(dqGases in H2O: %d\en\(dq, ngas);
    printf(\(dq%s\en\(dq, gases_str);
    for(i=0; i<ngas; i++){
        printf(\(dq%s\en\(dq, gases_list[i]);
    }
    
    heavywater = 1;
    ngas = iapws_g704_ngases(heavywater);
    gases_list = iapws_g704_gases(heavywater);
    gases_str = iapws_g704_gases2(heavywater);
    printf(\(dqGases in D2O: %d\en\(dq, ngas);
    printf(\(dq%s\en\(dq, gases_str);
    for(i=0; i<ngas; i++){
        printf(\(dq%s\en\(dq, gases_list[i]);
    }
    
    printf(\(dq%s\en\(dq, \(dq########################## IAPWS R7\-97 ##########################\(dq);
    double Ts[7] =  {\-1.0, 25.0, 100.0, 200.0, 300.0, 360.0, 374.0};
    double ps[7] = {1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0};
    for(i=0; i<7; i++){
        Ts[i] = Ts[i] + 273.15;
    }
    iapws_r797_psat(7, Ts, ps);

    for(i=0; i<7; i++){
        printf(\(dq%+23.3f %s %+23.3f %s\en\(dq, Ts[i], \(dqK\(dq, ps[i], \(dqMPa\(dq);
    }

    iapws_r797_Tsat(7, ps, Ts);
    for(i=0; i<7; i++){
        printf(\(dq%+23.3f %s %+23.3f %s\en\(dq, Ts[i], \(dqK\(dq, ps[i], \(dqMPa\(dq);
    }

    T = 273.15 + 280.0;
    p = 8.0;
    iapws_r797_wp(&p, &T, \(dqv\(dq, &wp_res, 1, 1);
    printf(\(dqv(8MPa,280°C) = %+23.16f L/kg\en\(dq, wp_res * 1000.0);
    
    iapws_r797_wr(x, y, r, 3);
    iapws_r797_wph(x, y, s, 3);
    for(i=0; i<3; i++){
        printf(\(dq%i\(dq, r[i]);
    }
    printf(\(dq\en\(dq);
    for(i=0; i<3; i++){
        printf(\(dq%c\(dq, s[i]);
    }
    printf(\(dq\en\(dq);

    return 0;
}

.EE
.UNINDENT
.UNINDENT
.SS Python
.INDENT 0.0
.INDENT 3.5
.sp
.EX
import array
import numpy as np
import matplotlib.pyplot as plt
import pyiapws

print(\(dq########################## IAPWS VERSION ##########################\(dq)
print(pyiapws.__version__)

print(\(dq########################## IAPWS R2\-83 ##########################\(dq)
print(\(dqTc in H2O\(dq, pyiapws.Tc_H2O, \(dqK\(dq)
print(\(dqpc in H2O\(dq, pyiapws.pc_H2O, \(dqMPa\(dq)
print(\(dqrhoc in H2O\(dq, pyiapws.rhoc_H2O, \(dqkg/m3\(dq)

print(\(dqTc in D2O\(dq, pyiapws.Tc_D2O, \(dqK\(dq)
print(\(dqpc in D2O\(dq, pyiapws.pc_D2O, \(dqMPa\(dq)
print(\(dqrhoc in D2O\(dq, pyiapws.rhoc_D2O, \(dqkg/m3\(dq)

print(\(dq\(dq)

print(\(dq########################## IAPWS G7\-04 ##########################\(dq)
gas  = \(dqO2\(dq
T = array.array(\(dqd\(dq, (25.0+273.15,))

# Compute kh and kd in H2O
heavywater = False
k = pyiapws.kh(T, \(dqO2\(dq, heavywater)
print(f\(dqGas={gas}\etT={T[0]}K\etkh={k[0]:+10.4f}\en\(dq)

k = pyiapws.kd(T, \(dqO2\(dq, heavywater)
print(f\(dqGas={gas}\etT={T[0]}K\etkd={k[0]:+10.4f}\en\(dq)

# Get and print the available gases
heavywater = False
gases_list = pyiapws.gases(heavywater)
gases_str = pyiapws.gases2(heavywater)
ngas = pyiapws.ngases(heavywater)
print(f\(dqGases in H2O: {ngas:}\(dq)
print(gases_str)
for gas in gases_list:
    print(gas)

heavywater = True
gases_list = pyiapws.gases(heavywater)
gases_str = pyiapws.gases2(heavywater)
ngas = pyiapws.ngases(heavywater)
print(f\(dqGases in D2O: {ngas:}\(dq)
print(gases_str)
for gas in gases_list:
    print(gas)

style = {\(dqmarker\(dq:\(dq.\(dq, \(dqls\(dq:\(dq\(dq, \(dqms\(dq:2}
T_KELVIN = 273.15
T = np.linspace(0.0, 360.0, 1000) + 273.15

solvent = {True: \(dqD2O\(dq, False: \(dqH2O\(dq}

print(\(dqGenerating plot for kh\(dq)
kname = \(dqkh\(dq
for HEAVYWATER in (False, True):
    print(solvent[HEAVYWATER])
    fig = plt.figure()
    ax = fig.add_subplot()
    ax.grid(visible=True, ls=\(aq:\(aq)
    ax.set_xlabel(\(dqT /°K\(dq)
    ax.set_ylabel(\(dqln (kh/1GPa)\(dq)
    gases = pyiapws.gases(HEAVYWATER)
    for gas in gases:
        k = pyiapws.kh(T, gas, HEAVYWATER) / 1000.0
        ln_k = np.log(k)
        ax.plot(T, ln_k, label=gas, **style)
    ax.legend(ncol=3)
    fig.savefig(f\(dq../media/g704\-{kname:s}_{solvent[HEAVYWATER]}.png\(dq, dpi=100, format=\(dqpng\(dq)

print(\(dqGenerating plot for kd\(dq)
kname = \(dqkd\(dq
for HEAVYWATER in (False, True):
    print(solvent[HEAVYWATER])
    fig = plt.figure()
    ax = fig.add_subplot()
    ax.grid(visible=True, ls=\(aq:\(aq)
    ax.set_xlabel(\(dqT /°K\(dq)
    ax.set_ylabel(\(dqln kd\(dq)
    gases = pyiapws.gases(HEAVYWATER)
    for gas in gases:
        k = pyiapws.kd(T, gas, HEAVYWATER)
        ln_k = np.log(k)
        ax.plot(T, ln_k, label=gas, **style)
    ax.legend(ncol=3)
    fig.savefig(f\(dq../media/g704\-{kname:s}_{solvent[HEAVYWATER]}.png\(dq, dpi=100, format=\(dqpng\(dq)



print(\(dq########################## IAPWS R7\-97 ##########################\(dq)
Ts = np.asarray([\-1.0, 25.0, 100.0, 200.0, 300.0, 360.0, 374.0])
Ts = Ts + 273.15


ps = pyiapws.psat(Ts)
for i in range(Ts.size): 
    print(f\(dq{Ts[i]:23.3f} K {ps[i]:23.3f} MPa.\(dq)

Ts = pyiapws.Tsat(ps)
for i in range(Ts.size): 
    print(f\(dq{Ts[i]:23.3f} K {ps[i]:23.3f} MPa.\(dq)

fig = plt.figure()
ax = fig.add_subplot()
ax.grid(visible=True, ls=\(aq:\(aq)
ax.set_xlabel(\(dqTs /K\(dq)
ax.set_ylabel(\(dqps /MPa\(dq)
Ts = np.linspace(0.0, 370.0, 500)
Ts = Ts + 273.15

ps = pyiapws.psat(Ts)
ax.plot(Ts, ps, \(dqr\-\(dq, label=\(dqps(Ts)\(dq)

Ts = pyiapws.Tsat(ps)
ax.plot(Ts, ps, \(dqb\-\-\(dq, label=\(dqTs(ps)\(dq)

ax.legend()
fig.savefig(f\(dq../media/r797\-r4.png\(dq, dpi=100, format=\(dqpng\(dq)


T = 280.0 + 273.15
p = 8.0
res = pyiapws.wp(p, T, \(dqv\(dq)*1000.0
print(f\(dqv(8MPa,280°C) = {res:+23.16f} L/kg)\(dq)
    
x = np.asarray([8.0, 4.0, 6.0 ])
y = np.asarray([553.15, 1200.0, 2000.0])
r=pyiapws.wr(x, y)
s=pyiapws.wph(x, y)
print(r)
print(s)


plt.show()

.EE
.UNINDENT
.UNINDENT
.SH APIS
.SS Fortran
.sp
\X'tty: link https://milanskocic.github.io/iapws/ford/index.html'\fI\%https://milanskocic.github.io/iapws/ford/index.html\fP\X'tty: link'
.SS C API
.INDENT 0.0
.INDENT 3.5
.sp
.EX
#ifndef IAPWS_H
#define IAPWS_H

#if _MSC_VER
#define ADD_IMPORT __declspec(dllimport)
#else
#define ADD_IMPORT
#endif

extern char* iapws_get_version(void);

ADD_IMPORT extern const double iapws_r283_Tc_H2O; 
ADD_IMPORT extern const double iapws_r283_Tc_D2O;

ADD_IMPORT extern const double iapws_r283_pc_H2O;
ADD_IMPORT extern const double iapws_r283_pc_D2O;

ADD_IMPORT extern const double iapws_r283_rhoc_H2O;
ADD_IMPORT extern const double iapws_r283_rhoc_D2O;

extern void iapws_g704_kh(double *T, char *gas, int heavywater, double *k, int size_gas, size_t size_T);
extern void iapws_g704_kd(double *T, char *gas, int heavywater, double *k, int size_gas, size_t size_T);
extern int iapws_g704_ngases(int heavywater);
extern char **iapws_g704_gases(int heavywater);
extern char *iapws_g704_gases2(int heavywater);



extern void iapws_r797_psat(size_t N, double *Ts, double *ps);
extern void iapws_r797_Tsat(size_t N, double *ps, double *Ts);
extern void iapws_r797_wp(double *p, double  *T, char *prop, double *res, size_t N, size_t len); 
extern void iapws_r797_wr(double *p, double *T, int *res, size_t N);
extern void iapws_r797_wph(double *p, double *T, char *res, size_t N);



extern void iapws_r1124_Kw(size_t N, double *T, double *rhow, double *k);

#endif

.EE
.UNINDENT
.UNINDENT
.SS Python
.sp
Python wrapper of the (Modern Fortran) iapws library.
.INDENT 0.0
.TP
.B Kw(T: ndarray, rhow: ndarray)
Compute the ionization constant of water Kw.
Validity range 273.13 K <= T <= 1273.15 K and 0 <= p <= 1000 MPa.
.INDENT 7.0
.TP
.B Parameters
.INDENT 7.0
.TP
\fBT: int, float or 1d\-array.\fP
Temperature in K.
.TP
\fBrhow: int, float or 1d\-array.\fP
Mass density in g.cm\-3.
.UNINDENT
.TP
.B Returns
.INDENT 7.0
.TP
.B k: float or 1d\-array
Ionization constant.
.UNINDENT
.UNINDENT
.UNINDENT
.INDENT 0.0
.TP
.B Tsat(ps)
Compute the saturation temperature at pressure ps.
Validity range 611.213 Pa <= ps <= 22.064 MPa.
.INDENT 7.0
.TP
.B Parameters
.INDENT 7.0
.TP
\fBps: int, float or 1d\-array.\fP
Saturation pressure in MPa.
.UNINDENT
.TP
.B Returns
.INDENT 7.0
.TP
.B Ts: float or 1d\-array
Saturation temperatur in K. Is NaN if Ts is out of range of validity.
.UNINDENT
.UNINDENT
.UNINDENT
.INDENT 0.0
.TP
.B gases(heavywater: bool = False) -> List[str]
Get the list of available gases.
.INDENT 7.0
.TP
.B Parameters
.INDENT 7.0
.TP
\fBheavywater: bool, optional.\fP
Flag for indicating if solvent is heavywater (True) or water (False). Default to False.
.UNINDENT
.TP
.B Returns
.INDENT 7.0
.TP
.B gases: list of str
List of available gases.
.UNINDENT
.UNINDENT
.UNINDENT
.INDENT 0.0
.TP
.B gases2(heavywater: bool = False) -> str
Get the available gases as a string.
.INDENT 7.0
.TP
.B Parameters
.INDENT 7.0
.TP
\fBheavywater: bool, optional.\fP
Flag for indicating if solvent is heavywater (True) or water (False). Default to False.
.UNINDENT
.TP
.B Returns
.INDENT 7.0
.TP
.B gases: str
Available gases as comma separated string.
.UNINDENT
.UNINDENT
.UNINDENT
.INDENT 0.0
.TP
.B kd(T: ndarray, gas: str, heavywater: bool = False) -> ndarray | float
Get the vapor\-liquid constant for gas in H2O or D2O at T. 
If gas not found returns NaNs.
.INDENT 7.0
.TP
.B Parameters
.INDENT 7.0
.TP
\fBT: int, float, or 1d\-array.\fP
Temperature in K.
.TP
\fBgas: str\fP
Gas.
.TP
\fBheavywater: bool, optional.\fP
Flag for indicating if solvent is heavywater (True) or water (False). Default to False.
.UNINDENT
.TP
.B Returns
.INDENT 7.0
.TP
.B kd: float or 1d\-array
Adimensional liquid\-vapor constant.
.UNINDENT
.UNINDENT
.UNINDENT
.INDENT 0.0
.TP
.B kh(T: ndarray, gas: str, heavywater: bool = False) -> ndarray | float
Get the Henry constant for gas in H2O or D2O at T. 
If gas not found returns NaNs.
.INDENT 7.0
.TP
.B Parameters
.INDENT 7.0
.TP
\fBT: int, float or 1d\-array.\fP
Temperature in K.
.TP
\fBgas: str\fP
Gas.
.TP
\fBheavywater: bool, optional.\fP
Flag for indicating if solvent is heavywater (True) or water (False). Default to False.
.UNINDENT
.TP
.B Returns
.INDENT 7.0
.TP
.B kh: float or 1d\-array
Henry constant in MPa.
.UNINDENT
.UNINDENT
.UNINDENT
.INDENT 0.0
.TP
.B ngases(heavywater: bool = False) -> int
Get the number of available gases.
.INDENT 7.0
.TP
.B Parameters
.INDENT 7.0
.TP
\fBheavywater: bool, optional.\fP
Flag for indicating if solvent is heavywater (True) or water (False). Default to False.
.UNINDENT
.TP
.B Returns
.INDENT 7.0
.TP
.B n: int
Number of available gases in water or heavywater.
.UNINDENT
.UNINDENT
.UNINDENT
.INDENT 0.0
.TP
.B psat(Ts)
Compute the saturation pressure at temperature Ts. 
Validity range 273.13 K <= Ts <= 647.096 K.
.INDENT 7.0
.TP
.B Parameters
.INDENT 7.0
.TP
\fBTs: int, float or 1d\-array.\fP
Saturation temperature in K.
.UNINDENT
.TP
.B Returns
.INDENT 7.0
.TP
.B ps: float or 1d\-array
Saturation pressure in MPa. Is NaN if Ts is out of range of validity.
.UNINDENT
.UNINDENT
.UNINDENT
.INDENT 0.0
.TP
.B wp(p, T, prop)
Compute water properties at pressure p in MPa and temperature T in Kelvin.
The adequate region is selected according to p and T.
.INDENT 7.0
.TP
.B Available properties:
.INDENT 7.0
.IP \(bu 2
v: specific volume in m3/kg
.IP \(bu 2
u: specific internal energy in kJ/kg
.IP \(bu 2
s: specific entropy in kJ/kg
.IP \(bu 2
h: specific enthalpy in kJ/kg/K
.IP \(bu 2
cp: specific isobaric heat capacity in kJ/kg/K
.IP \(bu 2
cv: specific isochoric heat capacity in kJ/kg/K
.IP \(bu 2
w: speed of sound in m/s
.UNINDENT
.UNINDENT
.INDENT 7.0
.TP
.B Parameters
.INDENT 7.0
.TP
\fBp: int, float or 1d\-array.\fP
Pressure in MPa.
.TP
\fBT: int, float or 1d\-array.\fP
Temperature in K.
.TP
\fBprop: str\fP
.INDENT 7.0
.TP
.B Water property: 
.INDENT 7.0
.IP \(bu 2
v: specific volume in m3/kg
.IP \(bu 2
u: specific internal energy in kJ/kg
.IP \(bu 2
s: specific entropy in kJ/kg
.IP \(bu 2
h: specific enthalpy in kJ/kg/K
.IP \(bu 2
cp: specific isobaric heat capacity in kJ/kg/K
.IP \(bu 2
cv: specific isochoric heat capacity in kJ/kg/K
.IP \(bu 2
w: speed of sound in m/s
.UNINDENT
.UNINDENT
.TP
\fBReturns\fP
.TP
\fB\-\-\-\-\-\-\-\fP
.TP
\fBres: float or 1d\-array\fP
Computed property. Filled with NaN if no adequate region is found.
.UNINDENT
.UNINDENT
.UNINDENT
.INDENT 0.0
.TP
.B wph(p, T)
Get the water phase corresponding to p and T.
.INDENT 7.0
.TP
.B Parameters
.INDENT 7.0
.TP
\fBp: int, float or 1d\-array.\fP
Pressure in MPa.
.TP
\fBT: int, float or 1d\-array.\fP
Temperature in K.
.UNINDENT
.TP
.B Returns
.INDENT 7.0
.TP
.B region: str or 1d\-array
Phases: l(liquid), v(VAPOR), c(SUPER CRITICAL), s(SATURATION), n(UNKNOWN).
.UNINDENT
.UNINDENT
.UNINDENT
.INDENT 0.0
.TP
.B wr(p, T)
Get the water region corresponding to p and T.
.INDENT 7.0
.TP
.B Parameters
.INDENT 7.0
.TP
\fBp: int, float or 1d\-array.\fP
Pressure in MPa.
.TP
\fBT: int, float or 1d\-array.\fP
Temperature in K.
.UNINDENT
.TP
.B Returns
.INDENT 7.0
.TP
.B region: int or 1d\-array
Regions 1 to 5 or \-1 when not found.
.UNINDENT
.UNINDENT
.UNINDENT
.SH CHANGELOG
.SS 0.5.1
.INDENT 0.0
.IP \(bu 2
Refactoring the \fBconfigure.sh\fP script.
.IP \(bu 2
Remove support for 3.14t. No official release on python.org.
.IP \(bu 2
If binaries for Python 3.14t are needed you need to compile them by yourself.
.UNINDENT
.SS 0.5.0
.INDENT 0.0
.IP \(bu 2
Remove support for Python 3.9 and add support for Python 3.14(t).
.UNINDENT
.sp
\X'tty: link https://github.com/MilanSkocic/iapws/releases'\fI\%Full changelog\fP\X'tty: link'
.SS 0.4.1
.INDENT 0.0
.IP \(bu 2
Drop support for python 3.8 and add support for python 3.13.
.IP \(bu 2
Code cleaning in python C extensions.
.IP \(bu 2
Code refactoring in pure python modules for encapsulating C extensions.
.IP \(bu 2
Implementation of region 1 from R797.
.IP \(bu 2
Implementation of \fBKw\fP from R1124.
.IP \(bu 2
Add API for water properties \fBwp\fP, water region \fBwr\fP and water phase \fBwp\fP\&.
.IP \(bu 2
Documentation update.
.UNINDENT
.sp
Full changelog available at \X'tty: link https://github.com/MilanSkocic/iapws/releases'\fI\%github\fP\X'tty: link'
.SS 0.4.0
.INDENT 0.0
.IP \(bu 2
Implementation of the region 4 in R7\-97.
.IP \(bu 2
API break for kh and kd in g704. The temperature must be provided in Kelvin instead of degrees Celsius.
.IP \(bu 2
Add dependency to numpy for python wrapper.
.IP \(bu 2
Add pure python modules for encapsulating C extensions.
.IP \(bu 2
Refactoring and code cleaning.
.IP \(bu 2
Documentation update.
.UNINDENT
.sp
Full changelog available at \X'tty: link https://github.com/MilanSkocic/iapws/releases'\fI\%github\fP\X'tty: link'
.SS 0.3.0
.INDENT 0.0
.IP \(bu 2
API break: functions for the Fortran code were renamed:
.INDENT 2.0
.IP \(bu 2
They do not contain the package+module in the name for the sake of simplicity
.IP \(bu 2
The package is only added in the functions for the C API in order to have a namespace\-like behavior.
.IP \(bu 2
If needed for solving conflicts with other packages, the functions can be aliased.
.UNINDENT
.IP \(bu 2
Separate sources files for the C API code for each module.
.IP \(bu 2
Implement tests with the test\-drive framework.
.IP \(bu 2
Add version extension in the pywrapper.
.IP \(bu 2
Implement version module with its getter.
.IP \(bu 2
Documentation update.
.UNINDENT
.sp
Full changelog available at \X'tty: link https://github.com/MilanSkocic/iapws/releases'\fI\%github\fP\X'tty: link'
.SS 0.2.2
.INDENT 0.0
.IP \(bu 2
Implementation of report R283 for critical constants of water.
.IP \(bu 2
Switch to pyproject.toml for python wrapper.
.IP \(bu 2
Code refactoring and clean up.
.IP \(bu 2
Documentation update.
.UNINDENT
.sp
Full changelog available at \X'tty: link https://github.com/MilanSkocic/iapws/releases'\fI\%github\fP\X'tty: link'
.SS 0.2.1
.INDENT 0.0
.IP \(bu 2
Comlete missing documentation of private functions.
.IP \(bu 2
Minor fixes in C API code as well in python wrapper.
.IP \(bu 2
Remove unecessary dependency in Makefile.
.UNINDENT
.sp
Full changelog available at \X'tty: link https://github.com/MilanSkocic/iapws/releases'\fI\%github\fP\X'tty: link'
.SS 0.2.0
.INDENT 0.0
.IP \(bu 2
New structure with modules corresponding to the IAPWS papers.
.IP \(bu 2
Compatible with fpm.
.IP \(bu 2
fpm module naming convention.
.IP \(bu 2
API break for iapws_g704_kh and iapws_g704_kd functions:
.INDENT 2.0
.IP \(bu 2
only 1d\-arrays as inputs in Fortran and C API.
.IP \(bu 2
only objects with buffer protocol as inputs in python wrapper.
.IP \(bu 2
python wrappers return memoryviews.
.UNINDENT
.IP \(bu 2
New functions:
.INDENT 2.0
.IP \(bu 2
providing the number of gases in H2O and D2O.
.IP \(bu 2
providing the available of gases in H2O and D2O as list of strings.
.IP \(bu 2
providing the available of gases in H2O and D2O as a unique string.
.UNINDENT
.IP \(bu 2
Cleanup old app code not needed anymore.
.IP \(bu 2
Fix memory allocation in pywrapper.
.IP \(bu 2
Completed tests.
.IP \(bu 2
Documentation improvements:
.INDENT 2.0
.IP \(bu 2
Add conversion equations from molar fractions to solubilities.
.IP \(bu 2
Add plots for visualizing kh and kd.
.UNINDENT
.UNINDENT
.sp
Full changelog available at \X'tty: link https://github.com/MilanSkocic/iapws/releases'\fI\%github\fP\X'tty: link'
.SS 0.1.1
.INDENT 0.0
.IP \(bu 2
Logo creation
.IP \(bu 2
Error handling in python wrapper for arrays with rank greater than 1
.IP \(bu 2
Tests in python wrapper for expected failures with rank\-n arrays
.UNINDENT
.sp
Full changelog available at \X'tty: link https://github.com/MilanSkocic/iapws/releases'\fI\%github\fP\X'tty: link'
.SS 0.1.0
.INDENT 0.0
.IP \(bu 2
Implementation of kH and kD from IAPWS G7\-04 in fortran + C API
.IP \(bu 2
Python wrapper for kH and kD.
.IP \(bu 2
Documentation with sphinx.
.UNINDENT
.sp
Full changelog available at \X'tty: link https://github.com/MilanSkocic/iapws/releases'\fI\%github\fP\X'tty: link'
.IP [1] 5
IAPWS. Release on the Values of Temperature, Pressure and Density of Ordinary and Heavy Water Substances at Their Respective Critical Points\&. Technical Report R2\-83, IAPWS, 1992.
.IP [2] 5
IAPWS. Guideline on the Henry\(aqs Constant and Vapor\-Liquid Distribution Constant for Gases in H2O and D2O at High Temperatures\&. Technical Report G7\-04, IAPWS, 2004.
.IP [3] 5
IAPWS. Revised Release on the IAPWS Industrial Formulation 1997 for the Thermodynamic Properties of Water and Steam\&. Technical Report R7\-97, IAPWS, 2012.
.IP [4] 5
Wolfgang Wagner and A.\ Pruss. International Equations for the Saturation Properties of Ordinary Water Substance\&. Revised According to the International Temperature Scale of 1990. Addendum to J\&. Phys\&. Chem\&. Ref\&. Data 16, 893 (1987). \fIJournal of Physical and Chemical Reference Data\fP, 22(3):783–787, 1993\-05\-01. URL: \X'tty: link https://doi.org/10.1063/1.555926'\fI\%https://doi.org/10.1063/1.555926\fP\X'tty: link', \X'tty: link https://doi.org/10.1063/1.555926'\fI\%doi:10.1063/1.555926\fP\X'tty: link'\&.
.IP [5] 5
Allan\ H. Harvey and Eric\ W. Lemmon. Correlation for the Vapor Pressure of Heavy Water From the Triple Point to the Critical Point\&. \fIJournal of Physical and Chemical Reference Data\fP, 31(1):173–181, 2002\-03\-01. URL: \X'tty: link https://doi.org/10.1063/1.1430231'\fI\%https://doi.org/10.1063/1.1430231\fP\X'tty: link', \X'tty: link https://doi.org/10.1063/1.1430231'\fI\%doi:10.1063/1.1430231\fP\X'tty: link'\&.
.IP [6] 5
W.\ Wagner and A.\ Pruß. The IAPWS Formulation 1995 for the Thermodynamic Properties of Ordinary Water Substance for General and Scientific Use\&. \fIJournal of Physical and Chemical Reference Data\fP, 31(2):387–535, 2002\-06\-07. URL: \X'tty: link https://doi.org/10.1063/1.1461829'\fI\%https://doi.org/10.1063/1.1461829\fP\X'tty: link', \X'tty: link https://doi.org/10.1063/1.1461829'\fI\%doi:10.1063/1.1461829\fP\X'tty: link'\&.
.IP [7] 5
R.\ Fernandez\-Prini, J.L. Alvarez, and A.H. Harvey. Henry\(aqs Constants and Vapor–Liquid Distribution Constants for Gaseous Solutes in H2O and D2O at High Temperatures\&. \fIJournal of Physical Chemistry Reference Data\fP, 32(2):903–916, 2003.
.IP [8] 5
Andrei\ V. Bandura and Serguei\ N. Lvov. The ionization constant of water over wide ranges of temperature and density. \fIJournal of Physical and Chemical Reference Data\fP, 35(1):15–30, 12 2005. URL: \X'tty: link https://doi.org/10.1063/1.1928231'\fI\%https://doi.org/10.1063/1.1928231\fP\X'tty: link', \X'tty: link https://arxiv.org/abs/https://pubs.aip.org/aip/jpr/article-pdf/35/1/15/16717791/15\_1\_online.pdf'\fI\%arXiv:https://pubs.aip.org/aip/jpr/article\-pdf/35/1/15/16717791/15\e_1\e_online.pdf\fP\X'tty: link', \X'tty: link https://doi.org/10.1063/1.1928231'\fI\%doi:10.1063/1.1928231\fP\X'tty: link'\&.
.IP [9] 5
IAPWS. Revised Release on the IAPWS Formulation 1995 for the Thermodynamic Properties of Ordinary Water Substance for General and Scientific Use\&. Technical Report R6\-95, IAPWS, 2018.
.IP [10] 5
IAPWS. Revised release on the ionization constant of h2o. Technical Report R11\-24, IAPWS, 2012.
.SH AUTHOR
Milan Skocic
.SH COPYRIGHT
2021-2024, Milan Skocic
.\" Generated by docutils manpage writer.
.
