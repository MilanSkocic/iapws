var tipuesearch = {"pages":[{"title":" iapws ","text":"iapws BACK TO MAIN Developer Info M. Skocic","tags":"home","url":"index.html"},{"title":"c_char_p – iapws ","text":"type, public, bind(C) :: c_char_p Inherits type~~c_char_p~~InheritsGraph type~c_char_p c_char_p c_ptr c_ptr type~c_char_p->c_ptr p Help Graph Key Nodes of different colours represent the following: Graph Key Type Type This Page's Entity This Page's Entity Solid arrows point from a derived type to the parent type which it\nextends. Dashed arrows point from a derived type to the other\ntypes it contains as a components, with a label listing the name(s) of\nsaid component(s). Components Type Visibility Attributes Name Initial type(c_ptr), public :: p","tags":"","url":"type/c_char_p.html"},{"title":"cgas_type – iapws ","text":"type, public :: cgas_type Components Type Visibility Attributes Name Initial character(kind=c_char, len=1), public, allocatable :: gas (:)","tags":"","url":"type/cgas_type.html"},{"title":"gas_type – iapws ","text":"type, public :: gas_type Derived type containing a allocatable string for representing a gas. Components Type Visibility Attributes Name Initial character(len=:), public, allocatable :: gas Gas","tags":"","url":"type/gas_type.html"},{"title":"rai – iapws","text":"interface public pure subroutine rai(p, T, prop, res) Arguments Type Intent Optional Attributes Name real(kind=dp), intent(in) :: p (:) real(kind=dp), intent(in) :: T (:) character(len=*), intent(in) :: prop real(kind=dp), intent(out) :: res (:)","tags":"","url":"interface/rai.html"},{"title":"get_version – iapws","text":"public  function get_version() result(fptr) Return the version Arguments None Return Value character(len=:), pointer Fortran pointer to a string indicating the version.. Called by proc~~get_version~~CalledByGraph proc~get_version get_version proc~capi_get_version capi_get_version proc~capi_get_version->proc~get_version Help Graph Key Nodes of different colours represent the following: Graph Key Subroutine Subroutine Function Function Interface Interface Type Bound Procedure Type Bound Procedure Unknown Procedure Type Unknown Procedure Type Program Program This Page's Entity This Page's Entity Solid arrows point from a procedure to one which it calls. Dashed \narrows point from an interface to procedures which implement that interface.\nThis could include the module procedures in a generic interface or the\nimplementation in a submodule of an interface in a parent module.","tags":"","url":"proc/get_version.html"},{"title":"Kw – iapws","text":"public pure subroutine Kw(T, rhow, k) Compute the ionization constant of water Kw.\nValidity range 273.13 K <= T <= 1273.15 K and 0 <= p <= 1000 MPa. Arguments Type Intent Optional Attributes Name real(kind=dp), intent(in) :: T (:) Temperature in K. real(kind=dp), intent(in) :: rhow (:) Mass density in g.cm&#94;{-3}. real(kind=dp), intent(out) :: k (:) Ionization constant. Filled with NaN if out of validity range. Calls proc~~kw~~CallsGraph proc~kw Kw proc~pkw pKw proc~kw->proc~pkw Help Graph Key Nodes of different colours represent the following: Graph Key Subroutine Subroutine Function Function Interface Interface Type Bound Procedure Type Bound Procedure Unknown Procedure Type Unknown Procedure Type Program Program This Page's Entity This Page's Entity Solid arrows point from a procedure to one which it calls. Dashed \narrows point from an interface to procedures which implement that interface.\nThis could include the module procedures in a generic interface or the\nimplementation in a submodule of an interface in a parent module. Called by proc~~kw~~CalledByGraph proc~kw Kw proc~capi_kw capi_Kw proc~capi_kw->proc~kw Help Graph Key Nodes of different colours represent the following: Graph Key Subroutine Subroutine Function Function Interface Interface Type Bound Procedure Type Bound Procedure Unknown Procedure Type Unknown Procedure Type Program Program This Page's Entity This Page's Entity Solid arrows point from a procedure to one which it calls. Dashed \narrows point from an interface to procedures which implement that interface.\nThis could include the module procedures in a generic interface or the\nimplementation in a submodule of an interface in a parent module.","tags":"","url":"proc/kw.html"},{"title":"Tsat – iapws","text":"public pure subroutine Tsat(ps, Ts) Compute the saturation temperature at pressure ps.\nValidity range 611.213 Pa <= ps <= 22.064 MPa. Arguments Type Intent Optional Attributes Name real(kind=dp), intent(in), contiguous :: ps (:) Saturation pressure in MPa. real(kind=dp), intent(out), contiguous :: Ts (:) Saturation temperature in K. Filled with nan if out of validity range. Calls proc~~tsat~~CallsGraph proc~tsat Tsat proc~r4_ts r4_Ts proc~tsat->proc~r4_ts Help Graph Key Nodes of different colours represent the following: Graph Key Subroutine Subroutine Function Function Interface Interface Type Bound Procedure Type Bound Procedure Unknown Procedure Type Unknown Procedure Type Program Program This Page's Entity This Page's Entity Solid arrows point from a procedure to one which it calls. Dashed \narrows point from an interface to procedures which implement that interface.\nThis could include the module procedures in a generic interface or the\nimplementation in a submodule of an interface in a parent module. Called by proc~~tsat~~CalledByGraph proc~tsat Tsat proc~capi_tsat capi_Tsat proc~capi_tsat->proc~tsat Help Graph Key Nodes of different colours represent the following: Graph Key Subroutine Subroutine Function Function Interface Interface Type Bound Procedure Type Bound Procedure Unknown Procedure Type Unknown Procedure Type Program Program This Page's Entity This Page's Entity Solid arrows point from a procedure to one which it calls. Dashed \narrows point from an interface to procedures which implement that interface.\nThis could include the module procedures in a generic interface or the\nimplementation in a submodule of an interface in a parent module.","tags":"","url":"proc/tsat.html"},{"title":"psat – iapws","text":"public pure subroutine psat(Ts, ps) Compute the saturation pressure at temperature Ts. \nValidity range 273.13 K <= Ts <= 647.096 K. Arguments Type Intent Optional Attributes Name real(kind=dp), intent(in), contiguous :: Ts (:) Saturation temperature in K. real(kind=dp), intent(out), contiguous :: ps (:) Saturation pressure in MPa. Filled with nan if out of validity range. Calls proc~~psat~~CallsGraph proc~psat psat proc~r4_ps r4_ps proc~psat->proc~r4_ps Help Graph Key Nodes of different colours represent the following: Graph Key Subroutine Subroutine Function Function Interface Interface Type Bound Procedure Type Bound Procedure Unknown Procedure Type Unknown Procedure Type Program Program This Page's Entity This Page's Entity Solid arrows point from a procedure to one which it calls. Dashed \narrows point from an interface to procedures which implement that interface.\nThis could include the module procedures in a generic interface or the\nimplementation in a submodule of an interface in a parent module. Called by proc~~psat~~CalledByGraph proc~psat psat proc~capi_psat capi_psat proc~capi_psat->proc~psat Help Graph Key Nodes of different colours represent the following: Graph Key Subroutine Subroutine Function Function Interface Interface Type Bound Procedure Type Bound Procedure Unknown Procedure Type Unknown Procedure Type Program Program This Page's Entity This Page's Entity Solid arrows point from a procedure to one which it calls. Dashed \narrows point from an interface to procedures which implement that interface.\nThis could include the module procedures in a generic interface or the\nimplementation in a submodule of an interface in a parent module.","tags":"","url":"proc/psat.html"},{"title":"wp – iapws","text":"public pure subroutine wp(p, T, prop, res) Compute water properties at pressure p in MPa and temperature T in Kelvin.\nThe adequate region is selected according to p and T. Available properties:\n    * v: specific volume in m3/kg\n    * u: specific internal energy in kJ/kg\n    * s: specific entropy in kJ/kg \n    * h: specific enthalpy in kJ/kg/K\n    * cp: specific isobaric heat capacity in kJ/kg/K\n    * cv: specific isochoric heat capacity in kJ/kg/K\n    * w: speed of sound in m/s Arguments Type Intent Optional Attributes Name real(kind=dp), intent(in) :: p (:) Pressure in MPa. real(kind=dp), intent(in) :: T (:) Pressure in K. character(len=*), intent(in) :: prop Property real(kind=dp), intent(out) :: res (:) Filled with NaN if no adequate region is found. Calls proc~~wp~~CallsGraph proc~wp wp proc~find_region find_region proc~wp->proc~find_region proc~get_r get_r proc~wp->proc~get_r proc~is1region is1region proc~wp->proc~is1region proc~r4_ps r4_ps proc~find_region->proc~r4_ps Help Graph Key Nodes of different colours represent the following: Graph Key Subroutine Subroutine Function Function Interface Interface Type Bound Procedure Type Bound Procedure Unknown Procedure Type Unknown Procedure Type Program Program This Page's Entity This Page's Entity Solid arrows point from a procedure to one which it calls. Dashed \narrows point from an interface to procedures which implement that interface.\nThis could include the module procedures in a generic interface or the\nimplementation in a submodule of an interface in a parent module. Called by proc~~wp~~CalledByGraph proc~wp wp proc~capi_wp capi_wp proc~capi_wp->proc~wp Help Graph Key Nodes of different colours represent the following: Graph Key Subroutine Subroutine Function Function Interface Interface Type Bound Procedure Type Bound Procedure Unknown Procedure Type Unknown Procedure Type Program Program This Page's Entity This Page's Entity Solid arrows point from a procedure to one which it calls. Dashed \narrows point from an interface to procedures which implement that interface.\nThis could include the module procedures in a generic interface or the\nimplementation in a submodule of an interface in a parent module.","tags":"","url":"proc/wp.html"},{"title":"wph – iapws","text":"public pure subroutine wph(p, T, res) Get the water phase corresponding to p and T.\nPhases: l(liquid), v(VAPOR), c(SUPER CRITICAL), s(SATURATION), n(UNKNOWN). Arguments Type Intent Optional Attributes Name real(kind=dp), intent(in) :: p (:) pressure in MPa. real(kind=dp), intent(in) :: T (:) Temperature in K. character(len=1), intent(out) :: res (:) Phase (l, v, c, s, n) Calls proc~~wph~~CallsGraph proc~wph wph proc~find_phase find_phase proc~wph->proc~find_phase proc~find_region find_region proc~find_phase->proc~find_region proc~r4_ps r4_ps proc~find_region->proc~r4_ps Help Graph Key Nodes of different colours represent the following: Graph Key Subroutine Subroutine Function Function Interface Interface Type Bound Procedure Type Bound Procedure Unknown Procedure Type Unknown Procedure Type Program Program This Page's Entity This Page's Entity Solid arrows point from a procedure to one which it calls. Dashed \narrows point from an interface to procedures which implement that interface.\nThis could include the module procedures in a generic interface or the\nimplementation in a submodule of an interface in a parent module. Called by proc~~wph~~CalledByGraph proc~wph wph proc~capi_wph capi_wph proc~capi_wph->proc~wph Help Graph Key Nodes of different colours represent the following: Graph Key Subroutine Subroutine Function Function Interface Interface Type Bound Procedure Type Bound Procedure Unknown Procedure Type Unknown Procedure Type Program Program This Page's Entity This Page's Entity Solid arrows point from a procedure to one which it calls. Dashed \narrows point from an interface to procedures which implement that interface.\nThis could include the module procedures in a generic interface or the\nimplementation in a submodule of an interface in a parent module.","tags":"","url":"proc/wph.html"},{"title":"wr – iapws","text":"public pure subroutine wr(p, T, res) Get the water region corresponding to p and T.\nRegions 1 to 5 or -1 when not found. Arguments Type Intent Optional Attributes Name real(kind=dp), intent(in) :: p (:) Pressure in MPa. real(kind=dp), intent(in) :: T (:) Temperature in K. integer(kind=int32), intent(out) :: res (:) Region (1-5) Calls proc~~wr~~CallsGraph proc~wr wr proc~find_region find_region proc~wr->proc~find_region proc~r4_ps r4_ps proc~find_region->proc~r4_ps Help Graph Key Nodes of different colours represent the following: Graph Key Subroutine Subroutine Function Function Interface Interface Type Bound Procedure Type Bound Procedure Unknown Procedure Type Unknown Procedure Type Program Program This Page's Entity This Page's Entity Solid arrows point from a procedure to one which it calls. Dashed \narrows point from an interface to procedures which implement that interface.\nThis could include the module procedures in a generic interface or the\nimplementation in a submodule of an interface in a parent module. Called by proc~~wr~~CalledByGraph proc~wr wr proc~capi_wr capi_wr proc~capi_wr->proc~wr Help Graph Key Nodes of different colours represent the following: Graph Key Subroutine Subroutine Function Function Interface Interface Type Bound Procedure Type Bound Procedure Unknown Procedure Type Unknown Procedure Type Program Program This Page's Entity This Page's Entity Solid arrows point from a procedure to one which it calls. Dashed \narrows point from an interface to procedures which implement that interface.\nThis could include the module procedures in a generic interface or the\nimplementation in a submodule of an interface in a parent module.","tags":"","url":"proc/wr.html"},{"title":"pKw – iapws","text":"public pure elemental function pKw(T, rhow) result(res) Ionization constant of water.\nValidity range 273.13 K <= T <= 1273.15 K and 0 <= p <= 1000 MPa. Arguments Type Intent Optional Attributes Name real(kind=dp), intent(in) :: T Temperature in K. real(kind=dp), intent(in) :: rhow Mass density in g.cm&#94;{-3}. Return Value real(kind=dp) Called by proc~~pkw~~CalledByGraph proc~pkw pKw proc~kw Kw proc~kw->proc~pkw proc~capi_kw capi_Kw proc~capi_kw->proc~kw Help Graph Key Nodes of different colours represent the following: Graph Key Subroutine Subroutine Function Function Interface Interface Type Bound Procedure Type Bound Procedure Unknown Procedure Type Unknown Procedure Type Program Program This Page's Entity This Page's Entity Solid arrows point from a procedure to one which it calls. Dashed \narrows point from an interface to procedures which implement that interface.\nThis could include the module procedures in a generic interface or the\nimplementation in a submodule of an interface in a parent module.","tags":"","url":"proc/pkw.html"},{"title":"capi_gases – iapws","text":"public  function capi_gases(heavywater) result(list_gases) bind(C, name=\"iapws_g704_gases\")) C API. Arguments Type Intent Optional Attributes Name integer(kind=c_int), intent(in), value :: heavywater Flag if D2O (1) is used or H2O(0). Return Value type(c_ptr) Available gases. Calls proc~~capi_gases~~CallsGraph proc~capi_gases capi_gases proc~gases gases proc~capi_gases->proc~gases Help Graph Key Nodes of different colours represent the following: Graph Key Subroutine Subroutine Function Function Interface Interface Type Bound Procedure Type Bound Procedure Unknown Procedure Type Unknown Procedure Type Program Program This Page's Entity This Page's Entity Solid arrows point from a procedure to one which it calls. Dashed \narrows point from an interface to procedures which implement that interface.\nThis could include the module procedures in a generic interface or the\nimplementation in a submodule of an interface in a parent module. Variables Type Visibility Attributes Name Initial type( gas_type ), public, pointer :: f_gases (:) => null() integer(kind=int32), public :: i integer(kind=int32), public :: j integer(kind=int32), public :: n integer(kind=int32), public :: ngas","tags":"","url":"proc/capi_gases.html"},{"title":"capi_gases2 – iapws","text":"public  function capi_gases2(heavywater) result(str_gases) bind(C, name=\"iapws_g704_gases2\")) C API. Arguments Type Intent Optional Attributes Name integer(kind=c_int), intent(in), value :: heavywater Flag if D2O (1) is used or H2O(0). Return Value type(c_ptr) Available gases. Calls proc~~capi_gases2~~CallsGraph proc~capi_gases2 capi_gases2 proc~gases2 gases2 proc~capi_gases2->proc~gases2 proc~gases gases proc~gases2->proc~gases Help Graph Key Nodes of different colours represent the following: Graph Key Subroutine Subroutine Function Function Interface Interface Type Bound Procedure Type Bound Procedure Unknown Procedure Type Unknown Procedure Type Program Program This Page's Entity This Page's Entity Solid arrows point from a procedure to one which it calls. Dashed \narrows point from an interface to procedures which implement that interface.\nThis could include the module procedures in a generic interface or the\nimplementation in a submodule of an interface in a parent module. Variables Type Visibility Attributes Name Initial character(len=:), public, pointer :: f_gases_str => null()","tags":"","url":"proc/capi_gases2.html"},{"title":"capi_get_version – iapws","text":"public  function capi_get_version() result(cptr) bind(c,name=\"iapws_get_version\")) C API Arguments None Return Value type(c_ptr) Pointer to version string. Calls proc~~capi_get_version~~CallsGraph proc~capi_get_version capi_get_version proc~get_version get_version proc~capi_get_version->proc~get_version Help Graph Key Nodes of different colours represent the following: Graph Key Subroutine Subroutine Function Function Interface Interface Type Bound Procedure Type Bound Procedure Unknown Procedure Type Unknown Procedure Type Program Program This Page's Entity This Page's Entity Solid arrows point from a procedure to one which it calls. Dashed \narrows point from an interface to procedures which implement that interface.\nThis could include the module procedures in a generic interface or the\nimplementation in a submodule of an interface in a parent module. Variables Type Visibility Attributes Name Initial character(len=:), public, pointer :: fptr","tags":"","url":"proc/capi_get_version.html"},{"title":"capi_ngases – iapws","text":"public  function capi_ngases(heavywater) result(n) bind(C, name=\"iapws_g704_ngases\")) C API. Arguments Type Intent Optional Attributes Name integer(kind=c_int), intent(in), value :: heavywater Flag if D2O (1) is used or H2O(0). Return Value integer(kind=c_int) Number of gases. Calls proc~~capi_ngases~~CallsGraph proc~capi_ngases capi_ngases proc~ngases ngases proc~capi_ngases->proc~ngases Help Graph Key Nodes of different colours represent the following: Graph Key Subroutine Subroutine Function Function Interface Interface Type Bound Procedure Type Bound Procedure Unknown Procedure Type Unknown Procedure Type Program Program This Page's Entity This Page's Entity Solid arrows point from a procedure to one which it calls. Dashed \narrows point from an interface to procedures which implement that interface.\nThis could include the module procedures in a generic interface or the\nimplementation in a submodule of an interface in a parent module.","tags":"","url":"proc/capi_ngases.html"},{"title":"capi_Kw – iapws","text":"public  subroutine capi_Kw(N, T, rhow, k) bind(C, name=\"iapws_r1124_Kw\") C API. Arguments Type Intent Optional Attributes Name integer(kind=c_size_t), intent(in), value :: N Size of T, rhow and k. real(kind=c_double), intent(in) :: T (N) Temperature in K. real(kind=c_double), intent(in) :: rhow (N) Mass density in g.cm&#94;{-3}. real(kind=c_double), intent(out) :: k (N) Ionization constant. Filled with NaN if out of validity range. Calls proc~~capi_kw~~CallsGraph proc~capi_kw capi_Kw proc~kw Kw proc~capi_kw->proc~kw proc~pkw pKw proc~kw->proc~pkw Help Graph Key Nodes of different colours represent the following: Graph Key Subroutine Subroutine Function Function Interface Interface Type Bound Procedure Type Bound Procedure Unknown Procedure Type Unknown Procedure Type Program Program This Page's Entity This Page's Entity Solid arrows point from a procedure to one which it calls. Dashed \narrows point from an interface to procedures which implement that interface.\nThis could include the module procedures in a generic interface or the\nimplementation in a submodule of an interface in a parent module.","tags":"","url":"proc/capi_kw.html"},{"title":"capi_Tsat – iapws","text":"public  subroutine capi_Tsat(N, ps, Ts) bind(C, name=\"iapws_r797_Tsat\") C API. Arguments Type Intent Optional Attributes Name integer(kind=c_size_t), intent(in), value :: N Size of ps and Ts. real(kind=c_double), intent(in) :: ps (N) Saturation pressure in MPa. real(kind=c_double), intent(out) :: Ts (N) Saturation temperature in K. Filled with nan if out of validity range. Calls proc~~capi_tsat~~CallsGraph proc~capi_tsat capi_Tsat proc~tsat Tsat proc~capi_tsat->proc~tsat proc~r4_ts r4_Ts proc~tsat->proc~r4_ts Help Graph Key Nodes of different colours represent the following: Graph Key Subroutine Subroutine Function Function Interface Interface Type Bound Procedure Type Bound Procedure Unknown Procedure Type Unknown Procedure Type Program Program This Page's Entity This Page's Entity Solid arrows point from a procedure to one which it calls. Dashed \narrows point from an interface to procedures which implement that interface.\nThis could include the module procedures in a generic interface or the\nimplementation in a submodule of an interface in a parent module.","tags":"","url":"proc/capi_tsat.html"},{"title":"capi_kd – iapws","text":"public  subroutine capi_kd(T, gas, heavywater, k, size_gas, size_T) bind(C,name=\"iapws_g704_kd\") C API. Arguments Type Intent Optional Attributes Name real(kind=c_double), intent(in) :: T (size_T) Temperature in °C. type(c_ptr), intent(in), value :: gas Gas. integer(kind=c_int), intent(in), value :: heavywater Flag if D2O (1) is used or H2O(0). real(kind=c_double), intent(inout) :: k (size_T) Vapor-liquid constant. Filled with NaNs if gas not found. integer(kind=c_int), intent(in), value :: size_gas Size of the gas string. integer(kind=c_size_t), intent(in), value :: size_T Size of T and k. Calls proc~~capi_kd~~CallsGraph proc~capi_kd capi_kd proc~kd kd proc~capi_kd->proc~kd Help Graph Key Nodes of different colours represent the following: Graph Key Subroutine Subroutine Function Function Interface Interface Type Bound Procedure Type Bound Procedure Unknown Procedure Type Unknown Procedure Type Program Program This Page's Entity This Page's Entity Solid arrows point from a procedure to one which it calls. Dashed \narrows point from an interface to procedures which implement that interface.\nThis could include the module procedures in a generic interface or the\nimplementation in a submodule of an interface in a parent module. Variables Type Visibility Attributes Name Initial character(len=1), public, pointer, dimension(:) :: c2f_gas character(len=size_gas), public :: f_gas integer(kind=int32), public :: i","tags":"","url":"proc/capi_kd.html"},{"title":"capi_kh – iapws","text":"public  subroutine capi_kh(T, gas, heavywater, k, size_gas, size_T) bind(C,name=\"iapws_g704_kh\") C API. Arguments Type Intent Optional Attributes Name real(kind=c_double), intent(in) :: T (size_T) Temperature in °C. type(c_ptr), intent(in), value :: gas Gas. integer(kind=c_int), intent(in), value :: heavywater Flag if D2O (1) is used or H2O(0). real(kind=c_double), intent(inout) :: k (size_T) Henry constant. Filled with NaNs if gas not found. integer(kind=c_int), intent(in), value :: size_gas Size of the gas string. integer(kind=c_size_t), intent(in), value :: size_T Size of T and k. Calls proc~~capi_kh~~CallsGraph proc~capi_kh capi_kh proc~kh kh proc~capi_kh->proc~kh Help Graph Key Nodes of different colours represent the following: Graph Key Subroutine Subroutine Function Function Interface Interface Type Bound Procedure Type Bound Procedure Unknown Procedure Type Unknown Procedure Type Program Program This Page's Entity This Page's Entity Solid arrows point from a procedure to one which it calls. Dashed \narrows point from an interface to procedures which implement that interface.\nThis could include the module procedures in a generic interface or the\nimplementation in a submodule of an interface in a parent module. Variables Type Visibility Attributes Name Initial character(len=1), public, pointer, dimension(:) :: c2f_gas character(len=size_gas), public :: f_gas integer(kind=int32), public :: i","tags":"","url":"proc/capi_kh.html"},{"title":"capi_psat – iapws","text":"public  subroutine capi_psat(N, Ts, ps) bind(C, name=\"iapws_r797_psat\") C API. Arguments Type Intent Optional Attributes Name integer(kind=c_size_t), intent(in), value :: N Size of Ts and ps. real(kind=c_double), intent(in) :: Ts (N) Saturation temperature in K. real(kind=c_double), intent(out) :: ps (N) Saturation pressure in MPa. Filled with nan if out of validity range. Calls proc~~capi_psat~~CallsGraph proc~capi_psat capi_psat proc~psat psat proc~capi_psat->proc~psat proc~r4_ps r4_ps proc~psat->proc~r4_ps Help Graph Key Nodes of different colours represent the following: Graph Key Subroutine Subroutine Function Function Interface Interface Type Bound Procedure Type Bound Procedure Unknown Procedure Type Unknown Procedure Type Program Program This Page's Entity This Page's Entity Solid arrows point from a procedure to one which it calls. Dashed \narrows point from an interface to procedures which implement that interface.\nThis could include the module procedures in a generic interface or the\nimplementation in a submodule of an interface in a parent module.","tags":"","url":"proc/capi_psat.html"},{"title":"capi_wp – iapws","text":"public  subroutine capi_wp(p, T, prop, res, N, len) bind(C, name=\"iapws_r797_wp\") C API. Available properties:\n    * v: specific volume in m3/kg\n    * u: specific internal energy in kJ/kg\n    * s: specific entropy in kJ/kg \n    * h: specific enthalpy in kJ/kg/K\n    * cp: specific isobaric heat capacity in kJ/kg/K\n    * cv: specific isochoric heat capacity in kJ/kg/K\n    * w: speed of sound in m/s Arguments Type Intent Optional Attributes Name real(kind=c_double), intent(in) :: p (N) Pressure in MPa. real(kind=c_double), intent(in) :: T (N) Temperature in K. type(c_ptr), intent(in), value :: prop Water property. real(kind=c_double), intent(out) :: res (N) Result. Filled with NaNs if gas not found. integer(kind=c_size_t), intent(in), value :: N Size of T and p. integer(kind=c_int), intent(in), value :: len Size of the prop string. Calls proc~~capi_wp~~CallsGraph proc~capi_wp capi_wp proc~wp wp proc~capi_wp->proc~wp proc~find_region find_region proc~wp->proc~find_region proc~get_r get_r proc~wp->proc~get_r proc~is1region is1region proc~wp->proc~is1region proc~r4_ps r4_ps proc~find_region->proc~r4_ps Help Graph Key Nodes of different colours represent the following: Graph Key Subroutine Subroutine Function Function Interface Interface Type Bound Procedure Type Bound Procedure Unknown Procedure Type Unknown Procedure Type Program Program This Page's Entity This Page's Entity Solid arrows point from a procedure to one which it calls. Dashed \narrows point from an interface to procedures which implement that interface.\nThis could include the module procedures in a generic interface or the\nimplementation in a submodule of an interface in a parent module. Variables Type Visibility Attributes Name Initial character(len=1), public, pointer, dimension(:) :: cprop character(len=len), public :: fprop integer(kind=int32), public :: i","tags":"","url":"proc/capi_wp.html"},{"title":"capi_wph – iapws","text":"public  subroutine capi_wph(p, T, res, N) bind(C, name=\"iapws_r797_wph\") C API. Arguments Type Intent Optional Attributes Name real(kind=c_double), intent(in) :: p (N) Pressure in MPa. real(kind=c_double), intent(in) :: T (N) Temperature in K. character(kind=c_char, len=1), intent(out) :: res (N) Regions. integer(kind=c_size_t), intent(in), value :: N Size of T and p. Calls proc~~capi_wph~~CallsGraph proc~capi_wph capi_wph proc~wph wph proc~capi_wph->proc~wph proc~find_phase find_phase proc~wph->proc~find_phase proc~find_region find_region proc~find_phase->proc~find_region proc~r4_ps r4_ps proc~find_region->proc~r4_ps Help Graph Key Nodes of different colours represent the following: Graph Key Subroutine Subroutine Function Function Interface Interface Type Bound Procedure Type Bound Procedure Unknown Procedure Type Unknown Procedure Type Program Program This Page's Entity This Page's Entity Solid arrows point from a procedure to one which it calls. Dashed \narrows point from an interface to procedures which implement that interface.\nThis could include the module procedures in a generic interface or the\nimplementation in a submodule of an interface in a parent module.","tags":"","url":"proc/capi_wph.html"},{"title":"capi_wr – iapws","text":"public  subroutine capi_wr(p, T, res, N) bind(C, name=\"iapws_r797_wr\") C API. Arguments Type Intent Optional Attributes Name real(kind=c_double), intent(in) :: p (N) Pressure in MPa. real(kind=c_double), intent(in) :: T (N) Temperature in K. integer(kind=c_int), intent(out) :: res (N) Regions. integer(kind=c_size_t), intent(in), value :: N Size of T and p. Calls proc~~capi_wr~~CallsGraph proc~capi_wr capi_wr proc~wr wr proc~capi_wr->proc~wr proc~find_region find_region proc~wr->proc~find_region proc~r4_ps r4_ps proc~find_region->proc~r4_ps Help Graph Key Nodes of different colours represent the following: Graph Key Subroutine Subroutine Function Function Interface Interface Type Bound Procedure Type Bound Procedure Unknown Procedure Type Unknown Procedure Type Program Program This Page's Entity This Page's Entity Solid arrows point from a procedure to one which it calls. Dashed \narrows point from an interface to procedures which implement that interface.\nThis could include the module procedures in a generic interface or the\nimplementation in a submodule of an interface in a parent module.","tags":"","url":"proc/capi_wr.html"},{"title":"gases – iapws","text":"public  function gases(heavywater) result(list_gases) Returns the list of available gases. Arguments Type Intent Optional Attributes Name integer(kind=int32), intent(in) :: heavywater Flag if D2O (1) is used or H2O(0). Return Value type( gas_type ), pointer, (:) Available gases. Called by proc~~gases~~CalledByGraph proc~gases gases proc~capi_gases capi_gases proc~capi_gases->proc~gases proc~gases2 gases2 proc~gases2->proc~gases proc~capi_gases2 capi_gases2 proc~capi_gases2->proc~gases2 Help Graph Key Nodes of different colours represent the following: Graph Key Subroutine Subroutine Function Function Interface Interface Type Bound Procedure Type Bound Procedure Unknown Procedure Type Unknown Procedure Type Program Program This Page's Entity This Page's Entity Solid arrows point from a procedure to one which it calls. Dashed \narrows point from an interface to procedures which implement that interface.\nThis could include the module procedures in a generic interface or the\nimplementation in a submodule of an interface in a parent module.","tags":"","url":"proc/gases.html"},{"title":"gases2 – iapws","text":"public  function gases2(heavywater) result(str_gases) Returns the available gases as a string. Arguments Type Intent Optional Attributes Name integer(kind=int32), intent(in) :: heavywater Flag if D2O (1) is used or H2O(0). Return Value character(len=:), pointer Available gases Calls proc~~gases2~~CallsGraph proc~gases2 gases2 proc~gases gases proc~gases2->proc~gases Help Graph Key Nodes of different colours represent the following: Graph Key Subroutine Subroutine Function Function Interface Interface Type Bound Procedure Type Bound Procedure Unknown Procedure Type Unknown Procedure Type Program Program This Page's Entity This Page's Entity Solid arrows point from a procedure to one which it calls. Dashed \narrows point from an interface to procedures which implement that interface.\nThis could include the module procedures in a generic interface or the\nimplementation in a submodule of an interface in a parent module. Called by proc~~gases2~~CalledByGraph proc~gases2 gases2 proc~capi_gases2 capi_gases2 proc~capi_gases2->proc~gases2 Help Graph Key Nodes of different colours represent the following: Graph Key Subroutine Subroutine Function Function Interface Interface Type Bound Procedure Type Bound Procedure Unknown Procedure Type Unknown Procedure Type Program Program This Page's Entity This Page's Entity Solid arrows point from a procedure to one which it calls. Dashed \narrows point from an interface to procedures which implement that interface.\nThis could include the module procedures in a generic interface or the\nimplementation in a submodule of an interface in a parent module.","tags":"","url":"proc/gases2.html"},{"title":"ngases – iapws","text":"public pure function ngases(heavywater) result(n) Returns the number of gases. Arguments Type Intent Optional Attributes Name integer(kind=int32), intent(in) :: heavywater Flag if D2O (1) is used or H2O(0). Return Value integer(kind=int32) Number of gases. Called by proc~~ngases~~CalledByGraph proc~ngases ngases proc~capi_ngases capi_ngases proc~capi_ngases->proc~ngases Help Graph Key Nodes of different colours represent the following: Graph Key Subroutine Subroutine Function Function Interface Interface Type Bound Procedure Type Bound Procedure Unknown Procedure Type Unknown Procedure Type Program Program This Page's Entity This Page's Entity Solid arrows point from a procedure to one which it calls. Dashed \narrows point from an interface to procedures which implement that interface.\nThis could include the module procedures in a generic interface or the\nimplementation in a submodule of an interface in a parent module.","tags":"","url":"proc/ngases.html"},{"title":"kd – iapws","text":"public pure subroutine kd(T, gas, heavywater, k) Compute the vapor-liquid constant kd for a given temperature.\nThe molar fraction in vapor in related to kd: [ kd=y_2/x_2 [ Arguments Type Intent Optional Attributes Name real(kind=dp), intent(in), contiguous :: T (:) Temperature in K. character(len=*), intent(in) :: gas Gas. integer(kind=int32), intent(in) :: heavywater Flag if D2O (1) is used or H2O(0). real(kind=dp), intent(out), contiguous :: k (:) Vapor-liquid constant (adimensional). Filled with NaNs if gas not found. Called by proc~~kd~~CalledByGraph proc~kd kd proc~capi_kd capi_kd proc~capi_kd->proc~kd Help Graph Key Nodes of different colours represent the following: Graph Key Subroutine Subroutine Function Function Interface Interface Type Bound Procedure Type Bound Procedure Unknown Procedure Type Unknown Procedure Type Program Program This Page's Entity This Page's Entity Solid arrows point from a procedure to one which it calls. Dashed \narrows point from an interface to procedures which implement that interface.\nThis could include the module procedures in a generic interface or the\nimplementation in a submodule of an interface in a parent module.","tags":"","url":"proc/kd.html"},{"title":"kh – iapws","text":"public pure subroutine kh(T, gas, heavywater, k) Compute the henry constant kH in MPa for a given temperature.\nThe molar fraction in water is related to kH: x_2=1/kH. Arguments Type Intent Optional Attributes Name real(kind=dp), intent(in), contiguous :: T (:) Temperature in K. character(len=*), intent(in) :: gas Gas. integer(kind=int32), intent(in) :: heavywater Flag if D2O (1) is used or H2O(0). real(kind=dp), intent(out), contiguous :: k (:) Henry constant in MPa. Filled with NaNs if gas not found. Called by proc~~kh~~CalledByGraph proc~kh kh proc~capi_kh capi_kh proc~capi_kh->proc~kh Help Graph Key Nodes of different colours represent the following: Graph Key Subroutine Subroutine Function Function Interface Interface Type Bound Procedure Type Bound Procedure Unknown Procedure Type Unknown Procedure Type Program Program This Page's Entity This Page's Entity Solid arrows point from a procedure to one which it calls. Dashed \narrows point from an interface to procedures which implement that interface.\nThis could include the module procedures in a generic interface or the\nimplementation in a submodule of an interface in a parent module.","tags":"","url":"proc/kh.html"},{"title":"find_phase – iapws","text":"public pure elemental function find_phase(p, T) result(res) Find the corresponding phase according to p and T.\nReturn the phase as an character: l=LIQUID, v=VAPOR, c=SUPER CRITICAL, s=SATURATION, n=UNKNOWN. Arguments Type Intent Optional Attributes Name real(kind=dp), intent(in) :: p Pressure in MPa. real(kind=dp), intent(in) :: T Temperature in K. Return Value character(len=1) Calls proc~~find_phase~~CallsGraph proc~find_phase find_phase proc~find_region find_region proc~find_phase->proc~find_region proc~r4_ps r4_ps proc~find_region->proc~r4_ps Help Graph Key Nodes of different colours represent the following: Graph Key Subroutine Subroutine Function Function Interface Interface Type Bound Procedure Type Bound Procedure Unknown Procedure Type Unknown Procedure Type Program Program This Page's Entity This Page's Entity Solid arrows point from a procedure to one which it calls. Dashed \narrows point from an interface to procedures which implement that interface.\nThis could include the module procedures in a generic interface or the\nimplementation in a submodule of an interface in a parent module. Called by proc~~find_phase~~CalledByGraph proc~find_phase find_phase proc~wph wph proc~wph->proc~find_phase proc~capi_wph capi_wph proc~capi_wph->proc~wph Help Graph Key Nodes of different colours represent the following: Graph Key Subroutine Subroutine Function Function Interface Interface Type Bound Procedure Type Bound Procedure Unknown Procedure Type Unknown Procedure Type Program Program This Page's Entity This Page's Entity Solid arrows point from a procedure to one which it calls. Dashed \narrows point from an interface to procedures which implement that interface.\nThis could include the module procedures in a generic interface or the\nimplementation in a submodule of an interface in a parent module.","tags":"","url":"proc/find_phase.html"},{"title":"find_region – iapws","text":"public pure elemental function find_region(p, T) result(res) Find the corresponding region according to p and T.\nReturn the number of the region (1 to 5) when found otherwise return -1. Arguments Type Intent Optional Attributes Name real(kind=dp), intent(in) :: p Pressure in MPa. real(kind=dp), intent(in) :: T Temperature in K. Return Value integer(kind=int32) Calls proc~~find_region~~CallsGraph proc~find_region find_region proc~r4_ps r4_ps proc~find_region->proc~r4_ps Help Graph Key Nodes of different colours represent the following: Graph Key Subroutine Subroutine Function Function Interface Interface Type Bound Procedure Type Bound Procedure Unknown Procedure Type Unknown Procedure Type Program Program This Page's Entity This Page's Entity Solid arrows point from a procedure to one which it calls. Dashed \narrows point from an interface to procedures which implement that interface.\nThis could include the module procedures in a generic interface or the\nimplementation in a submodule of an interface in a parent module. Called by proc~~find_region~~CalledByGraph proc~find_region find_region proc~find_phase find_phase proc~find_phase->proc~find_region proc~wp wp proc~wp->proc~find_region proc~wr wr proc~wr->proc~find_region proc~capi_wp capi_wp proc~capi_wp->proc~wp proc~capi_wr capi_wr proc~capi_wr->proc~wr proc~wph wph proc~wph->proc~find_phase proc~capi_wph capi_wph proc~capi_wph->proc~wph Help Graph Key Nodes of different colours represent the following: Graph Key Subroutine Subroutine Function Function Interface Interface Type Bound Procedure Type Bound Procedure Unknown Procedure Type Unknown Procedure Type Program Program This Page's Entity This Page's Entity Solid arrows point from a procedure to one which it calls. Dashed \narrows point from an interface to procedures which implement that interface.\nThis could include the module procedures in a generic interface or the\nimplementation in a submodule of an interface in a parent module.","tags":"","url":"proc/find_region.html"},{"title":"get_r – iapws","text":"public pure elemental function get_r(region) result(fptr) Get the pointer to the adequate region subroutine Arguments Type Intent Optional Attributes Name integer(kind=int32), intent(in) :: region Return Value procedure( rai ), pointer Called by proc~~get_r~~CalledByGraph proc~get_r get_r proc~wp wp proc~wp->proc~get_r proc~capi_wp capi_wp proc~capi_wp->proc~wp Help Graph Key Nodes of different colours represent the following: Graph Key Subroutine Subroutine Function Function Interface Interface Type Bound Procedure Type Bound Procedure Unknown Procedure Type Unknown Procedure Type Program Program This Page's Entity This Page's Entity Solid arrows point from a procedure to one which it calls. Dashed \narrows point from an interface to procedures which implement that interface.\nThis could include the module procedures in a generic interface or the\nimplementation in a submodule of an interface in a parent module.","tags":"","url":"proc/get_r.html"},{"title":"is1region – iapws","text":"public pure function is1region(regions) result(res) Check if all regions are identical Arguments Type Intent Optional Attributes Name integer(kind=int32), intent(in) :: regions (:) Return Value logical Called by proc~~is1region~~CalledByGraph proc~is1region is1region proc~wp wp proc~wp->proc~is1region proc~capi_wp capi_wp proc~capi_wp->proc~wp Help Graph Key Nodes of different colours represent the following: Graph Key Subroutine Subroutine Function Function Interface Interface Type Bound Procedure Type Bound Procedure Unknown Procedure Type Unknown Procedure Type Program Program This Page's Entity This Page's Entity Solid arrows point from a procedure to one which it calls. Dashed \narrows point from an interface to procedures which implement that interface.\nThis could include the module procedures in a generic interface or the\nimplementation in a submodule of an interface in a parent module.","tags":"","url":"proc/is1region.html"},{"title":"r1_cp – iapws","text":"public pure elemental function r1_cp(p, T) result(res) Compute the specific isobaric heat capacity cp in kJ/kg/K. Arguments Type Intent Optional Attributes Name real(kind=dp), intent(in) :: p Pressure in MPa. real(kind=dp), intent(in) :: T Temperature in K. Return Value real(kind=dp) Called by proc~~r1_cp~~CalledByGraph proc~r1_cp r1_cp proc~r1 r1 proc~r1->proc~r1_cp Help Graph Key Nodes of different colours represent the following: Graph Key Subroutine Subroutine Function Function Interface Interface Type Bound Procedure Type Bound Procedure Unknown Procedure Type Unknown Procedure Type Program Program This Page's Entity This Page's Entity Solid arrows point from a procedure to one which it calls. Dashed \narrows point from an interface to procedures which implement that interface.\nThis could include the module procedures in a generic interface or the\nimplementation in a submodule of an interface in a parent module.","tags":"","url":"proc/r1_cp.html"},{"title":"r1_cv – iapws","text":"public pure elemental function r1_cv(p, T) result(res) Compute the specific isochoric heat capacity cp in kJ/kg/K. Arguments Type Intent Optional Attributes Name real(kind=dp), intent(in) :: p Pressure in MPa. real(kind=dp), intent(in) :: T Temperature in K. Return Value real(kind=dp) Called by proc~~r1_cv~~CalledByGraph proc~r1_cv r1_cv proc~r1 r1 proc~r1->proc~r1_cv Help Graph Key Nodes of different colours represent the following: Graph Key Subroutine Subroutine Function Function Interface Interface Type Bound Procedure Type Bound Procedure Unknown Procedure Type Unknown Procedure Type Program Program This Page's Entity This Page's Entity Solid arrows point from a procedure to one which it calls. Dashed \narrows point from an interface to procedures which implement that interface.\nThis could include the module procedures in a generic interface or the\nimplementation in a submodule of an interface in a parent module.","tags":"","url":"proc/r1_cv.html"},{"title":"r1_h – iapws","text":"public pure elemental function r1_h(p, T) result(res) Compute the specific enthalpie h in kJ/kg. Arguments Type Intent Optional Attributes Name real(kind=dp), intent(in) :: p Pressure in MPa. real(kind=dp), intent(in) :: T Temperature in K. Return Value real(kind=dp) Called by proc~~r1_h~~CalledByGraph proc~r1_h r1_h proc~r1 r1 proc~r1->proc~r1_h Help Graph Key Nodes of different colours represent the following: Graph Key Subroutine Subroutine Function Function Interface Interface Type Bound Procedure Type Bound Procedure Unknown Procedure Type Unknown Procedure Type Program Program This Page's Entity This Page's Entity Solid arrows point from a procedure to one which it calls. Dashed \narrows point from an interface to procedures which implement that interface.\nThis could include the module procedures in a generic interface or the\nimplementation in a submodule of an interface in a parent module.","tags":"","url":"proc/r1_h.html"},{"title":"r1_s – iapws","text":"public pure elemental function r1_s(p, T) result(res) Compute the specific enthropy h in kJ/kg/K. Arguments Type Intent Optional Attributes Name real(kind=dp), intent(in) :: p Pressure in MPa. real(kind=dp), intent(in) :: T Temperature in K. Return Value real(kind=dp) Called by proc~~r1_s~~CalledByGraph proc~r1_s r1_s proc~r1 r1 proc~r1->proc~r1_s Help Graph Key Nodes of different colours represent the following: Graph Key Subroutine Subroutine Function Function Interface Interface Type Bound Procedure Type Bound Procedure Unknown Procedure Type Unknown Procedure Type Program Program This Page's Entity This Page's Entity Solid arrows point from a procedure to one which it calls. Dashed \narrows point from an interface to procedures which implement that interface.\nThis could include the module procedures in a generic interface or the\nimplementation in a submodule of an interface in a parent module.","tags":"","url":"proc/r1_s.html"},{"title":"r1_u – iapws","text":"public pure elemental function r1_u(p, T) result(res) Compute the specific internal energy u in m3/kg. Arguments Type Intent Optional Attributes Name real(kind=dp), intent(in) :: p Pressure in MPa. real(kind=dp), intent(in) :: T Temperature in K. Return Value real(kind=dp) Called by proc~~r1_u~~CalledByGraph proc~r1_u r1_u proc~r1 r1 proc~r1->proc~r1_u Help Graph Key Nodes of different colours represent the following: Graph Key Subroutine Subroutine Function Function Interface Interface Type Bound Procedure Type Bound Procedure Unknown Procedure Type Unknown Procedure Type Program Program This Page's Entity This Page's Entity Solid arrows point from a procedure to one which it calls. Dashed \narrows point from an interface to procedures which implement that interface.\nThis could include the module procedures in a generic interface or the\nimplementation in a submodule of an interface in a parent module.","tags":"","url":"proc/r1_u.html"},{"title":"r1_v – iapws","text":"public pure elemental function r1_v(p, T) result(res) Compute the specific volume v in m3/kg. Arguments Type Intent Optional Attributes Name real(kind=dp), intent(in) :: p Pressure in MPa. real(kind=dp), intent(in) :: T Temperature in K. Return Value real(kind=dp) Called by proc~~r1_v~~CalledByGraph proc~r1_v r1_v proc~r1 r1 proc~r1->proc~r1_v Help Graph Key Nodes of different colours represent the following: Graph Key Subroutine Subroutine Function Function Interface Interface Type Bound Procedure Type Bound Procedure Unknown Procedure Type Unknown Procedure Type Program Program This Page's Entity This Page's Entity Solid arrows point from a procedure to one which it calls. Dashed \narrows point from an interface to procedures which implement that interface.\nThis could include the module procedures in a generic interface or the\nimplementation in a submodule of an interface in a parent module.","tags":"","url":"proc/r1_v.html"},{"title":"r1_w – iapws","text":"public pure elemental function r1_w(p, T) result(res) Compute the speed of sound w in m/s. Arguments Type Intent Optional Attributes Name real(kind=dp), intent(in) :: p Pressure in MPa. real(kind=dp), intent(in) :: T Temperature in K. Return Value real(kind=dp) Called by proc~~r1_w~~CalledByGraph proc~r1_w r1_w proc~r1 r1 proc~r1->proc~r1_w Help Graph Key Nodes of different colours represent the following: Graph Key Subroutine Subroutine Function Function Interface Interface Type Bound Procedure Type Bound Procedure Unknown Procedure Type Unknown Procedure Type Program Program This Page's Entity This Page's Entity Solid arrows point from a procedure to one which it calls. Dashed \narrows point from an interface to procedures which implement that interface.\nThis could include the module procedures in a generic interface or the\nimplementation in a submodule of an interface in a parent module.","tags":"","url":"proc/r1_w.html"},{"title":"r4_Ts – iapws","text":"public pure elemental function r4_Ts(ps) result(value) Compute the saturation-pressure line. \nValidity range 611.213 Pa <= ps <= 22.064 MPa. Arguments Type Intent Optional Attributes Name real(kind=dp), intent(in) :: ps Saturation Pressure in MPa. Return Value real(kind=dp) Saturation temperature in K at pressure ps. Is nan if ps is out of range. Called by proc~~r4_ts~~CalledByGraph proc~r4_ts r4_Ts proc~tsat Tsat proc~tsat->proc~r4_ts proc~capi_tsat capi_Tsat proc~capi_tsat->proc~tsat Help Graph Key Nodes of different colours represent the following: Graph Key Subroutine Subroutine Function Function Interface Interface Type Bound Procedure Type Bound Procedure Unknown Procedure Type Unknown Procedure Type Program Program This Page's Entity This Page's Entity Solid arrows point from a procedure to one which it calls. Dashed \narrows point from an interface to procedures which implement that interface.\nThis could include the module procedures in a generic interface or the\nimplementation in a submodule of an interface in a parent module.","tags":"","url":"proc/r4_ts.html"},{"title":"r4_ps – iapws","text":"public pure elemental function r4_ps(Ts) result(value) Compute the saturation-pressure line. \nValidity range 273.13 K <= Ts <= 647.096 K. Arguments Type Intent Optional Attributes Name real(kind=dp), intent(in) :: Ts Saturation temperature in K. Return Value real(kind=dp) Saturation Pressure in MPa at temperature Ts. Is nan if Ts is out of range. Called by proc~~r4_ps~~CalledByGraph proc~r4_ps r4_ps proc~find_region find_region proc~find_region->proc~r4_ps proc~psat psat proc~psat->proc~r4_ps proc~capi_psat capi_psat proc~capi_psat->proc~psat proc~find_phase find_phase proc~find_phase->proc~find_region proc~wp wp proc~wp->proc~find_region proc~wr wr proc~wr->proc~find_region proc~capi_wp capi_wp proc~capi_wp->proc~wp proc~capi_wr capi_wr proc~capi_wr->proc~wr proc~wph wph proc~wph->proc~find_phase proc~capi_wph capi_wph proc~capi_wph->proc~wph Help Graph Key Nodes of different colours represent the following: Graph Key Subroutine Subroutine Function Function Interface Interface Type Bound Procedure Type Bound Procedure Unknown Procedure Type Unknown Procedure Type Program Program This Page's Entity This Page's Entity Solid arrows point from a procedure to one which it calls. Dashed \narrows point from an interface to procedures which implement that interface.\nThis could include the module procedures in a generic interface or the\nimplementation in a submodule of an interface in a parent module.","tags":"","url":"proc/r4_ps.html"},{"title":"r1 – iapws","text":"public pure subroutine r1(p, T, prop, res) Compute water properties at pressure p in MPa and temperature T in Kelvin.\nin region 1. Available properties:\n    * v: specific volume in m3/kg\n    * u: specific internal energy in kJ/kg\n    * s: specific entropy in kJ/kg \n    * h: specific enthalpy in kJ/kg/K\n    * cp: specific isobaric heat capacity in kJ/kg/K\n    * cv: specific isochoric heat capacity in kJ/kg/K\n    * w: speed of sound in m/s Arguments Type Intent Optional Attributes Name real(kind=dp), intent(in) :: p (:) Pressure in MPa. real(kind=dp), intent(in) :: T (:) Pressure in K. character(len=*), intent(in) :: prop Property real(kind=dp), intent(out) :: res (:) Result Calls proc~~r1~~CallsGraph proc~r1 r1 proc~r1_cp r1_cp proc~r1->proc~r1_cp proc~r1_cv r1_cv proc~r1->proc~r1_cv proc~r1_h r1_h proc~r1->proc~r1_h proc~r1_s r1_s proc~r1->proc~r1_s proc~r1_u r1_u proc~r1->proc~r1_u proc~r1_v r1_v proc~r1->proc~r1_v proc~r1_w r1_w proc~r1->proc~r1_w Help Graph Key Nodes of different colours represent the following: Graph Key Subroutine Subroutine Function Function Interface Interface Type Bound Procedure Type Bound Procedure Unknown Procedure Type Unknown Procedure Type Program Program This Page's Entity This Page's Entity Solid arrows point from a procedure to one which it calls. Dashed \narrows point from an interface to procedures which implement that interface.\nThis could include the module procedures in a generic interface or the\nimplementation in a submodule of an interface in a parent module.","tags":"","url":"proc/r1.html"},{"title":"iapws__api – iapws","text":"API. Uses iapws__r1124 iapws__g704 iapws__r283 iapws__version iapws__r797 iapws__common module~~iapws__api~~UsesGraph module~iapws__api iapws__api module~iapws__common iapws__common module~iapws__api->module~iapws__common module~iapws__g704 iapws__g704 module~iapws__api->module~iapws__g704 module~iapws__r1124 iapws__r1124 module~iapws__api->module~iapws__r1124 module~iapws__r283 iapws__r283 module~iapws__api->module~iapws__r283 module~iapws__r797 iapws__r797 module~iapws__api->module~iapws__r797 module~iapws__version iapws__version module~iapws__api->module~iapws__version ieee_arithmetic ieee_arithmetic module~iapws__common->ieee_arithmetic stdlib_kinds stdlib_kinds module~iapws__common->stdlib_kinds stdlib_optval stdlib_optval module~iapws__common->stdlib_optval module~iapws__g704->module~iapws__common module~iapws__g704->module~iapws__r283 module~iapws__r1124->module~iapws__common module~iapws__r283->module~iapws__common module~iapws__r797->module~iapws__common module~iapws__r797->module~iapws__r283 Help Graph Key Nodes of different colours represent the following: Graph Key Module Module Submodule Submodule Subroutine Subroutine Function Function Program Program This Page's Entity This Page's Entity Solid arrows point from a submodule to the (sub)module which it is\ndescended from. Dashed arrows point from a module or program unit to \nmodules which it uses. Used by module~~iapws__api~~UsedByGraph module~iapws__api iapws__api module~iapws iapws module~iapws->module~iapws__api module~iapws__capi iapws__capi module~iapws->module~iapws__capi module~iapws__capi->module~iapws__api Help Graph Key Nodes of different colours represent the following: Graph Key Module Module Submodule Submodule Subroutine Subroutine Function Function Program Program This Page's Entity This Page's Entity Solid arrows point from a submodule to the (sub)module which it is\ndescended from. Dashed arrows point from a module or program unit to \nmodules which it uses. Functions public  function get_version () result(fptr) Return the version Arguments None Return Value character(len=:), pointer Fortran pointer to a string indicating the version.. Subroutines public pure subroutine Kw (T, rhow, k) Compute the ionization constant of water Kw.\nValidity range 273.13 K <= T <= 1273.15 K and 0 <= p <= 1000 MPa. Arguments Type Intent Optional Attributes Name real(kind=dp), intent(in) :: T (:) Temperature in K. real(kind=dp), intent(in) :: rhow (:) Mass density in g.cm&#94;{-3}. real(kind=dp), intent(out) :: k (:) Ionization constant. Filled with NaN if out of validity range. public pure subroutine Tsat (ps, Ts) Compute the saturation temperature at pressure ps.\nValidity range 611.213 Pa <= ps <= 22.064 MPa. Arguments Type Intent Optional Attributes Name real(kind=dp), intent(in), contiguous :: ps (:) Saturation pressure in MPa. real(kind=dp), intent(out), contiguous :: Ts (:) Saturation temperature in K. Filled with nan if out of validity range. public pure subroutine psat (Ts, ps) Compute the saturation pressure at temperature Ts. \nValidity range 273.13 K <= Ts <= 647.096 K. Arguments Type Intent Optional Attributes Name real(kind=dp), intent(in), contiguous :: Ts (:) Saturation temperature in K. real(kind=dp), intent(out), contiguous :: ps (:) Saturation pressure in MPa. Filled with nan if out of validity range. public pure subroutine wp (p, T, prop, res) Compute water properties at pressure p in MPa and temperature T in Kelvin.\nThe adequate region is selected according to p and T. Read more… Arguments Type Intent Optional Attributes Name real(kind=dp), intent(in) :: p (:) Pressure in MPa. real(kind=dp), intent(in) :: T (:) Pressure in K. character(len=*), intent(in) :: prop Property real(kind=dp), intent(out) :: res (:) Filled with NaN if no adequate region is found. public pure subroutine wph (p, T, res) Get the water phase corresponding to p and T.\nPhases: l(liquid), v(VAPOR), c(SUPER CRITICAL), s(SATURATION), n(UNKNOWN). Arguments Type Intent Optional Attributes Name real(kind=dp), intent(in) :: p (:) pressure in MPa. real(kind=dp), intent(in) :: T (:) Temperature in K. character(len=1), intent(out) :: res (:) Phase (l, v, c, s, n) public pure subroutine wr (p, T, res) Get the water region corresponding to p and T.\nRegions 1 to 5 or -1 when not found. Arguments Type Intent Optional Attributes Name real(kind=dp), intent(in) :: p (:) Pressure in MPa. real(kind=dp), intent(in) :: T (:) Temperature in K. integer(kind=int32), intent(out) :: res (:) Region (1-5)","tags":"","url":"module/iapws__api.html"},{"title":"iapws__r1124 – iapws","text":"Module for IAPWS R11-24. Uses iapws__common module~~iapws__r1124~~UsesGraph module~iapws__r1124 iapws__r1124 module~iapws__common iapws__common module~iapws__r1124->module~iapws__common ieee_arithmetic ieee_arithmetic module~iapws__common->ieee_arithmetic stdlib_kinds stdlib_kinds module~iapws__common->stdlib_kinds stdlib_optval stdlib_optval module~iapws__common->stdlib_optval Help Graph Key Nodes of different colours represent the following: Graph Key Module Module Submodule Submodule Subroutine Subroutine Function Function Program Program This Page's Entity This Page's Entity Solid arrows point from a submodule to the (sub)module which it is\ndescended from. Dashed arrows point from a module or program unit to \nmodules which it uses. Used by module~~iapws__r1124~~UsedByGraph module~iapws__r1124 iapws__r1124 module~iapws__api iapws__api module~iapws__api->module~iapws__r1124 module~iapws iapws module~iapws->module~iapws__api module~iapws__capi iapws__capi module~iapws->module~iapws__capi module~iapws__capi->module~iapws__api Help Graph Key Nodes of different colours represent the following: Graph Key Module Module Submodule Submodule Subroutine Subroutine Function Function Program Program This Page's Entity This Page's Entity Solid arrows point from a submodule to the (sub)module which it is\ndescended from. Dashed arrows point from a module or program unit to \nmodules which it uses. Functions public pure elemental function pKw (T, rhow) result(res) Ionization constant of water.\nValidity range 273.13 K <= T <= 1273.15 K and 0 <= p <= 1000 MPa. Arguments Type Intent Optional Attributes Name real(kind=dp), intent(in) :: T Temperature in K. real(kind=dp), intent(in) :: rhow Mass density in g.cm&#94;{-3}. Return Value real(kind=dp)","tags":"","url":"module/iapws__r1124.html"},{"title":"iapws__r283 – iapws","text":"Module for IAPWS R2-83. Uses iapws__common module~~iapws__r283~~UsesGraph module~iapws__r283 iapws__r283 module~iapws__common iapws__common module~iapws__r283->module~iapws__common ieee_arithmetic ieee_arithmetic module~iapws__common->ieee_arithmetic stdlib_kinds stdlib_kinds module~iapws__common->stdlib_kinds stdlib_optval stdlib_optval module~iapws__common->stdlib_optval Help Graph Key Nodes of different colours represent the following: Graph Key Module Module Submodule Submodule Subroutine Subroutine Function Function Program Program This Page's Entity This Page's Entity Solid arrows point from a submodule to the (sub)module which it is\ndescended from. Dashed arrows point from a module or program unit to \nmodules which it uses. Used by module~~iapws__r283~~UsedByGraph module~iapws__r283 iapws__r283 module~iapws__api iapws__api module~iapws__api->module~iapws__r283 module~iapws__g704 iapws__g704 module~iapws__api->module~iapws__g704 module~iapws__r797 iapws__r797 module~iapws__api->module~iapws__r797 module~iapws__g704->module~iapws__r283 module~iapws__r797->module~iapws__r283 module~iapws iapws module~iapws->module~iapws__api module~iapws__capi iapws__capi module~iapws->module~iapws__capi module~iapws__capi->module~iapws__api Help Graph Key Nodes of different colours represent the following: Graph Key Module Module Submodule Submodule Subroutine Subroutine Function Function Program Program This Page's Entity This Page's Entity Solid arrows point from a submodule to the (sub)module which it is\ndescended from. Dashed arrows point from a module or program unit to \nmodules which it uses. Variables Type Visibility Attributes Name Initial real(kind=dp), public, parameter :: Tc_D2O = 643.847_dp Critical temperature for D2O in K real(kind=dp), public, parameter :: Tc_H2O = 647.096_dp Critical temperature for H2O in K real(kind=dp), public, parameter :: pc_D2O = 21.671_dp Critical pressure for H2O in MPa real(kind=dp), public, parameter :: pc_H2O = 22.064_dp Critical pressure for H2O in MPa real(kind=dp), public, parameter :: rhoc_D2O = 356.0_dp Critical density for H2O in kg.m-3 real(kind=dp), public, parameter :: rhoc_H2O = 322.0_dp Critical density for H2O in kg.m-3","tags":"","url":"module/iapws__r283.html"},{"title":"iapws__capi – iapws","text":"C API.\n VERSION R283 G704 R797 Uses iso_c_binding iapws__common iapws__api module~~iapws__capi~~UsesGraph module~iapws__capi iapws__capi iso_c_binding iso_c_binding module~iapws__capi->iso_c_binding module~iapws__api iapws__api module~iapws__capi->module~iapws__api module~iapws__common iapws__common module~iapws__capi->module~iapws__common module~iapws__api->module~iapws__common module~iapws__g704 iapws__g704 module~iapws__api->module~iapws__g704 module~iapws__r1124 iapws__r1124 module~iapws__api->module~iapws__r1124 module~iapws__r283 iapws__r283 module~iapws__api->module~iapws__r283 module~iapws__r797 iapws__r797 module~iapws__api->module~iapws__r797 module~iapws__version iapws__version module~iapws__api->module~iapws__version ieee_arithmetic ieee_arithmetic module~iapws__common->ieee_arithmetic stdlib_kinds stdlib_kinds module~iapws__common->stdlib_kinds stdlib_optval stdlib_optval module~iapws__common->stdlib_optval module~iapws__g704->module~iapws__common module~iapws__g704->module~iapws__r283 module~iapws__r1124->module~iapws__common module~iapws__r283->module~iapws__common module~iapws__r797->module~iapws__common module~iapws__r797->module~iapws__r283 Help Graph Key Nodes of different colours represent the following: Graph Key Module Module Submodule Submodule Subroutine Subroutine Function Function Program Program This Page's Entity This Page's Entity Solid arrows point from a submodule to the (sub)module which it is\ndescended from. Dashed arrows point from a module or program unit to \nmodules which it uses. Used by module~~iapws__capi~~UsedByGraph module~iapws__capi iapws__capi module~iapws iapws module~iapws->module~iapws__capi Help Graph Key Nodes of different colours represent the following: Graph Key Module Module Submodule Submodule Subroutine Subroutine Function Function Program Program This Page's Entity This Page's Entity Solid arrows point from a submodule to the (sub)module which it is\ndescended from. Dashed arrows point from a module or program unit to \nmodules which it uses. Variables Type Visibility Attributes Name Initial type( cgas_type ), public, allocatable, target :: c_gases (:) character(len=:), public, allocatable, target :: c_gases_str real(kind=c_double), public, bind(C, name=\"0\") :: capi_Tc_D2O = Tc_D2O Critical temperature for D2O in K real(kind=c_double), public, bind(C, name=\"0\") :: capi_Tc_H2O = Tc_H2O Critical temperature for H2O in K real(kind=c_double), public, bind(C, name=\"0\") :: capi_pc_D2O = pc_D2O Critical pressure for D2O in MPa real(kind=c_double), public, bind(C, name=\"0\") :: capi_pc_H2O = pc_H2O Critical pressure for H2O in MPa real(kind=c_double), public, bind(C, name=\"0\") :: capi_rhoc_D2O = rhoc_D2O Critical density for D2O in kg.m-3 real(kind=c_double), public, bind(C, name=\"0\") :: capi_rhoc_H2O = rhoc_H2O Critical density for H2O in kg.m-3 type( c_char_p ), public, allocatable, target :: char_pp (:) character(len=:), public, allocatable, target :: version_c Derived Types type, public, bind(C) :: c_char_p Components Type Visibility Attributes Name Initial type(c_ptr), public :: p type, public :: cgas_type Components Type Visibility Attributes Name Initial character(kind=c_char, len=1), public, allocatable :: gas (:) Functions public  function capi_gases (heavywater) result(list_gases) bind(C, name=\"iapws_g704_gases\")) C API. Arguments Type Intent Optional Attributes Name integer(kind=c_int), intent(in), value :: heavywater Flag if D2O (1) is used or H2O(0). Return Value type(c_ptr) Available gases. public  function capi_gases2 (heavywater) result(str_gases) bind(C, name=\"iapws_g704_gases2\")) C API. Arguments Type Intent Optional Attributes Name integer(kind=c_int), intent(in), value :: heavywater Flag if D2O (1) is used or H2O(0). Return Value type(c_ptr) Available gases. public  function capi_get_version () result(cptr) bind(c,name=\"iapws_get_version\")) C API Arguments None Return Value type(c_ptr) Pointer to version string. public  function capi_ngases (heavywater) result(n) bind(C, name=\"iapws_g704_ngases\")) C API. Arguments Type Intent Optional Attributes Name integer(kind=c_int), intent(in), value :: heavywater Flag if D2O (1) is used or H2O(0). Return Value integer(kind=c_int) Number of gases. Subroutines public  subroutine capi_Kw (N, T, rhow, k) bind(C, name=\"iapws_r1124_Kw\") C API. Arguments Type Intent Optional Attributes Name integer(kind=c_size_t), intent(in), value :: N Size of T, rhow and k. real(kind=c_double), intent(in) :: T (N) Temperature in K. real(kind=c_double), intent(in) :: rhow (N) Mass density in g.cm&#94;{-3}. real(kind=c_double), intent(out) :: k (N) Ionization constant. Filled with NaN if out of validity range. public  subroutine capi_Tsat (N, ps, Ts) bind(C, name=\"iapws_r797_Tsat\") C API. Arguments Type Intent Optional Attributes Name integer(kind=c_size_t), intent(in), value :: N Size of ps and Ts. real(kind=c_double), intent(in) :: ps (N) Saturation pressure in MPa. real(kind=c_double), intent(out) :: Ts (N) Saturation temperature in K. Filled with nan if out of validity range. public  subroutine capi_kd (T, gas, heavywater, k, size_gas, size_T) bind(C,name=\"iapws_g704_kd\") C API. Arguments Type Intent Optional Attributes Name real(kind=c_double), intent(in) :: T (size_T) Temperature in °C. type(c_ptr), intent(in), value :: gas Gas. integer(kind=c_int), intent(in), value :: heavywater Flag if D2O (1) is used or H2O(0). real(kind=c_double), intent(inout) :: k (size_T) Vapor-liquid constant. Filled with NaNs if gas not found. integer(kind=c_int), intent(in), value :: size_gas Size of the gas string. integer(kind=c_size_t), intent(in), value :: size_T Size of T and k. public  subroutine capi_kh (T, gas, heavywater, k, size_gas, size_T) bind(C,name=\"iapws_g704_kh\") C API. Arguments Type Intent Optional Attributes Name real(kind=c_double), intent(in) :: T (size_T) Temperature in °C. type(c_ptr), intent(in), value :: gas Gas. integer(kind=c_int), intent(in), value :: heavywater Flag if D2O (1) is used or H2O(0). real(kind=c_double), intent(inout) :: k (size_T) Henry constant. Filled with NaNs if gas not found. integer(kind=c_int), intent(in), value :: size_gas Size of the gas string. integer(kind=c_size_t), intent(in), value :: size_T Size of T and k. public  subroutine capi_psat (N, Ts, ps) bind(C, name=\"iapws_r797_psat\") C API. Arguments Type Intent Optional Attributes Name integer(kind=c_size_t), intent(in), value :: N Size of Ts and ps. real(kind=c_double), intent(in) :: Ts (N) Saturation temperature in K. real(kind=c_double), intent(out) :: ps (N) Saturation pressure in MPa. Filled with nan if out of validity range. public  subroutine capi_wp (p, T, prop, res, N, len) bind(C, name=\"iapws_r797_wp\") C API. Read more… Arguments Type Intent Optional Attributes Name real(kind=c_double), intent(in) :: p (N) Pressure in MPa. real(kind=c_double), intent(in) :: T (N) Temperature in K. type(c_ptr), intent(in), value :: prop Water property. real(kind=c_double), intent(out) :: res (N) Result. Filled with NaNs if gas not found. integer(kind=c_size_t), intent(in), value :: N Size of T and p. integer(kind=c_int), intent(in), value :: len Size of the prop string. public  subroutine capi_wph (p, T, res, N) bind(C, name=\"iapws_r797_wph\") C API. Arguments Type Intent Optional Attributes Name real(kind=c_double), intent(in) :: p (N) Pressure in MPa. real(kind=c_double), intent(in) :: T (N) Temperature in K. character(kind=c_char, len=1), intent(out) :: res (N) Regions. integer(kind=c_size_t), intent(in), value :: N Size of T and p. public  subroutine capi_wr (p, T, res, N) bind(C, name=\"iapws_r797_wr\") C API. Arguments Type Intent Optional Attributes Name real(kind=c_double), intent(in) :: p (N) Pressure in MPa. real(kind=c_double), intent(in) :: T (N) Temperature in K. integer(kind=c_int), intent(out) :: res (N) Regions. integer(kind=c_size_t), intent(in), value :: N Size of T and p.","tags":"","url":"module/iapws__capi.html"},{"title":"iapws – iapws","text":"Main module for the IAPWS library. Uses iapws__capi iapws__api module~~iapws~~UsesGraph module~iapws iapws module~iapws__api iapws__api module~iapws->module~iapws__api module~iapws__capi iapws__capi module~iapws->module~iapws__capi module~iapws__common iapws__common module~iapws__api->module~iapws__common module~iapws__g704 iapws__g704 module~iapws__api->module~iapws__g704 module~iapws__r1124 iapws__r1124 module~iapws__api->module~iapws__r1124 module~iapws__r283 iapws__r283 module~iapws__api->module~iapws__r283 module~iapws__r797 iapws__r797 module~iapws__api->module~iapws__r797 module~iapws__version iapws__version module~iapws__api->module~iapws__version module~iapws__capi->module~iapws__api iso_c_binding iso_c_binding module~iapws__capi->iso_c_binding module~iapws__capi->module~iapws__common ieee_arithmetic ieee_arithmetic module~iapws__common->ieee_arithmetic stdlib_kinds stdlib_kinds module~iapws__common->stdlib_kinds stdlib_optval stdlib_optval module~iapws__common->stdlib_optval module~iapws__g704->module~iapws__common module~iapws__g704->module~iapws__r283 module~iapws__r1124->module~iapws__common module~iapws__r283->module~iapws__common module~iapws__r797->module~iapws__common module~iapws__r797->module~iapws__r283 Help Graph Key Nodes of different colours represent the following: Graph Key Module Module Submodule Submodule Subroutine Subroutine Function Function Program Program This Page's Entity This Page's Entity Solid arrows point from a submodule to the (sub)module which it is\ndescended from. Dashed arrows point from a module or program unit to \nmodules which it uses.","tags":"","url":"module/iapws.html"},{"title":"iapws__g704 – iapws","text":"Module for IAPWS G7-04.\nEFGH coefficients for gases in heavywater.\nai and bi coefficients for water Uses iapws__common iapws__r283 module~~iapws__g704~~UsesGraph module~iapws__g704 iapws__g704 module~iapws__common iapws__common module~iapws__g704->module~iapws__common module~iapws__r283 iapws__r283 module~iapws__g704->module~iapws__r283 ieee_arithmetic ieee_arithmetic module~iapws__common->ieee_arithmetic stdlib_kinds stdlib_kinds module~iapws__common->stdlib_kinds stdlib_optval stdlib_optval module~iapws__common->stdlib_optval module~iapws__r283->module~iapws__common Help Graph Key Nodes of different colours represent the following: Graph Key Module Module Submodule Submodule Subroutine Subroutine Function Function Program Program This Page's Entity This Page's Entity Solid arrows point from a submodule to the (sub)module which it is\ndescended from. Dashed arrows point from a module or program unit to \nmodules which it uses. Used by module~~iapws__g704~~UsedByGraph module~iapws__g704 iapws__g704 module~iapws__api iapws__api module~iapws__api->module~iapws__g704 module~iapws iapws module~iapws->module~iapws__api module~iapws__capi iapws__capi module~iapws->module~iapws__capi module~iapws__capi->module~iapws__api Help Graph Key Nodes of different colours represent the following: Graph Key Module Module Submodule Submodule Subroutine Subroutine Function Function Program Program This Page's Entity This Page's Entity Solid arrows point from a submodule to the (sub)module which it is\ndescended from. Dashed arrows point from a module or program unit to \nmodules which it uses. Derived Types type, public :: gas_type Derived type containing a allocatable string for representing a gas. Components Type Visibility Attributes Name Initial character(len=:), public, allocatable :: gas Gas Functions public  function gases (heavywater) result(list_gases) Returns the list of available gases. Arguments Type Intent Optional Attributes Name integer(kind=int32), intent(in) :: heavywater Flag if D2O (1) is used or H2O(0). Return Value type( gas_type ), pointer, (:) Available gases. public  function gases2 (heavywater) result(str_gases) Returns the available gases as a string. Arguments Type Intent Optional Attributes Name integer(kind=int32), intent(in) :: heavywater Flag if D2O (1) is used or H2O(0). Return Value character(len=:), pointer Available gases public pure function ngases (heavywater) result(n) Returns the number of gases. Arguments Type Intent Optional Attributes Name integer(kind=int32), intent(in) :: heavywater Flag if D2O (1) is used or H2O(0). Return Value integer(kind=int32) Number of gases. Subroutines public pure subroutine kd (T, gas, heavywater, k) Compute the vapor-liquid constant kd for a given temperature.\nThe molar fraction in vapor in related to kd: [ kd=y_2/x_2 [ Arguments Type Intent Optional Attributes Name real(kind=dp), intent(in), contiguous :: T (:) Temperature in K. character(len=*), intent(in) :: gas Gas. integer(kind=int32), intent(in) :: heavywater Flag if D2O (1) is used or H2O(0). real(kind=dp), intent(out), contiguous :: k (:) Vapor-liquid constant (adimensional). Filled with NaNs if gas not found. public pure subroutine kh (T, gas, heavywater, k) Compute the henry constant kH in MPa for a given temperature.\nThe molar fraction in water is related to kH: x_2=1/kH. Arguments Type Intent Optional Attributes Name real(kind=dp), intent(in), contiguous :: T (:) Temperature in K. character(len=*), intent(in) :: gas Gas. integer(kind=int32), intent(in) :: heavywater Flag if D2O (1) is used or H2O(0). real(kind=dp), intent(out), contiguous :: k (:) Henry constant in MPa. Filled with NaNs if gas not found.","tags":"","url":"module/iapws__g704.html"},{"title":"iapws__version – iapws","text":"Version Used by module~~iapws__version~~UsedByGraph module~iapws__version iapws__version module~iapws__api iapws__api module~iapws__api->module~iapws__version module~iapws iapws module~iapws->module~iapws__api module~iapws__capi iapws__capi module~iapws->module~iapws__capi module~iapws__capi->module~iapws__api Help Graph Key Nodes of different colours represent the following: Graph Key Module Module Submodule Submodule Subroutine Subroutine Function Function Program Program This Page's Entity This Page's Entity Solid arrows point from a submodule to the (sub)module which it is\ndescended from. Dashed arrows point from a module or program unit to \nmodules which it uses. Variables Type Visibility Attributes Name Initial character(len=*), public, parameter :: version = \"0.5.1\"","tags":"","url":"module/iapws__version.html"},{"title":"iapws__common – iapws","text":"Common parameters Uses ieee_arithmetic stdlib_kinds stdlib_optval module~~iapws__common~~UsesGraph module~iapws__common iapws__common ieee_arithmetic ieee_arithmetic module~iapws__common->ieee_arithmetic stdlib_kinds stdlib_kinds module~iapws__common->stdlib_kinds stdlib_optval stdlib_optval module~iapws__common->stdlib_optval Help Graph Key Nodes of different colours represent the following: Graph Key Module Module Submodule Submodule Subroutine Subroutine Function Function Program Program This Page's Entity This Page's Entity Solid arrows point from a submodule to the (sub)module which it is\ndescended from. Dashed arrows point from a module or program unit to \nmodules which it uses. Used by module~~iapws__common~~UsedByGraph module~iapws__common iapws__common module~iapws__api iapws__api module~iapws__api->module~iapws__common module~iapws__g704 iapws__g704 module~iapws__api->module~iapws__g704 module~iapws__r1124 iapws__r1124 module~iapws__api->module~iapws__r1124 module~iapws__r283 iapws__r283 module~iapws__api->module~iapws__r283 module~iapws__r797 iapws__r797 module~iapws__api->module~iapws__r797 module~iapws__capi iapws__capi module~iapws__capi->module~iapws__common module~iapws__capi->module~iapws__api module~iapws__g704->module~iapws__common module~iapws__g704->module~iapws__r283 module~iapws__r1124->module~iapws__common module~iapws__r283->module~iapws__common module~iapws__r797->module~iapws__common module~iapws__r797->module~iapws__r283 module~iapws iapws module~iapws->module~iapws__api module~iapws->module~iapws__capi Help Graph Key Nodes of different colours represent the following: Graph Key Module Module Submodule Submodule Subroutine Subroutine Function Function Program Program This Page's Entity This Page's Entity Solid arrows point from a submodule to the (sub)module which it is\ndescended from. Dashed arrows point from a module or program unit to \nmodules which it uses.","tags":"","url":"module/iapws__common.html"},{"title":"iapws__r797 – iapws","text":"Module for IAPWS R7-97: Not fully implemented - under development. Uses iapws__common iapws__r283 module~~iapws__r797~~UsesGraph module~iapws__r797 iapws__r797 module~iapws__common iapws__common module~iapws__r797->module~iapws__common module~iapws__r283 iapws__r283 module~iapws__r797->module~iapws__r283 ieee_arithmetic ieee_arithmetic module~iapws__common->ieee_arithmetic stdlib_kinds stdlib_kinds module~iapws__common->stdlib_kinds stdlib_optval stdlib_optval module~iapws__common->stdlib_optval module~iapws__r283->module~iapws__common Help Graph Key Nodes of different colours represent the following: Graph Key Module Module Submodule Submodule Subroutine Subroutine Function Function Program Program This Page's Entity This Page's Entity Solid arrows point from a submodule to the (sub)module which it is\ndescended from. Dashed arrows point from a module or program unit to \nmodules which it uses. Used by module~~iapws__r797~~UsedByGraph module~iapws__r797 iapws__r797 module~iapws__api iapws__api module~iapws__api->module~iapws__r797 module~iapws iapws module~iapws->module~iapws__api module~iapws__capi iapws__capi module~iapws->module~iapws__capi module~iapws__capi->module~iapws__api Help Graph Key Nodes of different colours represent the following: Graph Key Module Module Submodule Submodule Subroutine Subroutine Function Function Program Program This Page's Entity This Page's Entity Solid arrows point from a submodule to the (sub)module which it is\ndescended from. Dashed arrows point from a module or program unit to \nmodules which it uses. Abstract Interfaces abstract interface public pure subroutine rai(p, T, prop, res) Arguments Type Intent Optional Attributes Name real(kind=dp), intent(in) :: p (:) real(kind=dp), intent(in) :: T (:) character(len=*), intent(in) :: prop real(kind=dp), intent(out) :: res (:) Functions public pure elemental function find_phase (p, T) result(res) Find the corresponding phase according to p and T.\nReturn the phase as an character: l=LIQUID, v=VAPOR, c=SUPER CRITICAL, s=SATURATION, n=UNKNOWN. Arguments Type Intent Optional Attributes Name real(kind=dp), intent(in) :: p Pressure in MPa. real(kind=dp), intent(in) :: T Temperature in K. Return Value character(len=1) public pure elemental function find_region (p, T) result(res) Find the corresponding region according to p and T.\nReturn the number of the region (1 to 5) when found otherwise return -1. Arguments Type Intent Optional Attributes Name real(kind=dp), intent(in) :: p Pressure in MPa. real(kind=dp), intent(in) :: T Temperature in K. Return Value integer(kind=int32) public pure elemental function get_r (region) result(fptr) Get the pointer to the adequate region subroutine Arguments Type Intent Optional Attributes Name integer(kind=int32), intent(in) :: region Return Value procedure( rai ), pointer public pure function is1region (regions) result(res) Check if all regions are identical Arguments Type Intent Optional Attributes Name integer(kind=int32), intent(in) :: regions (:) Return Value logical public pure elemental function r1_cp (p, T) result(res) Compute the specific isobaric heat capacity cp in kJ/kg/K. Arguments Type Intent Optional Attributes Name real(kind=dp), intent(in) :: p Pressure in MPa. real(kind=dp), intent(in) :: T Temperature in K. Return Value real(kind=dp) public pure elemental function r1_cv (p, T) result(res) Compute the specific isochoric heat capacity cp in kJ/kg/K. Arguments Type Intent Optional Attributes Name real(kind=dp), intent(in) :: p Pressure in MPa. real(kind=dp), intent(in) :: T Temperature in K. Return Value real(kind=dp) public pure elemental function r1_h (p, T) result(res) Compute the specific enthalpie h in kJ/kg. Arguments Type Intent Optional Attributes Name real(kind=dp), intent(in) :: p Pressure in MPa. real(kind=dp), intent(in) :: T Temperature in K. Return Value real(kind=dp) public pure elemental function r1_s (p, T) result(res) Compute the specific enthropy h in kJ/kg/K. Arguments Type Intent Optional Attributes Name real(kind=dp), intent(in) :: p Pressure in MPa. real(kind=dp), intent(in) :: T Temperature in K. Return Value real(kind=dp) public pure elemental function r1_u (p, T) result(res) Compute the specific internal energy u in m3/kg. Arguments Type Intent Optional Attributes Name real(kind=dp), intent(in) :: p Pressure in MPa. real(kind=dp), intent(in) :: T Temperature in K. Return Value real(kind=dp) public pure elemental function r1_v (p, T) result(res) Compute the specific volume v in m3/kg. Arguments Type Intent Optional Attributes Name real(kind=dp), intent(in) :: p Pressure in MPa. real(kind=dp), intent(in) :: T Temperature in K. Return Value real(kind=dp) public pure elemental function r1_w (p, T) result(res) Compute the speed of sound w in m/s. Arguments Type Intent Optional Attributes Name real(kind=dp), intent(in) :: p Pressure in MPa. real(kind=dp), intent(in) :: T Temperature in K. Return Value real(kind=dp) public pure elemental function r4_Ts (ps) result(value) Compute the saturation-pressure line. \nValidity range 611.213 Pa <= ps <= 22.064 MPa. Arguments Type Intent Optional Attributes Name real(kind=dp), intent(in) :: ps Saturation Pressure in MPa. Return Value real(kind=dp) Saturation temperature in K at pressure ps. Is nan if ps is out of range. public pure elemental function r4_ps (Ts) result(value) Compute the saturation-pressure line. \nValidity range 273.13 K <= Ts <= 647.096 K. Arguments Type Intent Optional Attributes Name real(kind=dp), intent(in) :: Ts Saturation temperature in K. Return Value real(kind=dp) Saturation Pressure in MPa at temperature Ts. Is nan if Ts is out of range. Subroutines public pure subroutine r1 (p, T, prop, res) Compute water properties at pressure p in MPa and temperature T in Kelvin.\nin region 1. Read more… Arguments Type Intent Optional Attributes Name real(kind=dp), intent(in) :: p (:) Pressure in MPa. real(kind=dp), intent(in) :: T (:) Pressure in K. character(len=*), intent(in) :: prop Property real(kind=dp), intent(out) :: res (:) Result","tags":"","url":"module/iapws__r797.html"},{"title":"iapws_api.f90 – iapws","text":"This file depends on sourcefile~~iapws_api.f90~~EfferentGraph sourcefile~iapws_api.f90 iapws_api.f90 sourcefile~iapws_common.f90 iapws_common.f90 sourcefile~iapws_api.f90->sourcefile~iapws_common.f90 sourcefile~iapws_g704.f90 iapws_g704.f90 sourcefile~iapws_api.f90->sourcefile~iapws_g704.f90 sourcefile~iapws_r1124.f90 iapws_r1124.f90 sourcefile~iapws_api.f90->sourcefile~iapws_r1124.f90 sourcefile~iapws_r283.f90 iapws_r283.f90 sourcefile~iapws_api.f90->sourcefile~iapws_r283.f90 sourcefile~iapws_r797.f90 iapws_r797.f90 sourcefile~iapws_api.f90->sourcefile~iapws_r797.f90 sourcefile~iapws_version.f90 iapws_version.f90 sourcefile~iapws_api.f90->sourcefile~iapws_version.f90 sourcefile~iapws_g704.f90->sourcefile~iapws_common.f90 sourcefile~iapws_g704.f90->sourcefile~iapws_r283.f90 sourcefile~iapws_r1124.f90->sourcefile~iapws_common.f90 sourcefile~iapws_r283.f90->sourcefile~iapws_common.f90 sourcefile~iapws_r797.f90->sourcefile~iapws_common.f90 sourcefile~iapws_r797.f90->sourcefile~iapws_r283.f90 Help Graph Key Nodes of different colours represent the following: Graph Key Source File Source File This Page's Entity This Page's Entity Solid arrows point from a file to a file which it depends on. A file\nis dependent upon another if the latter must be compiled before the former\ncan be. Files dependent on this one sourcefile~~iapws_api.f90~~AfferentGraph sourcefile~iapws_api.f90 iapws_api.f90 sourcefile~iapws.f90 iapws.f90 sourcefile~iapws.f90->sourcefile~iapws_api.f90 sourcefile~iapws_capi.f90 iapws_capi.f90 sourcefile~iapws.f90->sourcefile~iapws_capi.f90 sourcefile~iapws_capi.f90->sourcefile~iapws_api.f90 Help Graph Key Nodes of different colours represent the following: Graph Key Source File Source File This Page's Entity This Page's Entity Solid arrows point from a file to a file which it depends on. A file\nis dependent upon another if the latter must be compiled before the former\ncan be. Source Code module iapws__api !! API. use iapws__common use iapws__version use iapws__r283 use iapws__g704 use iapws__r797 use iapws__r1124 private character ( len = :), allocatable , target :: version_f public :: get_version ! VERSION public :: kh , kd , gases , gases2 , ngases , gas_type ! G704 public :: Tc_H2O , Tc_D2O , pc_H2O , pc_D2O , rhoc_H2O , rhoc_D2O ! R283 public :: r1_v , r1_u , r1_s , r1_h , r1_cp , r1_cv , r1_w ! R797 public :: psat , Tsat ! R797 public :: Kw ! R1124 public :: wp , wr , wph contains ! ------------------------------------------------------------------------------ ! VERSION function get_version () result ( fptr ) !! Return the version implicit none character ( len = :), pointer :: fptr !! Fortran pointer to a string indicating the version.. if ( allocated ( version_f )) then deallocate ( version_f ) endif allocate ( character ( len = len ( version )) :: version_f ) version_f = version fptr => version_f end function ! ------------------------------------------------------------------------------ ! ------------------------------------------------------------------------------ ! G704 ! ------------------------------------------------------------------------------ ! ------------------------------------------------------------------------------ ! R797 pure subroutine psat ( Ts , ps ) !! Compute the saturation pressure at temperature Ts. !! Validity range 273.13 K <= Ts <= 647.096 K. real ( dp ), intent ( in ), contiguous :: Ts (:) !! Saturation temperature in K. real ( dp ), intent ( out ), contiguous :: ps (:) !! Saturation pressure in MPa. Filled with nan if out of validity range. ps = r4_ps ( Ts ) end subroutine pure subroutine Tsat ( ps , Ts ) !! Compute the saturation temperature at pressure ps. !! Validity range 611.213 Pa <= ps <= 22.064 MPa. real ( dp ), intent ( in ), contiguous :: ps (:) !! Saturation pressure in MPa. real ( dp ), intent ( out ), contiguous :: Ts (:) !! Saturation temperature in K. Filled with nan if out of validity range. Ts = r4_Ts ( ps ) end subroutine pure subroutine wp ( p , T , prop , res ) !! Compute water properties at pressure p in MPa and temperature T in Kelvin. !! The adequate region is selected according to p and T. !! !! Available properties: !!     * v: specific volume in m3/kg !!     * u: specific internal energy in kJ/kg !!     * s: specific entropy in kJ/kg !!     * h: specific enthalpy in kJ/kg/K !!     * cp: specific isobaric heat capacity in kJ/kg/K !!     * cv: specific isochoric heat capacity in kJ/kg/K !!     * w: speed of sound in m/s ! parameters real ( dp ), intent ( in ) :: p (:) !! Pressure in MPa. real ( dp ), intent ( in ) :: T (:) !! Pressure in K. character ( len =* ), intent ( in ) :: prop !! Property real ( dp ), intent ( out ) :: res (:) !! Filled with NaN if no adequate region is found. ! variables logical :: is1r integer ( int32 ) :: i integer ( int32 ) :: regions ( size ( p )) procedure ( rai ), pointer :: fptr res = ieee_value ( 1.0_dp , ieee_quiet_nan ) regions = find_region ( p , T ) is1r = is1region ( regions ) if ( is1r . eqv . . true .) then fptr => get_r ( regions ( 1 )) if ( associated ( fptr )) then call fptr ( p , T , prop , res ) end if else do i = 1 , size ( regions ) fptr => get_r ( regions ( i )) if ( associated ( fptr )) then call fptr ( p , T , prop , res ) end if end do end if end subroutine pure subroutine wr ( p , T , res ) !! Get the water region corresponding to p and T. !! Regions 1 to 5 or -1 when not found. ! parameters real ( dp ), intent ( in ) :: p (:) !! Pressure in MPa. real ( dp ), intent ( in ) :: T (:) !! Temperature in K. integer ( int32 ), intent ( out ) :: res (:) !! Region (1-5) res = find_region ( p , T ) end subroutine pure subroutine wph ( p , T , res ) !! Get the water phase corresponding to p and T. !! Phases: l(liquid), v(VAPOR), c(SUPER CRITICAL), s(SATURATION), n(UNKNOWN). ! parameters real ( dp ), intent ( in ) :: p (:) !! pressure in MPa. real ( dp ), intent ( in ) :: T (:) !! Temperature in K. character ( len = 1 ), intent ( out ) :: res (:) !! Phase (l, v, c, s, n) res = find_phase ( p , T ) end subroutine ! ------------------------------------------------------------------------------ ! ------------------------------------------------------------------------------ ! R1124 pure subroutine Kw ( T , rhow , k ) !! Compute the ionization constant of water Kw. !! Validity range 273.13 K <= T <= 1273.15 K and 0 <= p <= 1000 MPa. ! arguments real ( dp ), intent ( in ) :: T (:) !! Temperature in K. real ( dp ), intent ( in ) :: rhow (:) !! Mass density in g.cm&#94;{-3}. real ( dp ), intent ( out ) :: k (:) !! Ionization constant. Filled with NaN if out of validity range. k = 10 ** ( - pKw ( T , rhow )) end subroutine ! ------------------------------------------------------------------------------ end module iapws__api","tags":"","url":"sourcefile/iapws_api.f90.html"},{"title":"iapws_r1124.f90 – iapws","text":"This file depends on sourcefile~~iapws_r1124.f90~~EfferentGraph sourcefile~iapws_r1124.f90 iapws_r1124.f90 sourcefile~iapws_common.f90 iapws_common.f90 sourcefile~iapws_r1124.f90->sourcefile~iapws_common.f90 Help Graph Key Nodes of different colours represent the following: Graph Key Source File Source File This Page's Entity This Page's Entity Solid arrows point from a file to a file which it depends on. A file\nis dependent upon another if the latter must be compiled before the former\ncan be. Files dependent on this one sourcefile~~iapws_r1124.f90~~AfferentGraph sourcefile~iapws_r1124.f90 iapws_r1124.f90 sourcefile~iapws_api.f90 iapws_api.f90 sourcefile~iapws_api.f90->sourcefile~iapws_r1124.f90 sourcefile~iapws.f90 iapws.f90 sourcefile~iapws.f90->sourcefile~iapws_api.f90 sourcefile~iapws_capi.f90 iapws_capi.f90 sourcefile~iapws.f90->sourcefile~iapws_capi.f90 sourcefile~iapws_capi.f90->sourcefile~iapws_api.f90 Help Graph Key Nodes of different colours represent the following: Graph Key Source File Source File This Page's Entity This Page's Entity Solid arrows point from a file to a file which it depends on. A file\nis dependent upon another if the latter must be compiled before the former\ncan be. Source Code module iapws__r1124 !! Module for IAPWS R11-24. use iapws__common implicit none private integer ( int32 ), parameter :: n = 6 ! Ion coordination number real ( dp ), parameter :: Mw = 1 8.015268_dp ! g.mol&#94;{-1} real ( dp ), parameter :: a0 = - 0.702132_dp ! - real ( dp ), parameter :: a1 = + 868 1.05_dp ! K real ( dp ), parameter :: a2 = - 2414 5.1_dp ! K&#94;2(g.cm&#94;{-3})&#94;{-2/3} real ( dp ), parameter :: b0 = + 0.813876_dp ! cm&#94;3.g&#94;{-1} real ( dp ), parameter :: b1 = - 5 1.4471_dp ! K cm&#94;3 g&#94;{-1} real ( dp ), parameter :: b2 = - 0.469920_dp ! cm&#94;6.g&#94;{-2} real ( dp ), parameter :: Tlim1 = 27 3.15_dp ! K real ( dp ), parameter :: Tlim2 = 127 3.15_dp ! K public :: pKw contains pure elemental function Z ( T , rhow ) result ( res ) !! Empirical function in Bandura–Lvov model, g.cm&#94;{-3} ! Arguments real ( dp ), intent ( in ) :: T !! Temperature in K. real ( dp ), intent ( in ) :: rhow !! Mass density, g.cm&#94;{-3} ! Returns real ( dp ) :: res !! Empirical value of temperature and water density res = rhow * exp ( a0 + a1 / T + ( a2 / T ** 2.0_dp ) * rhow ** ( 2.0_dp / 3.0_dp )) end function pure elemental function pKwG ( T ) result ( res ) !! Equilibrium constant of the ionization reaction in the ideal-gas state. ! Arguments real ( dp ), intent ( in ) :: T !! Temperature in K. ! Returns real ( dp ) :: res res = 0.61415_dp + 4825 1.33_dp / T - 6770 7.93_dp / T ** 2.0_dp + 1010210 0.0_dp / T ** 3.0_dp end function pure elemental function pKw ( T , rhow ) result ( res ) !! Ionization constant of water. !! Validity range 273.13 K <= T <= 1273.15 K and 0 <= p <= 1000 MPa. ! Arguments real ( dp ), intent ( in ) :: T !! Temperature in K. real ( dp ), intent ( in ) :: rhow !! Mass density in g.cm&#94;{-3}. ! Returns real ( dp ) :: res res = ieee_value ( 1.0_dp , ieee_quiet_nan ) if (( T >= Tlim1 ) . and . ( T <= Tlim2 )) then res = - 2.0_dp * n * ( & log10 ( 1 + Z ( T , rhow )) - Z ( T , rhow ) / ( Z ( T , rhow ) + 1 ) * rhow * ( b0 + b1 / T + b2 * rhow ) & ) + pKwG ( T ) + 2.0_dp * log10 ( Mw / 100 0.0_dp ) endif end function end module iapws__r1124","tags":"","url":"sourcefile/iapws_r1124.f90.html"},{"title":"iapws_r283.f90 – iapws","text":"This file depends on sourcefile~~iapws_r283.f90~~EfferentGraph sourcefile~iapws_r283.f90 iapws_r283.f90 sourcefile~iapws_common.f90 iapws_common.f90 sourcefile~iapws_r283.f90->sourcefile~iapws_common.f90 Help Graph Key Nodes of different colours represent the following: Graph Key Source File Source File This Page's Entity This Page's Entity Solid arrows point from a file to a file which it depends on. A file\nis dependent upon another if the latter must be compiled before the former\ncan be. Files dependent on this one sourcefile~~iapws_r283.f90~~AfferentGraph sourcefile~iapws_r283.f90 iapws_r283.f90 sourcefile~iapws_api.f90 iapws_api.f90 sourcefile~iapws_api.f90->sourcefile~iapws_r283.f90 sourcefile~iapws_g704.f90 iapws_g704.f90 sourcefile~iapws_api.f90->sourcefile~iapws_g704.f90 sourcefile~iapws_r797.f90 iapws_r797.f90 sourcefile~iapws_api.f90->sourcefile~iapws_r797.f90 sourcefile~iapws_g704.f90->sourcefile~iapws_r283.f90 sourcefile~iapws_r797.f90->sourcefile~iapws_r283.f90 sourcefile~iapws.f90 iapws.f90 sourcefile~iapws.f90->sourcefile~iapws_api.f90 sourcefile~iapws_capi.f90 iapws_capi.f90 sourcefile~iapws.f90->sourcefile~iapws_capi.f90 sourcefile~iapws_capi.f90->sourcefile~iapws_api.f90 Help Graph Key Nodes of different colours represent the following: Graph Key Source File Source File This Page's Entity This Page's Entity Solid arrows point from a file to a file which it depends on. A file\nis dependent upon another if the latter must be compiled before the former\ncan be. Source Code module iapws__r283 !! Module for IAPWS R2-83. use iapws__common implicit none private real ( dp ), parameter :: Tc_H2O = 64 7.096_dp !! Critical temperature for H2O in K real ( dp ), parameter :: Tc_D2O = 64 3.847_dp !! Critical temperature for D2O in K real ( dp ), parameter :: pc_H2O = 2 2.064_dp !! Critical pressure for H2O in MPa real ( dp ), parameter :: pc_D2O = 2 1.671_dp !! Critical pressure for H2O in MPa real ( dp ), parameter :: rhoc_H2O = 32 2.0_dp !! Critical density for H2O in kg.m-3 real ( dp ), parameter :: rhoc_D2O = 35 6.0_dp !! Critical density for H2O in kg.m-3 public :: Tc_H2O , Tc_D2O , pc_H2O , pc_D2O , rhoc_H2O , rhoc_D2O end module","tags":"","url":"sourcefile/iapws_r283.f90.html"},{"title":"iapws_capi.f90 – iapws","text":"This file depends on sourcefile~~iapws_capi.f90~~EfferentGraph sourcefile~iapws_capi.f90 iapws_capi.f90 sourcefile~iapws_api.f90 iapws_api.f90 sourcefile~iapws_capi.f90->sourcefile~iapws_api.f90 sourcefile~iapws_common.f90 iapws_common.f90 sourcefile~iapws_capi.f90->sourcefile~iapws_common.f90 sourcefile~iapws_api.f90->sourcefile~iapws_common.f90 sourcefile~iapws_g704.f90 iapws_g704.f90 sourcefile~iapws_api.f90->sourcefile~iapws_g704.f90 sourcefile~iapws_r1124.f90 iapws_r1124.f90 sourcefile~iapws_api.f90->sourcefile~iapws_r1124.f90 sourcefile~iapws_r283.f90 iapws_r283.f90 sourcefile~iapws_api.f90->sourcefile~iapws_r283.f90 sourcefile~iapws_r797.f90 iapws_r797.f90 sourcefile~iapws_api.f90->sourcefile~iapws_r797.f90 sourcefile~iapws_version.f90 iapws_version.f90 sourcefile~iapws_api.f90->sourcefile~iapws_version.f90 sourcefile~iapws_g704.f90->sourcefile~iapws_common.f90 sourcefile~iapws_g704.f90->sourcefile~iapws_r283.f90 sourcefile~iapws_r1124.f90->sourcefile~iapws_common.f90 sourcefile~iapws_r283.f90->sourcefile~iapws_common.f90 sourcefile~iapws_r797.f90->sourcefile~iapws_common.f90 sourcefile~iapws_r797.f90->sourcefile~iapws_r283.f90 Help Graph Key Nodes of different colours represent the following: Graph Key Source File Source File This Page's Entity This Page's Entity Solid arrows point from a file to a file which it depends on. A file\nis dependent upon another if the latter must be compiled before the former\ncan be. Files dependent on this one sourcefile~~iapws_capi.f90~~AfferentGraph sourcefile~iapws_capi.f90 iapws_capi.f90 sourcefile~iapws.f90 iapws.f90 sourcefile~iapws.f90->sourcefile~iapws_capi.f90 Help Graph Key Nodes of different colours represent the following: Graph Key Source File Source File This Page's Entity This Page's Entity Solid arrows point from a file to a file which it depends on. A file\nis dependent upon another if the latter must be compiled before the former\ncan be. Source Code module iapws__capi !! C API. use iso_c_binding , only : c_double , c_int , c_ptr , c_f_pointer , c_char , c_size_t , c_null_char , c_loc use iapws__common use iapws__api implicit none character ( len = :), allocatable , target :: version_c type , bind ( C ) :: c_char_p type ( c_ptr ) :: p end type type :: cgas_type character ( kind = c_char , len = 1 ), allocatable :: gas (:) end type type ( cgas_type ), allocatable , target :: c_gases (:) type ( c_char_p ), allocatable , target :: char_pp (:) character ( len = :), allocatable , target :: c_gases_str ! ------------------------------------------------------------------------------ ! R283 real ( c_double ), protected , bind ( C , name = \"iapws_r283_Tc_H2O\" ) :: capi_Tc_H2O = Tc_H2O !! Critical temperature for H2O in K real ( c_double ), protected , bind ( C , name = \"iapws_r283_Tc_D2O\" ) :: capi_Tc_D2O = Tc_D2O !! Critical temperature for D2O in K real ( c_double ), protected , bind ( C , name = \"iapws_r283_pc_H2O\" ) :: capi_pc_H2O = pc_H2O !! Critical pressure for H2O in MPa real ( c_double ), protected , bind ( C , name = \"iapws_r283_pc_D2O\" ) :: capi_pc_D2O = pc_D2O !! Critical pressure for D2O in MPa real ( c_double ), protected , bind ( C , name = \"iapws_r283_rhoc_H2O\" ) :: capi_rhoc_H2O = rhoc_H2O !! Critical density for H2O in kg.m-3 real ( c_double ), protected , bind ( C , name = \"iapws_r283_rhoc_D2O\" ) :: capi_rhoc_D2O = rhoc_D2O !! Critical density for D2O in kg.m-3 ! ------------------------------------------------------------------------------ public :: capi_get_version !! VERSION public :: capi_Tc_H2O , capi_Tc_D2O , capi_pc_H2O , capi_pc_D2O , capi_rhoc_H2O , capi_rhoc_D2O !! R283 public :: capi_kh , capi_kd , capi_ngases , capi_gases !!G704 public :: capi_psat , capi_Tsat , capi_wp !! R797 contains ! ------------------------------------------------------------------------------ ! VERSION function capi_get_version () bind ( c , name = \"iapws_get_version\" ) result ( cptr ) !! C API implicit none ! Returns type ( c_ptr ) :: cptr !! Pointer to version string. character ( len = :), pointer :: fptr fptr => get_version () if ( allocated ( version_c )) then deallocate ( version_c ) endif allocate ( character ( len = len ( fptr ) + 1 ) :: version_c ) version_c = fptr // c_null_char cptr = c_loc ( version_c ) end function ! ------------------------------------------------------------------------------ ! ------------------------------------------------------------------------------ ! G704 subroutine capi_kh ( T , gas , heavywater , k , size_gas , size_T ) bind ( C , name = \"iapws_g704_kh\" ) !! C API. implicit none ! arguments integer ( c_int ), intent ( in ), value :: size_gas !! Size of the gas string. integer ( c_size_t ), intent ( in ), value :: size_T !! Size of T and k. real ( c_double ), intent ( in ) :: T ( size_T ) !! Temperature in °C. type ( c_ptr ), intent ( in ), value :: gas !! Gas. integer ( c_int ), intent ( in ), value :: heavywater !! Flag if D2O (1) is used or H2O(0). real ( c_double ), intent ( inout ) :: k ( size_T ) !! Henry constant. Filled with NaNs if gas not found. ! variables character , pointer , dimension (:) :: c2f_gas character ( len = size_gas ) :: f_gas integer ( int32 ) :: i call c_f_pointer ( gas , c2f_gas , shape = [ size_gas ]) do i = 1 , size_gas f_gas ( i : i ) = c2f_gas ( i ) enddo call kh ( T , f_gas , heavywater , k ) end subroutine subroutine capi_kd ( T , gas , heavywater , k , size_gas , size_T ) bind ( C , name = \"iapws_g704_kd\" ) !! C API. implicit none ! arguments integer ( c_size_t ), intent ( in ), value :: size_T !! Size of T and k. integer ( c_int ), intent ( in ), value :: size_gas !! Size of the gas string. real ( c_double ), intent ( in ) :: T ( size_T ) !! Temperature in °C. type ( c_ptr ), intent ( in ), value :: gas !! Gas. integer ( c_int ), intent ( in ), value :: heavywater !! Flag if D2O (1) is used or H2O(0). real ( c_double ), intent ( inout ) :: k ( size_T ) !! Vapor-liquid constant. Filled with NaNs if gas not found. ! variables character , pointer , dimension (:) :: c2f_gas character ( len = size_gas ) :: f_gas integer ( int32 ) :: i call c_f_pointer ( gas , c2f_gas , shape = [ size_gas ]) do i = 1 , size_gas f_gas ( i : i ) = c2f_gas ( i ) enddo call kd ( T , f_gas , heavywater , k ) end subroutine function capi_ngases ( heavywater ) bind ( C , name = \"iapws_g704_ngases\" ) result ( n ) !! C API. implicit none ! arguments integer ( c_int ), intent ( in ), value :: heavywater !! Flag if D2O (1) is used or H2O(0). integer ( c_int ) :: n !! Number of gases. n = ngases ( heavywater ) end function function capi_gases ( heavywater ) bind ( C , name = \"iapws_g704_gases\" ) result ( list_gases ) !! C API. implicit none ! arguments integer ( c_int ), intent ( in ), value :: heavywater !! Flag if D2O (1) is used or H2O(0). type ( c_ptr ) :: list_gases !! Available gases. ! variables integer ( int32 ) :: i , j , ngas , n type ( gas_type ), pointer :: f_gases (:) => null () f_gases => gases ( heavywater ) ngas = size ( f_gases ) if ( allocated ( c_gases )) then deallocate ( c_gases ) endif allocate ( c_gases ( ngas )) if ( allocated ( char_pp )) then deallocate ( char_pp ) endif allocate ( char_pp ( ngas )) do i = 1 , ngas if ( allocated ( c_gases ( i )% gas )) then deallocate ( c_gases ( i )% gas ) endif n = len ( f_gases ( i )% gas ) allocate ( c_gases ( i )% gas ( n + 1 )) do j = 1 , n c_gases ( i )% gas ( j ) = f_gases ( i )% gas ( j : j ) enddo c_gases ( i )% gas ( n + 1 ) = c_null_char char_pp ( i )% p = c_loc ( c_gases ( i )% gas ) enddo list_gases = c_loc ( char_pp ) end function function capi_gases2 ( heavywater ) bind ( C , name = \"iapws_g704_gases2\" ) result ( str_gases ) !! C API. implicit none ! arguments integer ( c_int ), intent ( in ), value :: heavywater !! Flag if D2O (1) is used or H2O(0). type ( c_ptr ) :: str_gases !! Available gases. ! variables character ( len = :), pointer :: f_gases_str => null () f_gases_str => gases2 ( heavywater ) if ( allocated ( c_gases_str )) then deallocate ( c_gases_str ) endif allocate ( character ( len = len ( f_gases_str )) :: c_gases_str ) c_gases_str = f_gases_str c_gases_str ( len ( f_gases_str ): len ( f_gases_str )) = c_null_char str_gases = c_loc ( c_gases_str ) end function ! ------------------------------------------------------------------------------ ! ------------------------------------------------------------------------------ ! R797 subroutine capi_psat ( N , Ts , ps ) bind ( C , name = \"iapws_r797_psat\" ) !! C API. integer ( c_size_t ), intent ( in ), value :: N !! Size of Ts and ps. real ( c_double ), intent ( in ) :: Ts ( N ) !! Saturation temperature in K. real ( c_double ), intent ( out ) :: ps ( N ) !! Saturation pressure in MPa. Filled with nan if out of validity range. call psat ( Ts , ps ) end subroutine subroutine capi_Tsat ( N , ps , Ts ) bind ( C , name = \"iapws_r797_Tsat\" ) !! C API. integer ( c_size_t ), intent ( in ), value :: N !! Size of ps and Ts. real ( c_double ), intent ( in ) :: ps ( N ) !! Saturation pressure in MPa. real ( c_double ), intent ( out ) :: Ts ( N ) !! Saturation temperature in K. Filled with nan if out of validity range. call Tsat ( ps , Ts ) end subroutine subroutine capi_wp ( p , T , prop , res , N , len ) bind ( C , name = \"iapws_r797_wp\" ) !! C API. !! Available properties: !!     * v: specific volume in m3/kg !!     * u: specific internal energy in kJ/kg !!     * s: specific entropy in kJ/kg !!     * h: specific enthalpy in kJ/kg/K !!     * cp: specific isobaric heat capacity in kJ/kg/K !!     * cv: specific isochoric heat capacity in kJ/kg/K !!     * w: speed of sound in m/s ! parameters integer ( c_int ), intent ( in ), value :: len !! Size of the prop string. integer ( c_size_t ), intent ( in ), value :: N !! Size of T and p. real ( c_double ), intent ( in ) :: p ( N ) !! Pressure in MPa. real ( c_double ), intent ( in ) :: T ( N ) !! Temperature in K. type ( c_ptr ), intent ( in ), value :: prop !! Water property. real ( c_double ), intent ( out ) :: res ( N ) !! Result. Filled with NaNs if gas not found. ! variables character , pointer , dimension (:) :: cprop character ( len = len ) :: fprop integer ( int32 ) :: i call c_f_pointer ( prop , cprop , shape = [ len ]) do i = 1 , len fprop ( i : i ) = cprop ( i ) enddo call wp ( p , T , fprop , res ) end subroutine subroutine capi_wr ( p , T , res , N ) bind ( C , name = \"iapws_r797_wr\" ) !! C API. ! parameters integer ( c_size_t ), intent ( in ), value :: N !! Size of T and p. real ( c_double ), intent ( in ) :: p ( N ) !! Pressure in MPa. real ( c_double ), intent ( in ) :: T ( N ) !! Temperature in K. integer ( c_int ), intent ( out ) :: res ( N ) !! Regions. call wr ( p , T , res ) end subroutine subroutine capi_wph ( p , T , res , N ) bind ( C , name = \"iapws_r797_wph\" ) !! C API. ! parameters integer ( c_size_t ), intent ( in ), value :: N !! Size of T and p. real ( c_double ), intent ( in ) :: p ( N ) !! Pressure in MPa. real ( c_double ), intent ( in ) :: T ( N ) !! Temperature in K. character ( len = 1 , kind = c_char ), intent ( out ) :: res ( N ) !! Regions. call wph ( p , T , res ) end subroutine ! ------------------------------------------------------------------------------ ! ------------------------------------------------------------------------------ ! R1124 subroutine capi_Kw ( N , T , rhow , k ) bind ( C , name = \"iapws_r1124_Kw\" ) !! C API. ! arguments integer ( c_size_t ), intent ( in ), value :: N !! Size of T, rhow and k. real ( c_double ), intent ( in ) :: T ( N ) !! Temperature in K. real ( c_double ), intent ( in ) :: rhow ( N ) !! Mass density in g.cm&#94;{-3}. real ( c_double ), intent ( out ) :: k ( N ) !! Ionization constant. Filled with NaN if out of validity range. call Kw ( T , rhow , k ) end subroutine ! ------------------------------------------------------------------------------ end module iapws__capi","tags":"","url":"sourcefile/iapws_capi.f90.html"},{"title":"iapws.f90 – iapws","text":"This file depends on sourcefile~~iapws.f90~~EfferentGraph sourcefile~iapws.f90 iapws.f90 sourcefile~iapws_api.f90 iapws_api.f90 sourcefile~iapws.f90->sourcefile~iapws_api.f90 sourcefile~iapws_capi.f90 iapws_capi.f90 sourcefile~iapws.f90->sourcefile~iapws_capi.f90 sourcefile~iapws_common.f90 iapws_common.f90 sourcefile~iapws_api.f90->sourcefile~iapws_common.f90 sourcefile~iapws_g704.f90 iapws_g704.f90 sourcefile~iapws_api.f90->sourcefile~iapws_g704.f90 sourcefile~iapws_r1124.f90 iapws_r1124.f90 sourcefile~iapws_api.f90->sourcefile~iapws_r1124.f90 sourcefile~iapws_r283.f90 iapws_r283.f90 sourcefile~iapws_api.f90->sourcefile~iapws_r283.f90 sourcefile~iapws_r797.f90 iapws_r797.f90 sourcefile~iapws_api.f90->sourcefile~iapws_r797.f90 sourcefile~iapws_version.f90 iapws_version.f90 sourcefile~iapws_api.f90->sourcefile~iapws_version.f90 sourcefile~iapws_capi.f90->sourcefile~iapws_api.f90 sourcefile~iapws_capi.f90->sourcefile~iapws_common.f90 sourcefile~iapws_g704.f90->sourcefile~iapws_common.f90 sourcefile~iapws_g704.f90->sourcefile~iapws_r283.f90 sourcefile~iapws_r1124.f90->sourcefile~iapws_common.f90 sourcefile~iapws_r283.f90->sourcefile~iapws_common.f90 sourcefile~iapws_r797.f90->sourcefile~iapws_common.f90 sourcefile~iapws_r797.f90->sourcefile~iapws_r283.f90 Help Graph Key Nodes of different colours represent the following: Graph Key Source File Source File This Page's Entity This Page's Entity Solid arrows point from a file to a file which it depends on. A file\nis dependent upon another if the latter must be compiled before the former\ncan be. Source Code module iapws !! Main module for the IAPWS library. use iapws__capi use iapws__api end module","tags":"","url":"sourcefile/iapws.f90.html"},{"title":"iapws_g704.f90 – iapws","text":"This file depends on sourcefile~~iapws_g704.f90~~EfferentGraph sourcefile~iapws_g704.f90 iapws_g704.f90 sourcefile~iapws_common.f90 iapws_common.f90 sourcefile~iapws_g704.f90->sourcefile~iapws_common.f90 sourcefile~iapws_r283.f90 iapws_r283.f90 sourcefile~iapws_g704.f90->sourcefile~iapws_r283.f90 sourcefile~iapws_r283.f90->sourcefile~iapws_common.f90 Help Graph Key Nodes of different colours represent the following: Graph Key Source File Source File This Page's Entity This Page's Entity Solid arrows point from a file to a file which it depends on. A file\nis dependent upon another if the latter must be compiled before the former\ncan be. Files dependent on this one sourcefile~~iapws_g704.f90~~AfferentGraph sourcefile~iapws_g704.f90 iapws_g704.f90 sourcefile~iapws_api.f90 iapws_api.f90 sourcefile~iapws_api.f90->sourcefile~iapws_g704.f90 sourcefile~iapws.f90 iapws.f90 sourcefile~iapws.f90->sourcefile~iapws_api.f90 sourcefile~iapws_capi.f90 iapws_capi.f90 sourcefile~iapws.f90->sourcefile~iapws_capi.f90 sourcefile~iapws_capi.f90->sourcefile~iapws_api.f90 Help Graph Key Nodes of different colours represent the following: Graph Key Source File Source File This Page's Entity This Page's Entity Solid arrows point from a file to a file which it depends on. A file\nis dependent upon another if the latter must be compiled before the former\ncan be. Source Code module iapws__g704 !! Module for IAPWS G7-04. use iapws__common use iapws__r283 implicit none private integer ( int32 ), parameter :: lengas = 5 integer ( int32 ), parameter :: ngas_H2O = 14 integer ( int32 ), parameter :: ngas_D2O = 7 type :: gas_type !! Derived type containing a allocatable string for representing a gas. character ( len = :), allocatable :: gas !! Gas end type type ( gas_type ), allocatable , target :: f_gases (:) character ( len = :), allocatable , target :: f_gases_str real ( dp ), parameter :: T_KELVIN = 27 3.15_dp !! Absolute temperature in KELVIN real ( dp ), parameter :: Tc1_H2O = Tc_H2O real ( dp ), parameter :: pc1_H2O = pc_H2O real ( dp ), parameter :: Tc1_D2O = Tc_D2O real ( dp ), parameter :: pc1_D2O = pc_D2O real ( dp ), parameter :: q_H2O = - 0.023767_dp !! solvent coefficient for kd in water real ( dp ), parameter :: q_D2O = - 0.024552_dp !! solvent coefficient for kd in heavywater !! ABC coefficients for gases in water. type :: abc_t character ( len = lengas ) :: gas !! Gas real ( dp ) :: A !! A Column real ( dp ) :: B !! B Column real ( dp ) :: C !! C Column end type !! EFGH coefficients for gases in heavywater. type :: efgh_t character ( len = lengas ) :: gas !! Gas real ( dp ) :: E !! E Column real ( dp ) :: F !! F Column real ( dp ) :: G !! G Column real ( dp ) :: H !! H Column end type !! ai and bi coefficients for water real ( dp ), dimension ( 6 , 2 ), parameter :: aibi_H2O = reshape ([& - 7.85951783_dp , 1.84408259_dp , - 1 1.78664970_dp , 2 2.68074110_dp , - 1 5.96187190_dp , 1.80122502_dp ,& 1.000_dp , 1.500_dp , 3.000_dp , 3.500_dp , 4.000_dp , 7.500_dp ], [ 6 , 2 ]) !! ai and bi coefficients for heavywater real ( dp ), dimension ( 5 , 2 ), parameter :: aibi_D2O = reshape ([& - 7.8966570_dp , 2 4.7330800_dp , - 2 7.8112800_dp , 9.3559130_dp , - 9.2200830_dp , & 1.00_dp , 1.89_dp , 2.00_dp , 3.00_dp , 3.60_dp ], [ 5 , 2 ]) !! ABC constants water. type ( abc_t ), dimension ( ngas_H2O ), parameter :: abc_H2O = & [ abc_t ( \"He\" , - 3.52839_dp , 7.12983_dp , 4.47770_dp ),& abc_t ( \"Ne\" , - 3.18301_dp , 5.31448_dp , 5.43774_dp ),& abc_t ( \"Ar\" , - 8.40954_dp , 4.29587_dp , 1 0.52779_dp ),& abc_t ( \"Kr\" , - 8.97358_dp , 3.61508_dp , 1 1.29963_dp ),& abc_t ( \"Xe\" , - 1 4.21635_dp , 4.00041_dp , 1 5.60999_dp ),& abc_t ( \"H2\" , - 4.73284_dp , 6.08954_dp , 6.06066_dp ),& abc_t ( \"N2\" , - 9.67578_dp , 4.72162_dp , 1 1.70585_dp ),& abc_t ( \"O2\" , - 9.44833_dp , 4.43822_dp , 1 1.42005_dp ),& abc_t ( \"CO\" , - 1 0.52862_dp , 5.13259_dp , 1 2.01421_dp ),& abc_t ( \"CO2\" , - 8.55445_dp , 4.01195_dp , 9.52345_dp ),& abc_t ( \"H2S\" , - 4.51499_dp , 5.23538_dp , 4.42126_dp ),& abc_t ( \"CH4\" , - 1 0.44708_dp , 4.66491_dp , 1 2.12986_dp ),& abc_t ( \"C2H6\" , - 1 9.67563_dp , 4.51222_dp , 2 0.62567_dp ),& abc_t ( \"SF6\" , - 1 6.56118_dp , 2.15289_dp , 2 0.35440_dp )] !! ABC constants for heavywater type ( abc_t ), dimension ( ngas_D2O ), parameter :: abc_D2O = & [ abc_t ( \"He\" , - 0.72643_dp , 7.02134_dp , 2.04433_dp ),& abc_t ( \"Ne\" , - 0.91999_dp , 5.65327_dp , 3.17247_dp ),& abc_t ( \"Ar\" , - 7.17725_dp , 4.48177_dp , 9.31509_dp ),& abc_t ( \"Kr\" , - 8.47059_dp , 3.91580_dp , 1 0.69433_dp ),& abc_t ( \"Xe\" , - 1 4.46485_dp , 4.42330_dp , 1 5.60919_dp ),& abc_t ( \"D2\" , - 5.33843_dp , 6.15723_dp , 6.53046_dp ),& abc_t ( \"CH4\" , - 1 0.01915_dp , 4.73368_dp , 1 1.75711_dp )] !! ci and di coefficients for water real ( dp ), dimension ( 6 , 2 ), parameter :: cidi_H2O = reshape ([& 1.99274064_dp , 1.09965342_dp , - 0.510839303_dp , - 1.75493479_dp , - 4 5.5170352_dp , - 6.7469445d5 ,& 1.0_dp / 3.0_dp , 2.0_dp / 3.0_dp , 5.0_dp / 3.0_dp , 1 6.0_dp / 3.0_dp , 4 3.0_dp / 3.0_dp , 11 0.0_dp / 3.0_dp ], [ 6 , 2 ]) !! ci and di coefficients for heavywater real ( dp ), dimension ( 4 , 2 ), parameter :: cidi_D2O = reshape ([& 2.7072_dp , 0.58662_dp , - 1.3069_dp , - 4 5.663_dp , & 0.374_dp , 1.45_dp , 2.6_dp , 1 2.3_dp ], [ 4 , 2 ]) !! EFGH constants for water type ( efgh_t ), dimension ( ngas_H2O ), parameter :: efgh_H2O = & [ efgh_t ( \"He\" , 226 7.4082_dp , - 2.9616_dp , - 3.2604_dp , 7.8819_dp ),& efgh_t ( \"Ne\" , 250 7.3022_dp , - 3 8.6955_dp , 11 0.3992_dp , - 7 1.9096_dp ),& efgh_t ( \"Ar\" , 231 0.5463_dp , - 4 6.7034_dp , 16 0.4066_dp , - 11 8.3043_dp ),& efgh_t ( \"Kr\" , 227 6.9722_dp , - 6 1.1494_dp , 21 4.0117_dp , - 15 9.0407_dp ),& efgh_t ( \"Xe\" , 202 2.8375_dp , 1 6.7913_dp , - 6 1.2401_dp , 4 1.9236_dp ),& efgh_t ( \"H2\" , 228 6.4159_dp , 1 1.3397_dp , - 7 0.7279_dp , 6 3.0631_dp ),& efgh_t ( \"N2\" , 238 8.8777_dp , - 1 4.9593_dp , 4 2.0179_dp , - 2 9.4396_dp ),& efgh_t ( \"O2\" , 230 5.0674_dp , - 1 1.3240_dp , 2 5.3224_dp , - 1 5.6449_dp ),& efgh_t ( \"CO\" , 234 6.2291_dp , - 5 7.6317_dp , 20 4.5324_dp , - 15 2.6377_dp ),& efgh_t ( \"CO2\" , 167 2.9376_dp , 2 8.1751_dp , - 11 2.4619_dp , 8 5.3807_dp ),& efgh_t ( \"H2S\" , 131 9.1205_dp , 1 4.1571_dp , - 4 6.8361_dp , 3 3.2266_dp ),& efgh_t ( \"CH4\" , 221 5.6977_dp , - 0.1089_dp , - 6.6240_dp , 4.6789_dp ),& efgh_t ( \"C2H6\" , 214 3.8121_dp , 6.8859_dp , - 1 2.6084_dp , 0.0_dp ),& efgh_t ( \"SF6\" , 287 1.7265_dp , - 6 6.7556_dp , 22 9.7191_dp , - 17 2.7400_dp )] !! EFGH constants for heavywater type ( efgh_t ), dimension ( ngas_D2O ), parameter :: efgh_D2O = & [ efgh_t ( \"He\" , 229 3.2474_dp , - 5 4.7707_dp , 19 4.2924_dp , - 14 2.1257 ), & efgh_t ( \"Ne\" , 243 9.6677_dp , - 9 3.4934_dp , 33 0.7783_dp , - 24 3.0100_dp ),& efgh_t ( \"Ar\" , 226 9.2352_dp , - 5 3.6321_dp , 19 1.8421_dp , - 14 3.7659_dp ),& efgh_t ( \"Kr\" , 225 0.3857_dp , - 4 2.0835_dp , 14 0.7656_dp , - 10 2.7592_dp ),& efgh_t ( \"Xe\" , 203 8.3656_dp , 6 8.1228_dp , - 27 1.3390_dp , 20 7.7984_dp ),& efgh_t ( \"D2\" , 214 1.3214_dp , - 1.9696_dp , 1.6136_dp , 0.0_dp ),& efgh_t ( \"CH4\" , 221 6.0181_dp , - 4 0.7666_dp , 15 2.5778_dp , - 11 7.7430_dp )] public :: gas_type public :: kh , kd public :: ngases public :: gases , gases2 contains pure function findgas_abc ( gas , abc ) result ( value ) !! Find the index of the gas in the ABC table. implicit none character ( len =* ), intent ( in ) :: gas !! Gas. type ( abc_t ), dimension (:), intent ( in ) :: abc !! ABC table. integer ( int32 ) :: value !! index of the gas. integer ( int32 ) :: i value = 0 do i = 1 , size ( abc ) if ( trim ( gas ) . eq . abc ( i )% gas ) then value = i exit endif end do end function pure function findgas_efgh ( gas , efgh ) result ( value ) !! Find the index of the gas in the ABC table. implicit none character ( len =* ), intent ( in ) :: gas !! Gas. type ( efgh_t ), dimension (:), intent ( in ) :: efgh !! EFGH table. integer ( int32 ) :: value !! index of gas. integer ( int32 ) :: i value = 0 do i = 1 , size ( efgh ) if ( trim ( gas ) . eq . efgh ( i )% gas ) then value = i exit endif end do end function pure elemental function f_p1star_H2O ( T ) result ( value ) !! Compute p1* in H2O. implicit none real ( dp ), intent ( in ) :: T !! Temperature in K. real ( dp ) :: value !! p1* in MPa. real ( dp ) :: Tr real ( dp ) :: tau Tr = T / Tc1_H2O tau = 1 - Tr value = exp ( 1 / ( Tr ) * sum ( aibi_H2O (:, 1 ) * tau ** ( aibi_H2O (:, 2 )))) * pc1_H2O end function pure elemental function f_p1star_D2O ( T ) result ( value ) !! Compute p1* in D2O. implicit none real ( dp ), intent ( in ) :: T !! Temperature in K. real ( dp ) :: value !! p1* in MPa. real ( dp ) :: Tr real ( dp ) :: tau Tr = T / Tc1_D2O tau = 1 - Tr value = exp ( 1 / ( Tr ) * sum ( aibi_D2O (:, 1 ) * tau ** ( aibi_D2O (:, 2 )))) * pc1_D2O end function pure elemental function f_kh_p1star_H2O ( T , abc ) result ( value ) !! Compute kh/p1* in H2O. implicit none real ( dp ), intent ( in ) :: T !! Temperature in K. type ( abc_t ), intent ( in ) :: abc !! ABC coefficients. real ( dp ) :: value !! kH/p1* adimensional. real ( dp ) :: Tr real ( dp ) :: tau Tr = T / Tc1_H2O tau = 1 - Tr value = exp ( abc % A / Tr + abc % B * ( tau ** 0.355_dp ) / Tr + abc % C * exp ( tau ) * Tr ** ( - 0.41_dp )) end function pure elemental function f_kh_p1star_D2O ( T , abc ) result ( value ) !! Compute kh/p1* in D2O. implicit none real ( dp ), intent ( in ) :: T !! Temperature in K. type ( abc_t ), intent ( in ) :: abc !! ABC coefficients. real ( dp ) :: value !! kh/p1* adimensional. real ( dp ) :: Tr real ( dp ) :: tau Tr = T / Tc1_D2O tau = 1 - Tr value = exp ( abc % A / Tr + abc % B * ( tau ** 0.355_dp ) / Tr + abc % C * exp ( tau ) * Tr ** ( - 0.41_dp )) end function pure elemental function ft_H2O ( tau ) result ( value ) !! Compute f(t) for H2O. implicit none real ( dp ), intent ( in ) :: tau !! tau = 1-T/Tr. real ( dp ) :: value !! f(t) is adimensional. value = sum ( cidi_H2O (:, 1 ) * tau ** ( cidi_H2O (:, 2 ))) end function pure elemental function ft_D2O ( tau ) result ( value ) !! Compute f(t) for D2O. implicit none real ( dp ), intent ( in ) :: tau !! tau = 1-T/Tr. real ( dp ) :: value !! f(t) is adimensional. value = sum ( cidi_D2O (:, 1 ) * tau ** ( cidi_D2O (:, 2 ))) end function pure elemental function f_kh_H2O ( T , abc ) result ( value ) !! Compute kH in H2O. implicit none real ( dp ), intent ( in ) :: T !! Temperature in K. type ( abc_t ), intent ( in ) :: abc !! ABC coefficients. real ( dp ) :: value !! kH in MPa. value = f_kh_p1star_H2O ( T , abc ) * f_p1star_H2O ( T ) end function pure elemental function f_kh_D2O ( T , abc ) result ( value ) !! Compute kH in D2O. implicit none real ( dp ), intent ( in ) :: T !! Temperature in K. type ( abc_t ), intent ( in ) :: abc !! ABC coefficients. real ( dp ) :: value !! kH in MPa. value = f_kh_p1star_D2O ( T , abc ) * f_p1star_D2O ( T ) end function pure elemental function f_kd_H2O ( T , efgh ) result ( value ) !! Compute kd in H2O. implicit none real ( dp ), intent ( in ) :: T !! Temperature in K. type ( efgh_t ), intent ( in ) :: efgh !! EFGH coefficients. real ( dp ) :: value !! kD adimensional. real ( dp ) :: Tr real ( dp ) :: tau real ( dp ) :: p1 real ( dp ) :: p2 real ( dp ) :: p3 real ( dp ) :: p4 Tr = ( T + T_KELVIN ) / Tc1_H2O tau = 1 - Tr p1 = q_H2O * efgh % F p2 = efgh % E / T * ft_H2O ( tau ) p3 = ( efgh % F + efgh % G * tau ** ( 2.0_dp / 3.0_dp ) + efgh % H * tau ) p4 = exp ( - T / 10 0.0_dp ) value = exp ( p1 + p2 + p3 * p4 ) end function pure elemental function f_kd_D2O ( T , efgh ) result ( value ) !! Compute kd in D2O. implicit none real ( dp ), intent ( in ) :: T !! Temperature in K. type ( efgh_t ), intent ( in ) :: efgh !! EFGH coefficients. real ( dp ) :: value !! kD adimensional. real ( dp ) :: Tr real ( dp ) :: tau real ( dp ) :: p1 real ( dp ) :: p2 real ( dp ) :: p3 real ( dp ) :: p4 Tr = T / Tc1_D2O tau = 1 - Tr p1 = q_D2O * efgh % F p2 = efgh % E / T * ft_D2O ( tau ) p3 = ( efgh % F + efgh % G * tau ** ( 2.0_dp / 3.0_dp ) + efgh % H * tau ) p4 = exp ( - T / 10 0.0_dp ) value = exp ( p1 + p2 + p3 * p4 ) end function pure subroutine kh ( T , gas , heavywater , k ) !! Compute the henry constant kH in MPa for a given temperature. !! The molar fraction in water is related to kH: x_2=1/kH. implicit none real ( dp ), intent ( in ), contiguous :: T (:) !! Temperature in K. character ( len =* ), intent ( in ) :: gas !! Gas. integer ( int32 ), intent ( in ) :: heavywater !! Flag if D2O (1) is used or H2O(0). real ( dp ), intent ( out ), contiguous :: k (:) !! Henry constant in MPa. Filled with NaNs if gas not found. integer ( int32 ) :: i if ( heavywater > 0 ) then i = findgas_abc ( gas , abc_D2O ) if ( i == 0 ) then k = ieee_value ( 1.0_dp , ieee_quiet_nan ) else k = f_kh_D2O ( T , abc_D2O ( i )) endif else i = findgas_abc ( gas , abc_H2O ) if ( i == 0 ) then k = ieee_value ( 1.0_dp , ieee_quiet_nan ) else k = f_kh_H2O ( T , abc_H2O ( i )) endif endif end subroutine pure subroutine kd ( T , gas , heavywater , k ) !! Compute the vapor-liquid constant kd for a given temperature. !! The molar fraction in vapor in related to kd:  kd=y_2/x_2  implicit none real ( dp ), intent ( in ), contiguous :: T (:) !! Temperature in K. character ( len =* ), intent ( in ) :: gas !! Gas. integer ( int32 ), intent ( in ) :: heavywater !! Flag if D2O (1) is used or H2O(0). real ( dp ), intent ( out ), contiguous :: k (:) !! Vapor-liquid constant (adimensional). Filled with NaNs if gas not found. integer ( int32 ) :: i if ( heavywater > 0 ) then i = findgas_efgh ( gas , efgh_D2O ) if ( i == 0 ) then k = ieee_value ( 1.0_dp , ieee_quiet_nan ) else k = f_kd_D2O ( T , efgh_D2O ( i )) endif else i = findgas_efgh ( gas , efgh_H2O ) if ( i == 0 ) then k = ieee_value ( 1.0_dp , ieee_quiet_nan ) else k = f_kd_H2O ( T , efgh_H2O ( i )) endif endif end subroutine pure function ngases ( heavywater ) result ( n ) !! Returns the number of gases. implicit none integer ( int32 ), intent ( in ) :: heavywater !! Flag if D2O (1) is used or H2O(0). integer ( int32 ) :: n !! Number of gases. if ( heavywater > 0 ) then n = ngas_D2O else n = ngas_H2O endif end function function gases ( heavywater ) result ( list_gases ) !! Returns the list of available gases. implicit none ! arguments integer ( int32 ), intent ( in ) :: heavywater !! Flag if D2O (1) is used or H2O(0). type ( gas_type ), pointer :: list_gases (:) !! Available gases. ! variables integer ( int32 ) :: i , n if ( allocated ( f_gases )) then deallocate ( f_gases ) endif if ( heavywater > 0 ) then allocate ( f_gases ( ngas_D2O )) do i = 1 , ngas_D2O if ( allocated ( f_gases ( i )% gas )) then deallocate ( f_gases ( i )% gas ) endif n = len ( trim ( abc_D2O ( i )% gas )) allocate ( character ( len = n ) :: f_gases ( i )% gas ) f_gases ( i )% gas = trim ( abc_D2O ( i )% gas ) enddo else allocate ( f_gases ( ngas_H2O )) do i = 1 , ngas_H2O if ( allocated ( f_gases ( i )% gas )) then deallocate ( f_gases ( i )% gas ) endif n = len ( trim ( abc_H2O ( i )% gas )) allocate ( character ( len = n ) :: f_gases ( i )% gas ) f_gases ( i )% gas = trim ( abc_H2O ( i )% gas ) enddo endif list_gases => f_gases end function function gases2 ( heavywater ) result ( str_gases ) !! Returns the available gases as a string. implicit none ! arguments integer ( int32 ), intent ( in ) :: heavywater !! Flag if D2O (1) is used or H2O(0). character ( len = :), pointer :: str_gases !! Available gases ! variables integer ( int32 ) :: i , j , k , ngas type ( gas_type ), pointer :: f_gases_list (:) f_gases_list => gases ( heavywater ) ngas = size ( f_gases_list ) k = 0 do i = 1 , ngas k = k + len ( f_gases_list ( i )% gas ) enddo if ( allocated ( f_gases_str )) then deallocate ( f_gases_str ) endif allocate ( character ( len = k + ngas ) :: f_gases_str ) i = 1 j = 1 k = 1 do i = 1 , ngas do j = 1 , len ( f_gases_list ( i )% gas ) f_gases_str ( k : k ) = f_gases_list ( i )% gas ( j : j ) k = k + 1 enddo f_gases_str ( k : k ) = \",\" k = k + 1 enddo f_gases_str ( len ( f_gases_str ): len ( f_gases_str )) = \"\" str_gases => f_gases_str end function end module","tags":"","url":"sourcefile/iapws_g704.f90.html"},{"title":"iapws_version.f90 – iapws","text":"Files dependent on this one sourcefile~~iapws_version.f90~~AfferentGraph sourcefile~iapws_version.f90 iapws_version.f90 sourcefile~iapws_api.f90 iapws_api.f90 sourcefile~iapws_api.f90->sourcefile~iapws_version.f90 sourcefile~iapws.f90 iapws.f90 sourcefile~iapws.f90->sourcefile~iapws_api.f90 sourcefile~iapws_capi.f90 iapws_capi.f90 sourcefile~iapws.f90->sourcefile~iapws_capi.f90 sourcefile~iapws_capi.f90->sourcefile~iapws_api.f90 Help Graph Key Nodes of different colours represent the following: Graph Key Source File Source File This Page's Entity This Page's Entity Solid arrows point from a file to a file which it depends on. A file\nis dependent upon another if the latter must be compiled before the former\ncan be. Source Code module iapws__version !! Version implicit none private character ( len =* ), parameter , public :: version = \"0.5.1\" end module iapws__version","tags":"","url":"sourcefile/iapws_version.f90.html"},{"title":"iapws_common.f90 – iapws","text":"Files dependent on this one sourcefile~~iapws_common.f90~~AfferentGraph sourcefile~iapws_common.f90 iapws_common.f90 sourcefile~iapws_api.f90 iapws_api.f90 sourcefile~iapws_api.f90->sourcefile~iapws_common.f90 sourcefile~iapws_g704.f90 iapws_g704.f90 sourcefile~iapws_api.f90->sourcefile~iapws_g704.f90 sourcefile~iapws_r1124.f90 iapws_r1124.f90 sourcefile~iapws_api.f90->sourcefile~iapws_r1124.f90 sourcefile~iapws_r283.f90 iapws_r283.f90 sourcefile~iapws_api.f90->sourcefile~iapws_r283.f90 sourcefile~iapws_r797.f90 iapws_r797.f90 sourcefile~iapws_api.f90->sourcefile~iapws_r797.f90 sourcefile~iapws_capi.f90 iapws_capi.f90 sourcefile~iapws_capi.f90->sourcefile~iapws_common.f90 sourcefile~iapws_capi.f90->sourcefile~iapws_api.f90 sourcefile~iapws_g704.f90->sourcefile~iapws_common.f90 sourcefile~iapws_g704.f90->sourcefile~iapws_r283.f90 sourcefile~iapws_r1124.f90->sourcefile~iapws_common.f90 sourcefile~iapws_r283.f90->sourcefile~iapws_common.f90 sourcefile~iapws_r797.f90->sourcefile~iapws_common.f90 sourcefile~iapws_r797.f90->sourcefile~iapws_r283.f90 sourcefile~iapws.f90 iapws.f90 sourcefile~iapws.f90->sourcefile~iapws_api.f90 sourcefile~iapws.f90->sourcefile~iapws_capi.f90 Help Graph Key Nodes of different colours represent the following: Graph Key Source File Source File This Page's Entity This Page's Entity Solid arrows point from a file to a file which it depends on. A file\nis dependent upon another if the latter must be compiled before the former\ncan be. Source Code module iapws__common !! Common parameters use stdlib_kinds , only : int64 , dp , int32 , sp use stdlib_optval , only : optval use ieee_arithmetic , only : ieee_quiet_nan , ieee_value private public :: optval public :: sp , dp , int32 , int64 public :: ieee_value , ieee_quiet_nan end module","tags":"","url":"sourcefile/iapws_common.f90.html"},{"title":"iapws_r797.f90 – iapws","text":"This file depends on sourcefile~~iapws_r797.f90~~EfferentGraph sourcefile~iapws_r797.f90 iapws_r797.f90 sourcefile~iapws_common.f90 iapws_common.f90 sourcefile~iapws_r797.f90->sourcefile~iapws_common.f90 sourcefile~iapws_r283.f90 iapws_r283.f90 sourcefile~iapws_r797.f90->sourcefile~iapws_r283.f90 sourcefile~iapws_r283.f90->sourcefile~iapws_common.f90 Help Graph Key Nodes of different colours represent the following: Graph Key Source File Source File This Page's Entity This Page's Entity Solid arrows point from a file to a file which it depends on. A file\nis dependent upon another if the latter must be compiled before the former\ncan be. Files dependent on this one sourcefile~~iapws_r797.f90~~AfferentGraph sourcefile~iapws_r797.f90 iapws_r797.f90 sourcefile~iapws_api.f90 iapws_api.f90 sourcefile~iapws_api.f90->sourcefile~iapws_r797.f90 sourcefile~iapws.f90 iapws.f90 sourcefile~iapws.f90->sourcefile~iapws_api.f90 sourcefile~iapws_capi.f90 iapws_capi.f90 sourcefile~iapws.f90->sourcefile~iapws_capi.f90 sourcefile~iapws_capi.f90->sourcefile~iapws_api.f90 Help Graph Key Nodes of different colours represent the following: Graph Key Source File Source File This Page's Entity This Page's Entity Solid arrows point from a file to a file which it depends on. A file\nis dependent upon another if the latter must be compiled before the former\ncan be. Source Code module iapws__r797 !! Module for IAPWS R7-97: Not fully implemented - under development. use iapws__common use iapws__r283 , only : Tc_H2O , pc_H2O , rhoc_H2O implicit none private public :: find_region , find_phase , is1region , get_r , rai public :: r1_v , r1_u , r1_s , r1_h , r1_cp , r1_cv , r1_w , r1 public :: r4_ps , r4_Ts real ( dp ), parameter :: T_KELVIN = 27 3.15_dp !! Parameters from IAPWS R7-97 real ( dp ), parameter :: Tc = Tc_H2O !! critical temperature of water in K real ( dp ), parameter :: pc = pc_H2O !! critical pressure of the water in MPa real ( dp ), parameter :: rhoc = rhoc_H2O !! critical density of the water in kg.m-3. real ( dp ), parameter :: R = 0.461526_dp !! Specific gas constant 0.461 526 kJ.kg-1.K-1 ! Region 1 !------------------------------------------------------------------------------- real ( dp ), parameter :: r1_ps = 1 6.53_dp !! p* in MPa. real ( dp ), parameter :: r1_Ts = 138 6.0_dp !! T* in K. real ( dp ), parameter :: r1_Tmin = 27 3.15_dp !! T in K. real ( dp ), parameter :: r1_Tmax = 62 3.15_dp !! T in K. real ( dp ), parameter :: r1_pmax = 10 0.0_dp !! p in MPa. real ( dp ), target :: r1_IJn_g ( 34 , 3 ) = transpose ( reshape ([& + 0.0_dp , - 2.0_dp , + 0.14632971213167d0 , & + 0.0_dp , - 1.0_dp , - 0.84548187169114d0 , & + 0.0_dp , 0.0_dp , - 0.37563603672040d1 , & + 0.0_dp , + 1.0_dp , + 0.33855169168385d1 , & + 0.0_dp , + 2.0_dp , - 0.95791963387872d0 , & + 0.0_dp , + 3.0_dp , + 0.15772038513228d0 , & + 0.0_dp , + 4.0_dp , - 0.16616417199501d-1 , & + 0.0_dp , + 5.0_dp , + 0.81214629983568d-3 , & + 1.0_dp , - 9.0_dp , + 0.28319080123804d-3 , & + 1.0_dp , - 7.0_dp , - 0.60706301565874d-3 , & + 1.0_dp , - 1.0_dp , - 0.18990068218419d-1 , & + 1.0_dp , 0.0_dp , - 0.32529748770505d-1 , & + 1.0_dp , + 1.0_dp , - 0.21841717175414d-1 , & + 1.0_dp , + 3.0_dp , - 0.52838357969930d-4 , & + 2.0_dp , - 3.0_dp , - 0.47184321073267d-3 , & + 2.0_dp , 0.0_dp , - 0.30001780793026d-3 , & + 2.0_dp , + 1.0_dp , + 0.47661393906987d-4 , & + 2.0_dp , + 3.0_dp , - 0.44141845330846d-5 , & + 2.0_dp , + 1 7.0_dp , - 0.72694996297594d-15 , & + 3.0_dp , - 4.0_dp , - 0.31679644845054d-4 , & + 3.0_dp , 0.0_dp , - 0.28270797985312d-5 , & + 3.0_dp , + 6.0_dp , - 0.85205128120103d-9 , & + 4.0_dp , - 5.0_dp , - 0.22425281908000d-5 , & + 4.0_dp , - 2.0_dp , - 0.65171222895601d-6 , & + 4.0_dp , + 1 0.0_dp , - 0.14341729937924d-12 , & + 5.0_dp , - 8.0_dp , - 0.40516996860117d-6 , & + 8.0_dp , - 1 1.0_dp , - 0.12734301741641d-8 , & + 8.0_dp , - 6.0_dp , - 0.17424871230634d-9 , & + 2 1.0_dp , - 2 9.0_dp , - 0.68762131295531d-18 , & + 2 3.0_dp , - 3 1.0_dp , + 0.14478307828521d-19 , & + 2 9.0_dp , - 3 8.0_dp , + 0.26335781662795d-22 , & + 3 0.0_dp , - 3 9.0_dp , - 0.11947622640071d-22 , & + 3 1.0_dp , - 4 0.0_dp , + 0.18228094581404d-23 , & + 3 2.0_dp , - 4 1.0_dp , - 0.93537087292458d-25 & ], & [ 3 , 34 ])) !! Coefficients I, J and n for forward equation in region 1. !------------------------------------------------------------------------------- ! Region 2 !------------------------------------------------------------------------------- real ( dp ), parameter :: r2_T1min = 27 3.15_dp !! T in K. real ( dp ), parameter :: r2_T1max = 62 3.15_dp !! T in K. real ( dp ), parameter :: r2_T2min = r2_T1max !! T in K. real ( dp ), parameter :: r2_T2max = 86 3.15_dp !! T in K. real ( dp ), parameter :: r2_T3min = r2_T2max !! T in K. real ( dp ), parameter :: r2_T3max = 107 3.15_dp !! T in K. real ( dp ), parameter :: r2_pmin = 0.000_dp !! T in K. real ( dp ), parameter :: r2_pmax = 10 0.0_dp !! T in K. !------------------------------------------------------------------------------- ! Region 3 !------------------------------------------------------------------------------- real ( dp ), parameter :: r3_Tmin = 62 3.15_dp !! T in K. real ( dp ), parameter :: r3_pmax = 10 0.0_dp !! T in K. !------------------------------------------------------------------------------- ! Region 4: Saturation line !------------------------------------------------------------------------------- real ( dp ) :: r4_n ( 10 ) = [ & + 0.11670521452767e4_dp , & - 0.72421316703206e6_dp , & - 0.1707384694009292e2_dp , & + 0.12020824702470e5_dp , & - 0.32325550322333e7_dp , & + 0.14915108613530e2_dp , & - 0.48232657361591e4_dp , & + 0.40511340542057e6_dp , & - 0.23855557567849_dp , & + 0.65017534844798e3_dp & ] !! ni coefficients for region 4 (saturation line) real ( dp ), parameter :: r4_Tmin = 27 3.15_dp !! Lower bound for validity for ps(T) in K. real ( dp ), parameter :: r4_Tmax = 64 7.096_dp !! Upper bound for validity ps(T) in K. real ( dp ), parameter :: r4_pmin = 61 1.213e-6_dp !! Lower bound for validity for Ts(p) in MPa. real ( dp ), parameter :: r4_pmax = 2 2.064_dp !! Upper bound for validity Ts(p) in MPa. real ( dp ), parameter :: r4_Tstar = 1_dp !! T* in K real ( dp ), parameter :: r4_Pstar = 1_dp !! p* MPa !------------------------------------------------------------------------------- ! Region 5 !------------------------------------------------------------------------------- real ( dp ), parameter :: r5_Tmin = 107 3.15_dp !! T in K. real ( dp ), parameter :: r5_Tmax = 227 3.15_dp !! T in K. real ( dp ), parameter :: r5_pmin = 0.000_dp !! T in K. real ( dp ), parameter :: r5_pmax = 5 0.0_dp !! T in K. !------------------------------------------------------------------------------- abstract interface pure subroutine rai ( p , T , prop , res ) use iapws__common real ( dp ), intent ( in ) :: p (:) real ( dp ), intent ( in ) :: T (:) character ( len =* ), intent ( in ) :: prop real ( dp ), intent ( out ) :: res (:) end subroutine end interface contains pure elemental function find_region ( p , T ) result ( res ) !! Find the corresponding region according to p and T. !! Return the number of the region (1 to 5) when found otherwise return -1. ! parameters real ( dp ), intent ( in ) :: p !! Pressure in MPa. real ( dp ), intent ( in ) :: T !! Temperature in K. ! results integer ( int32 ) :: res ! variables real ( dp ) :: ps , p23 , T23 res = - 1 ps = r4_ps ( T ) ! test region 1 if (( T >= r1_Tmin ) . and . ( T <= r1_Tmax )) then if (( p >= ps ) . and . ( p <= r1_pmax )) then res = 1 end if end if ! test region 2 if (( T >= r2_T1min ) . and . ( T <= r2_T1max )) then if (( p > r2_pmin ) . and . ( p <= ps )) then res = 2 end if end if if (( T >= r2_T2min ) . and . ( T <= r2_T2max )) then ! p23 = b23_p(T) p23 = 10 0.0_dp ! to change after implementing the boundary equation between region 2 and 3. if (( p > r2_pmin ) . and . ( p <= p23 )) then res = 2 end if end if if (( T >= r2_T3min ) . and . ( T <= r2_T3max )) then if (( p > r2_pmin ) . and . ( p <= r2_pmax )) then res = 2 end if end if ! test Region 3 ! T23 = b23_T(p) ! p23 = b23_p(T) T23 = 107 3.15_dp ! change after implementing b23 equation p23 = 1 0.0_dp ! change after implementing b23 equation if (( T >= r3_Tmin ) . and . ( T <= T23 )) then if (( p >= p23 ) . and . ( p <= r3_pmax )) then res = 3 end if end if ! test region 5 if (( T >= r5_Tmin ) . and . ( T <= r5_Tmax )) then if (( p >= r5_pmin ) . and . ( p <= r5_pmax )) then res = 5 end if end if end function pure elemental function find_phase ( p , T ) result ( res ) !! Find the corresponding phase according to p and T. !! Return the phase as an character: l=LIQUID, v=VAPOR, c=SUPER CRITICAL, s=SATURATION, n=UNKNOWN. ! parameters real ( dp ), intent ( in ) :: p !! Pressure in MPa. real ( dp ), intent ( in ) :: T !! Temperature in K. ! results character ( len = 1 ) :: res ! local variables integer ( int32 ) :: region region = find_region ( p , T ) select case ( region ) case ( 1 ) res = \"l\" case ( 2 ) res = \"v\" case ( 3 ) res = \"c\" case ( 4 ) res = \"s\" case ( 5 ) res = \"v\" case default res = \"n\" end select end function pure function is1region ( regions ) result ( res ) !! Check if all regions are identical ! parameters integer ( int32 ), intent ( in ) :: regions (:) ! returns logical :: res ! variables integer ( int32 ) :: i res = . true . do i = 2 , size ( regions ) if ( regions ( i ) /= regions ( i )) then res = . false . exit endif end do end function pure elemental function get_r ( region ) result ( fptr ) !! Get the pointer to the adequate region subroutine ! parameters integer ( int32 ), intent ( in ) :: region ! returns procedure ( rai ), pointer :: fptr nullify ( fptr ) select case ( region ) case ( 1 ) fptr => r1 case default fptr => null () end select end function ! Region 1 !------------------------------------------------------------------------------- pure elemental function r1_g ( p , T ) result ( res ) !! Compute gamma for region 1. ! parameters real ( dp ), intent ( in ) :: p !! Pressure in MPa. real ( dp ), intent ( in ) :: T !! Temperature in K. !results real ( dp ) :: res !variables real ( dp ) :: pi real ( dp ) :: tau tau = r1_Ts / T pi = p / r1_ps res = sum ( r1_IJn_g (:, 3 ) * ( 7.1_dp - pi ) ** r1_IJn_g (:, 1 ) * & ( tau - 1.222_dp ) ** r1_IJn_g (:, 2 )) end function pure elemental function r1_gp ( p , T ) result ( res ) !! Compute gamma_pi for region 1. ! parameters real ( dp ), intent ( in ) :: p !! Pressure in MPa. real ( dp ), intent ( in ) :: T !! Temperature in K. ! results real ( dp ) :: res ! variables real ( dp ) :: pi real ( dp ) :: tau tau = r1_Ts / T pi = p / r1_ps res = sum ( - r1_IJn_g (:, 3 ) * r1_IJn_g (:, 1 ) * ( 7.1_dp - pi ) ** ( r1_IJn_g (:, 1 ) - 1.0_dp ) * & ( tau - 1.222_dp ) ** r1_IJn_g (:, 2 )) end function pure elemental function r1_gt ( p , T ) result ( res ) !! Compute gamma_tau for region 1. ! parameters real ( dp ), intent ( in ) :: p !! Pressure in MPa. real ( dp ), intent ( in ) :: T !! Temperature in K. ! results real ( dp ) :: res ! variables real ( dp ) :: pi real ( dp ) :: tau tau = r1_Ts / T pi = p / r1_ps res = sum ( r1_IJn_g (:, 3 ) * ( 7.1_dp - pi ) ** r1_IJn_g (:, 1 ) * & r1_IJn_g (:, 2 ) * ( tau - 1.222_dp ) ** ( r1_IJn_g (:, 2 ) - 1.0_dp )) end function pure elemental function r1_gpp ( p , T ) result ( res ) !! Compute gamma_pipi for region 1. ! parameters real ( dp ), intent ( in ) :: p !! Pressure in MPa. real ( dp ), intent ( in ) :: T !! Temperature in K. ! results real ( dp ) :: res ! variables real ( dp ) :: pi real ( dp ) :: tau tau = r1_Ts / T pi = p / r1_ps res = sum ( r1_IJn_g (:, 3 ) * r1_IJn_g (:, 1 ) * ( r1_IJn_g (:, 1 ) - 1.0_dp ) * ( 7.1_dp - pi ) ** ( r1_IJn_g (:, 1 ) - 2.0_dp ) * & ( tau - 1.222_dp ) ** r1_IJn_g (:, 2 )) end function pure elemental function r1_gtt ( p , T ) result ( res ) !! Compute gamma_tautau for region 1. ! parameters real ( dp ), intent ( in ) :: p !! Pressure in MPa. real ( dp ), intent ( in ) :: T !! Temperature in K. ! results real ( dp ) :: res ! variables real ( dp ) :: pi real ( dp ) :: tau tau = r1_Ts / T pi = p / r1_ps res = sum ( r1_IJn_g (:, 3 ) * ( 7.1_dp - pi ) ** r1_IJn_g (:, 1 ) * & r1_IJn_g (:, 2 ) * ( r1_IJn_g (:, 2 ) - 1.0_dp ) * ( tau - 1.222_dp ) ** ( r1_IJn_g (:, 2 ) - 2.0_dp )) end function pure elemental function r1_gpt ( p , T ) result ( res ) !! Compute gamma_pitau for region 1. ! parameters real ( dp ), intent ( in ) :: p !! Pressure in MPa. real ( dp ), intent ( in ) :: T !! Temperature in K. !results real ( dp ) :: res !variables real ( dp ) :: pi real ( dp ) :: tau tau = r1_Ts / T pi = p / r1_ps res = sum ( - r1_IJn_g (:, 3 ) * r1_IJn_g (:, 1 ) * ( 7.1_dp - pi ) ** ( r1_IJn_g (:, 1 ) - 1.0_dp ) * & r1_IJn_g (:, 2 ) * ( tau - 1.222_dp ) ** ( r1_IJn_g (:, 2 ) - 1.0_dp )) end function pure elemental function r1_v ( p , T ) result ( res ) !! Compute the specific volume v in m3/kg. ! parameters real ( dp ), intent ( in ) :: p !! Pressure in MPa. real ( dp ), intent ( in ) :: T !! Temperature in K. ! results real ( dp ) :: res ! variables real ( dp ) :: pi pi = p / r1_ps res = R * T / p * pi * r1_gp ( p , T ) * 1 d - 3 ! RT/p is in L/kg. end function pure elemental function r1_u ( p , T ) result ( res ) !! Compute the specific internal energy u in m3/kg. ! parameters real ( dp ), intent ( in ) :: p !! Pressure in MPa. real ( dp ), intent ( in ) :: T !! Temperature in K. ! results real ( dp ) :: res ! variables real ( dp ) :: pi , tau pi = p / r1_ps tau = r1_Ts / T res = R * T * ( tau * r1_gt ( p , T ) - pi * r1_gp ( p , T )) end function pure elemental function r1_s ( p , T ) result ( res ) !! Compute the specific enthropy h in kJ/kg/K. ! parameters real ( dp ), intent ( in ) :: p !! Pressure in MPa. real ( dp ), intent ( in ) :: T !! Temperature in K. ! results real ( dp ) :: res ! variables real ( dp ) :: tau tau = r1_Ts / T res = R * ( tau * r1_gt ( p , T ) - r1_g ( p , T )) end function pure elemental function r1_h ( p , T ) result ( res ) !! Compute the specific enthalpie h in kJ/kg. ! parameters real ( dp ), intent ( in ) :: p !! Pressure in MPa. real ( dp ), intent ( in ) :: T !! Temperature in K. ! results real ( dp ) :: res ! variables real ( dp ) :: tau tau = r1_Ts / T res = R * T * tau * r1_gt ( p , T ) end function pure elemental function r1_cp ( p , T ) result ( res ) !! Compute the specific isobaric heat capacity cp in kJ/kg/K. ! parameters real ( dp ), intent ( in ) :: p !! Pressure in MPa. real ( dp ), intent ( in ) :: T !! Temperature in K. ! results real ( dp ) :: res ! variables real ( dp ) :: tau tau = r1_Ts / T res = - R * tau ** 2.0_dp * r1_gtt ( p , T ) end function pure elemental function r1_cv ( p , T ) result ( res ) !! Compute the specific isochoric heat capacity cp in kJ/kg/K. ! parameters real ( dp ), intent ( in ) :: p !! Pressure in MPa. real ( dp ), intent ( in ) :: T !! Temperature in K. ! results real ( dp ) :: res ! variables real ( dp ) :: tau tau = r1_Ts / T res = R * ( - tau ** 2.0_dp * r1_gtt ( p , T ) + ( r1_gp ( p , T ) - tau * r1_gpt ( p , T )) ** 2.0_dp / r1_gpp ( p , T ) ) end function pure elemental function r1_w ( p , T ) result ( res ) !! Compute the speed of sound w in m/s. ! parameters real ( dp ), intent ( in ) :: p !! Pressure in MPa. real ( dp ), intent ( in ) :: T !! Temperature in K. ! results real ( dp ) :: res ! variables real ( dp ) :: tau tau = r1_Ts / T ! RT is kJ.kg-1 = 10&#94;3 J.kg-1 ! 1J = 1kg.m2.s-2 ! RT in 10&#94;3 m2.s-2. res = 1 d3 * R * T * ( r1_gp ( p , T ) ** 2.0_dp / & ( ( r1_gp ( p , T ) - tau * r1_gpt ( p , T )) ** 2.0_dp / ( tau ** 2.0_dp * r1_gtt ( p , T )) - r1_gpp ( p , T ) ) & ) res = sqrt ( res ) ! in m.s-1 end function pure subroutine r1 ( p , T , prop , res ) !! Compute water properties at pressure p in MPa and temperature T in Kelvin. !! in region 1. !! !! Available properties: !!     * v: specific volume in m3/kg !!     * u: specific internal energy in kJ/kg !!     * s: specific entropy in kJ/kg !!     * h: specific enthalpy in kJ/kg/K !!     * cp: specific isobaric heat capacity in kJ/kg/K !!     * cv: specific isochoric heat capacity in kJ/kg/K !!     * w: speed of sound in m/s ! parameters real ( dp ), intent ( in ) :: p (:) !! Pressure in MPa. real ( dp ), intent ( in ) :: T (:) !! Pressure in K. character ( len =* ), intent ( in ) :: prop !! Property real ( dp ), intent ( out ) :: res (:) !! Result select case ( prop ) case ( \"v\" ) res = r1_v ( p , T ) case ( \"u\" ) res = r1_u ( p , T ) case ( \"s\" ) res = r1_s ( p , T ) case ( \"h\" ) res = r1_h ( p , T ) case ( \"cp\" ) res = r1_cp ( p , T ) case ( \"cv\" ) res = r1_cv ( p , T ) case ( \"w\" ) res = r1_w ( p , T ) case default res = ieee_value ( 1.0_dp , ieee_quiet_nan ) end select end subroutine !------------------------------------------------------------------------------- ! Boundary between region 2 and 3 !------------------------------------------------------------------------------- !------------------------------------------------------------------------------- ! Region 2 !------------------------------------------------------------------------------- !------------------------------------------------------------------------------- ! Region 3 !------------------------------------------------------------------------------- !------------------------------------------------------------------------------- ! Region 4: Saturation line !------------------------------------------------------------------------------- pure elemental function r4_ps ( Ts ) result ( value ) !! Compute the saturation-pressure line. !! Validity range 273.13 K <= Ts <= 647.096 K. real ( dp ), intent ( in ) :: Ts !! Saturation temperature in K. real ( dp ) :: value !! Saturation Pressure in MPa at temperature Ts. Is nan if Ts is out of range. real ( dp ) :: theta , Ts_K , A , B , C if ( Ts < r4_Tmin ) then value = ieee_value ( 1.0_dp , ieee_quiet_nan ) else if ( Ts > r4_Tmax ) then value = ieee_value ( 1.0_dp , ieee_quiet_nan ) else Ts_K = Ts / r4_Tstar theta = Ts_K + r4_n ( 9 ) / ( Ts_K - r4_n ( 10 )) A = theta ** 2 + r4_n ( 1 ) * theta + r4_n ( 2 ) B = r4_n ( 3 ) * theta ** 2 + r4_n ( 4 ) * theta + r4_n ( 5 ) C = r4_n ( 6 ) * theta ** 2 + r4_n ( 7 ) * theta + r4_n ( 8 ) value = r4_Pstar * ( 2 * C / ( - B + ( B ** 2 - 4 * A * C ) ** ( 0.5_dp ))) ** ( 4.0_dp ) endif end function pure elemental function r4_Ts ( ps ) result ( value ) !! Compute the saturation-pressure line. !! Validity range 611.213 Pa <= ps <= 22.064 MPa. real ( dp ), intent ( in ) :: ps !! Saturation Pressure in MPa. real ( dp ) :: value !! Saturation temperature in K at pressure ps. Is nan if ps is out of range. real ( dp ) :: beta , D , E , F , G if ( ps < r4_pmin ) then value = ieee_value ( 1.0_dp , ieee_quiet_nan ) else if ( ps > r4_pmax ) then value = ieee_value ( 1.0_dp , ieee_quiet_nan ) else beta = ( ps / r4_Pstar ) ** ( 0.25_dp ) E = beta ** 2 + r4_n ( 3 ) * beta + r4_n ( 6 ) F = r4_n ( 1 ) * beta ** 2 + r4_n ( 4 ) * beta + r4_n ( 7 ) G = r4_n ( 2 ) * beta ** 2 + r4_n ( 5 ) * beta + r4_n ( 8 ) D = 2 * G / ( - F - ( F ** 2 - 4 * E * G ) ** ( 0.5_dp )) value = r4_Tstar * ( r4_n ( 10 ) + D - (( r4_n ( 10 ) + D ) ** 2.0_dp - 4.0_dp * ( r4_n ( 9 ) + r4_n ( 10 ) * D )) ** 0.5_dp ) / 2.0_dp endif end function !------------------------------------------------------------------------------- ! Region 5 !------------------------------------------------------------------------------- !------------------------------------------------------------------------------- end module","tags":"","url":"sourcefile/iapws_r797.f90.html"}]}